!*************************************************************************
!  GPINQT01:  Form24Q                                                    *
!*************************************************************************
!*************************************************************************
!                                                                        *
!                                                                        *
!                                                                        *
! This software and related documentation are provided under a           *
! license agreement containing restrictions on use and                   *
! disclosure and are protected by intellectual property                  *
! laws. Except as expressly permitted in your license agreement          *
! or allowed by law, you may not use, copy, reproduce,                   *
! translate, broadcast, modify, license, transmit, distribute,           *
! exhibit, perform, publish or display any part, in any form or          *
! by any means. Reverse engineering, disassembly, or                     *
! decompilation of this software, unless required by law for             *
! interoperability, is prohibited.                                       *
! The information contained herein is subject to change without          *
! notice and is not warranted to be error-free. If you find any          *
! errors, please report them to us in writing.                           *
!                                                                        *
!                                                                        *
! Copyright (C) 1988, 2020, Oracle and/or its affiliates.                *
! All Rights Reserved.                                                   *
!*************************************************************************
!       $Release:  HR92                                                  *
!           $Bug:  31489670                                              *
!*************************************************************************
!  Modification History:                                                 *
!                                                                        *
!  Date         Incident                                                 *
! ----------    -----------                                              *
! DD/MM/YYYY                                                             *
! 09/10/2006    1537124007   References to the field YEAR in the record  *
!                            GPIN_24Q_RC has been replaced with          *
!                            GPIN_YEAR_CD.                               *
!                                                                        *
! 24/Jan/2007   1324784001   Modified the select query in procedure      *
!                            Print-Form to include JOB.EMPLID since this *
!                            field is used in the 'order by' clause of   *
!                            the query.                                  *
! 09/Mar/2007   1517463002   Form 24Q Ammendments                        *
!                                                                        *
! 06/May/2008   1705540002   The SQR has been modified to print the      *
!                            establishment name from GPIN_REG_NAME       *
!                            from the ESTAB_TBL_GPIN record.             *
!                                                                        *
! 05/May/2011   11924588     The SQR has been changed due to amendment   *
! 15/Dec/2011   12593377     SQR changed to display monthly EDU CESS     *
!                            in annexure 1                               *
!                                                                        *
! 02/Mar/2012   13797622     SQR changed to handle data structure change *
!                            for 2012                                    *
!                                                                        *
!*************************************************************************

#Include 'setenv.sqc'  !Set environment



#define max_products 10000


Begin-Setup

   declare-layout FORM_24_Q
      paper-size   = (a4)
      orientation  = LANDSCAPE
      max-columns  = 170
      max-lines    = 50
   end-declare

   declare-report FORM_24_Q_RPT
      layout = FORM_24_Q
   end-declare

   declare-variable
      date $Fin_Start1
      date $date3
      date $Fin_end1
      date $Date4
      date $QBegin_Dt
      date $AddEffDt
      date $AddEffDt2
   end-declare

 create-array
 name=validate_taxable_income size={max_products}
 field=log:char 

 create-array
 name=validate_surcharge size={max_products}
 field=log:char

 create-array
 name=validate_educess size={max_products}
 field=log:char

 create-array
 name=validate_net size={max_products}
 field=log:char


End-Setup


!***********************************************************************
begin-program
   do Init-Report
   do Process-Main
   do Stdapi-Term
   do Clear-Temp-Tables
end-program

!***********************************************************************
! Procedure:    Init_Val                                               *
!                                                                      *
! Description: Prints the Header of the report                         *
!                                                                      *
!***********************************************************************
begin-procedure   Init_Val
   let #Heading_Font      = 4
   let #HeadingPntSize    = 11
   let #StdPntSize        = 9
   let #dataPntSize       = 7
   let #CurrentRow        = 10

   let #LineNum           = 1
   let $Rec_Type          = 'FH'
   let $File_Type         = 'SL1'
   let $File_Create_Date  = datetostr(&RNCT.CREATION_DT,'DDMMYYYY')
   let $File_Seq_Num      = '1'
   Let $Uploader_Type     = 'D'
   let $Tot_Num_Batch     = '1'
   let $Record_Hash       = ''
   let $FVU_Version       = ''
   let $File_Hash         = ''
   let $Sam_Version       = ''
   let $SAM_Hash          = ''
   let $SCM_Version       = ''
   let $SCM_Hash          = ''
   let $Confile_Hash      = ''

   Let $Rputility         = 'Oracle Peoplesoft HRMS Version 9'

   let $Rec_Type2         = 'BH'
   let $Batch_Num         = '1'
   let $Form_Number       = '24Q'
   let $Transaction_Type  = ''
   let $Batch_Updation_Indicator =''
   let $Original_RRR_No   = ''
   let $Previous_RRR_Number = ''
   let $RRR_Number        = ''
   let $RRR_Date          = ''
   let $Last_TAN_Of_Employer = ''
   let $Filler1           = ''
   let $Remark            = ''
   let $TDS_Circle        = ''
   let $AO_Approval       = 'N'
   let $AO_Approval_Number = ''
   let $Record_Hash       = ''

   ! Fields added in the Batch header record
   let $lastdeductor      = ''
   let $statename         = ''
   let $PAOCode           = ''
   let $DDOcode           = ''
   let $ministryname      = ''
   let $ministryother     = ''
   let $filler21          = ''
   let $PAOregisterno     = ''
   let $DDOregisterno     = ''
   ! Fields added in the Batch header record


   let $CD_Rec__Type      = 'CD'
   let $CD_Batch_No       = '1'
   let #CD_Rec_No         = 0
   let $ChallanUpdInd     = ''
   let $NilChalanInd      ='N'
   let $Filler2           = ''
   let $Filler3           = ''
   let $Filler4           = ''
   let $Filler5           = ''
   let $Filler6           = ''
   let $Filler7           = ''
   let $Filler8           = ''
   let $LastBankChlnNo    = ''
   let $LastTrnsfrVcrNo   = ''
   let $TrnsfrVcrNo       = ''
   let $LastBSRCode       = ''
   Let $LstDtBnkChlnNo    = ''
   let $Filler5           = ''
   Let $Filler6           = ''
   let $LstTotDepAmt      = ''
   let $TDSIntAmt         = '0.00'
   let $TDSOthAmt         = '0.00'
   let $RCDHash           = ''



   let $DD_Record_Type    = 'DD'
   let $DD_Batch_No       = '1'
   let #DD_Rec_No         = 0
   let $Mode              = 'O'
   let $PartyCode         = ''
   let $PartyPan          = ''
   let $LstPartyPanRefNo  = ''
   let $PanRefNum         = ''
   let $LstTDSDep         = ''
   let $LstTotTaxDep      = ''
   let $TotValPurchase    = ''
   let $RateTaxDed        = ''
   let $GrossInd          = ''
   let $Book_CashInd      = ''
   let $TaxDedCerDt       = ''
   let $RsnLwrDed         = ''


   let $SD_Record_Type    = 'SD'
   let $SD_Mode           = 'A'
   let $Filler7           = ''
   let $Filler8           = ''
   let $SD_LstGrsTotInc   = ''


   let $S16_Record_Type   = 'S16'
   let $S16_Section_ID    = '16(iii)'
   let $S16_Section_ID_ia = '16(ia)'
   let $S16_Section_ID_ii = '16(ii)'
   let $C6A_Record_Type   = 'C6A'



   let $PD_Rec_Type       = 'PD'
   let $PD_Batch_Num      = '000000001'
   let #PD_Rec_No         = 0

end-procedure


!***********************************************************************
! Procedure:   Init_Variables                                          *
!                                                                      *
! Description: Initilize the variables used in the program             *
!                                                                      *
!***********************************************************************
begin-procedure Init_Variables


  let $cur_end_date = edit(&RNCT.END_DT, 'dd/mm/yyyy')
  let $cur_mon = substr($cur_end_date, 4,2)
  let $cur_dd = substr($cur_end_date,1,2)

   MOVE &RNCT.GPIN_YEAR_CD TO #FYEAR
   let #FYEAR = #FYEAR + 1

   let $Fin_Start = ''
   let $Fin_End = ''

   let $eval = RTRIM(LTRIM(&RNCT.GPIN_QUARTER_ID, ' '), ' ')

   evaluate $eval
      when = '40'
         move #FYEAR TO $FYEAR 9999
         let $Tax_year = 'March ' || $FYEAR
         let $QBegin = '01' || '01' || $FYEAR
         let $Fin_Start = ltrim(rtrim($FYEAR,' '),' ') || '0101'
         let $Fin_End =  ltrim(rtrim($FYEAR,' '),' ') || '0331'
         let $Quarter = 'Q4'
      break
      when = '10'
         let $Tax_year = 'June ' || &RNCT.GPIN_YEAR_CD
         let $QBegin = '01' || '04' || &RNCT.GPIN_YEAR_CD
         let $Fin_Start = ltrim(rtrim(&RNCT.GPIN_YEAR_CD,' '),' ') || '0401'
         let $Fin_End = ltrim(rtrim(&RNCT.GPIN_YEAR_CD,' '),' ') || '0630'
         let $Quarter = 'Q1'
      break
      when = '20'
         let $Tax_year = 'September ' || &RNCT.GPIN_YEAR_CD
         let $QBegin = '01' || '07' || &RNCT.GPIN_YEAR_CD
         let $Fin_Start = ltrim(rtrim(&RNCT.GPIN_YEAR_CD,' '),' ') || '0701'
         let $Fin_End = ltrim(rtrim(&RNCT.GPIN_YEAR_CD,' '),' ') || '0930'
         let $Quarter = 'Q2'
      break
      when-other
         let $Tax_year = 'December ' || &RNCT.GPIN_YEAR_CD
         let $QBegin = '01' || '10' || &RNCT.GPIN_YEAR_CD
         let $Fin_Start = ltrim(rtrim(&RNCT.GPIN_YEAR_CD,' '),' ') || '1001'
         let $Fin_End = ltrim(rtrim(&RNCT.GPIN_YEAR_CD,' '),' ') || '1231'
         let $Quarter = 'Q3'
      break
   end-evaluate

   move #FYEAR to $Fyear2
   let $Fyear2 = edit($Fyear2,'XXXX')

   move #FYEAR to $FYEAR 9999

   let $financial_year  = &RNCT.GPIN_YEAR_CD || ' - ' || $FYEAR
   let $assessment_year = $FYEAR || ' - '
   let #FYEAR = #FYEAR + 1
   move #FYEAR to $FYEAR 9999
   let $assessment_year = $assessment_year || $FYEAR
   let $tax_ded_ac      = ''
   let $permnt_ac_no    = ''

   if rtrim(ltrim(&RNCT.GPIN_RPT_FILED_YN, ' '), ' ') = 'Y'
      let $stmt_filed_yn  = 'Yes'
      let $Upload_Type    = 'R'
      let $if_ans_to_e    = rtrim(ltrim(&RNCT.GPIN_VCHR_NBR, ' '), ' ')
   else
      let $stmt_filed_yn  = 'No'
      let $Upload_Type    = 'R'
      let $if_ans_to_e    = ''
   end-if
    !commented the code as more deductor type are added .

   !if rtrim(ltrim(&RNCT.GPIN_GOVT_IND, ' '), ' ') = 'Y'

   !  let $type_of_ded    = 'Government'
   !else
    !  let $type_of_ded    = 'Others'

    !end-if

   let $name                 = ''
   let $branch_div           = ''
   let $address              = ''
   let $flat_no              = ''
   let $name_of_building     = ''
   let $road                 = ''
   let $area                 = ''
   let $town                 = ''
   let $state                = ''
   let $pin_code             = ''
   let $tel_no               = ''
   let $email                = ''
   let $STD_Code             = ''
   let $Phone_Number         = ''
   let $Name_of_certify      = ''
   let $Name_desgn_resp_pesn = ''
   let $Place                = ''
   let $Date                 = ''
   let $TDS                  = ''
   let $Surcharge            = ''
   let $Edu_Cess             = ''
   let $Interest             = ''
   let $Others               = ''
   let $Tot_tax_deposited    = ''
   let $Cheque_No            = ''
   let $BSR_Code             = ''
   let $Date_tax_deposited   = ''
   let $Transf_voucher_SlNo  = ''
   let $TDS_dep_by_book      = ''
 
   let #serial_surcharge     = 0
   let #serial_educess       = 0
   let #serial_net           = 0
   LET $Val_surcharge        ='0'
   LET $Val_educess          ='0'
   LET $Val_net              ='0'
   Let $NilPan               =' '

   
end-procedure

!***********************************************************************
!  Procedure: Init Report                                              *
!                                                                      *
!***********************************************************************
begin-procedure Init-Report

   move 'GPINQT01' to $ReportID
   do Init-DateTime
   do Init-Number
   do Get-Current-DateTime
   do Stdapi-Init

   if $proc__instance = ''
   else
      let #proc_instance=To_number($proc__instance)
   end-if

   do Get_Translat_Info
   do Get_Run_Cntrl_Dtls
   do Init_Val
   do Init_Variables
   do Get-NILPAN-MSGEntry
   do Get-Qua-Amt-6a ! New Code v6.5

end-procedure !Init-Report


!***************************************************************************************
!  Procedure: Get_Run_Cntrl_Dtls                                                       *
!  Purpose  : This procedure gets the run control values from the run control record   *
!                                                                                      *
!***************************************************************************************
Begin-Procedure Get_Run_Cntrl_Dtls
    let $Creation_date = ''
    let $EstRTAN = 'E'
    let $RCTAN = ''

Begin-Select
RNCT.GPIN_YEAR_CD
RNCT.GPIN_EST_R_TAN
RNCT.ESTABID
RNCT.GPIN_IT_TAN_NBR
RNCT.GPIN_QUARTER_ID
RNCT.BGN_DT
RNCT.END_DT
RNCT.GPIN_RPT_FILED_YN
RNCT.GPIN_VCHR_NBR
RNCT.GP_GENRPT_SORT_OPT
RNCT.CREATION_DT

    let $Creation_date = edit(&RNCT.CREATION_DT,'dd/mm/yyyy')
    LET $EST = RTRIM(&RNCT.ESTABID,' ')
    let $EST = rtrim($EST,' ')
    LET $EstRTAN = RTRIM(&RNCT.GPIN_EST_R_TAN,' ')
    LET $RCTAN = RTRIM(&RNCT.GPIN_IT_TAN_NBR,' ')
    do Create-Dynamic-Clause

FROM PS_GPIN_24Q_RC RNCT
WHERE  RNCT.OPRID    = $prcs_oprid
AND RNCT.RUN_CNTL_ID = $prcs_run_cntl_id
End-Select
End-Procedure    ! Get_Run_Cntrl_Dtls

!**************************************************************************
!  Procedure: Create-Dynamic-Clause                                       *
!  Purpose  : This procedure creates the dymamic where clauses.           *
!                                                                         *
!**************************************************************************
Begin-Procedure Create-Dynamic-Clause
    let $ESTABIDIN = ''
    let $tmp = ''
    let $F24QDTLTBL = ' '

if $EstRTAN = 'E' 

Begin-Select
ESTBIN.GPIN_CENTRAL_HQ
from PS_ESTAB_TBL_GPIN ESTBIN
where ESTBIN.ESTABID = &RNCT.ESTABID
and ESTBIN.EFFDT     = (select max(ESTBIN1.EFFDT)
                          from PS_ESTAB_TBL_GPIN ESTBIN1
                         where ESTBIN1.ESTABID = ESTBIN.ESTABID
                           and ESTBIN1.EFFDT  <= &RNCT.END_DT)
End-Select

if rtrim(&ESTBIN.GPIN_CENTRAL_HQ,' ') = 'Y'
Begin-SELECT distinct
E1.ESTABID

    LET $TMP1 = ''
    let $tmp1 = rtrim(&E1.ESTABID ,' ')
    let $tmp  = rtrim($tmp,' ') || '''' || $tmp1 || '''' ||','

FROM PS_ESTAB_TBL E1
WHERE E1.EFFDT = (SELECT MAX(E11.EFFDT)
                    FROM PS_ESTAB_TBL E11
                   WHERE E11.ESTABID = E1.ESTABID
                     AND E11.EFFDT   <= &RNCT.END_DT)
AND E1.COMPANY  = (SELECT E12.COMPANY
                     FROM PS_ESTAB_TBL E12
                    WHERE E12.ESTABID = &RNCT.ESTABID
                      AND E12.EFFDT   = (SELECT MAX(E121.EFFDT)
                                           FROM PS_ESTAB_TBL E121
                                          WHERE E121.ESTABID = &RNCT.ESTABID
                                            AND E121.EFFDT   <= &RNCT.END_DT))
End-Select
    let $tmp = rtrim($tmp,' ')
    let $tmp = rtrim($tmp,',')
    let $ESTABIDIN = ' in ' ||'(' || $tmp || ')'

else
    LET $EST = RTRIM(&RNCT.ESTABID,' ')
    let $ESTABIDIN = ' = ' || '''' || $est ||''''
end-if

    move &RNCT.ESTABID to $Estab_Id

else

BEGIN-SELECT 
TAN.ESTABID 

    let $TMP1 = ''
    let $tmp1 = rtrim(&TAN.ESTABID ,' ')
    let $tmp  = rtrim($tmp,' ') || '''' || $tmp1 || '''' ||','

FROM PS_ESTAB_TBL_GPIN TAN 
WHERE GPIN_IT_TAN_NBR=$RCTAN 
AND TAN.EFFDT = ( 
SELECT MAX(TAN1.EFFDT) 
FROM PS_ESTAB_TBL_GPIN TAN1 
WHERE TAN1.GPIN_IT_TAN_NBR = TAN.GPIN_IT_TAN_NBR AND TAN1.ESTABID = TAN.ESTABID
AND TAN1.EFFDT <= &RNCT.END_DT)
END-SELECT

    let $tmp = rtrim($tmp,' ')
    let $tmp = rtrim($tmp,',')
    let $ESTABIDIN = ' in ' ||'(' || $tmp || ')'

BEGIN-SELECT
RCEST.ESTABID

      move &RCEST.ESTABID to $Estab_Id      

FROM PS_GPIN_24Q_RC_EST RCEST
WHERE RCEST.GPIN_PRIMARY='Y'
AND RCEST.RUN_CNTL_ID=$prcs_run_cntl_id
AND RCEST.OPRID=$prcs_oprid
AND RCEST.GPIN_IT_TAN_NBR=$RCTAN
END-SELECT

end-if
End-Procedure



!**************************************************************************
! Procedure:   Process-Main                                               *
! Description: The main process                                           *
!                                                                         *
!**************************************************************************
begin-procedure Process-Main


   do Open-File
   do get-tan-num
   do Write-Efile-Header
   do Get-Prev-Form24Q-Details
   do Print_Form
   do Print-Annexure2-Output
   do Get-Estab-Info
   do Write-Annexure2-Footer

   do write-validate-text 

   close 2
   close 4
   close 5
End-Procedure


!**************************************************************************
! Procedure:   write-validate-text                                        *
! Description: added for populating validate.txt                          *
!                                                                         *
!**************************************************************************
begin-procedure write-validate-text 

  MOVE '{FILEPREFIX}TI_Validate.txt{FILESUFFIX}' to $Filename5
   open $Filename5 as 5 for-writing record=9999:vary
   status = #filestat

   if #filestat != 0
       show 'Cannot open file ' $Filename5
   end-if

  let $print = ' '
  let #i = 0
  while #i < {max_products}
   let $print = validate_taxable_income.log(#i)
    if  #i > 4 and $print = ''
     break
    end-if
   write 5 from $print
   let #i = #i + 1
  end-while

  let $print = ' '
  let #i = 0
  while #i < {max_products} 
   let $print = validate_surcharge.log(#i)
    if #i > 4 and $print = ''
     break
    end-if
   write 5 from $print
   let #i = #i + 1
  end-while

  let $print = ' '
  let #i = 0
  while #i < {max_products} 
   let $print = validate_educess.log(#i)
    if #i > 4 and $print = ''
     break
    end-if
   write 5 from $print
   let #i = #i + 1
  end-while

  let $print = ' '
  let #i = 0
  while #i < {max_products} 
   let $print = validate_net.log(#i)
   if #i > 4 and $print = ''
     break
    end-if
   write 5 from $print
   let #i = #i + 1
  end-while

End-Procedure

!**************************************************************************
! Procedure: Open-File                                                    *
!                                                                         *
! Description: Opening the output files for writing                       *
!                                                                         *
!**************************************************************************
begin-procedure Open-File
   MOVE '{FILEPREFIX}Annexure2.csv{FILESUFFIX}' to $Filename2
   open $Filename2 as 2 for-writing record=9999:vary
   status = #filestat
   if #filestat != 0
      show 'Cannot open file ' $Filename2
   end-if

   MOVE '{FILEPREFIX}Form24Q.txt{FILESUFFIX}' to $Filename4
   open $Filename4 as 4 for-writing record=9999:vary
   status = #filestat

   if #filestat != 0
      show 'Cannot open file ' $Filename4
   end-if
End-Procedure

!***********************************************************************
!                                                                      *
!  Procedure:   get-tan-num                                            *
!  Description: Gets the deductor's TAN no                             *
!***********************************************************************

begin-procedure get-tan-num

   move &rnct.end_dt to $End_Date
   let $Tan_ded = ''

begin-select
IE.GPIN_IT_TAN_NBR
IE.GPIN_IT_PAN_NBR
IE.GPIN_TAN_REG_NO
IE.GPIN_AIN

    move &IE.GPIN_IT_TAN_NBR to $Tan_ded
    let $Tan_ded = edit($Tan_ded,'XXXXXXXXXX')
    move &IE.GPIN_IT_PAN_NBR to $Pan_ded
    let $Pan_ded = edit($Pan_ded,'XXXXXXXXXX')

    move &IE.GPIN_TAN_REG_NO to $Tan_Reg_No
    let $Tan_Reg_No = edit($Tan_Reg_No,'XXXXXXXXXXXX')
    move &IE.GPIN_AIN to $AIN_No
    let $AIN_No = edit($AIN_No,'XXXXXXX')


FROM PS_ESTAB_TBL EST, PS_ESTAB_TBL_GPIN IE, PS_STATE_TBL ST
WHERE EST.ESTABID = $Estab_Id
AND EST.ESTABID = IE.ESTABID
AND EST.EFFDT = (SELECT MAX(EFFDT)
                 FROM PS_ESTAB_TBL
                 WHERE ESTABID = EST.ESTABID
                 AND EFFDT <= $End_Date)
AND IE.EFFDT = (SELECT MAX(EFFDT)
                 FROM PS_ESTAB_TBL_GPIN
                 WHERE ESTABID = IE.ESTABID
                 AND EFFDT <= $End_Date)
AND EST.COUNTRY = ST.COUNTRY
AND EST.STATE = ST.STATE
end-select
end-procedure


!***********************************************************************
! Procedure:Print-Write-Output                                         *
!                                                                      *
!***********************************************************************
Begin-Procedure Print-Write-Output

   LET $NAMEC = REPLACE($Name_of_certify, ',', ' ')

   write 1 from $REPORT_TEXT1
   write 1 from $REPORT_TEXT2
   write 1 from ''
   write 1 from $REPORT_TEXT3
   LET $NAMEC = REPLACE($Name_of_certify, ',', ' ')

   let $REPORT_TE = ltrim(rtrim($REPORT_TEXT4,' '),' ')
   let $REPORT_TE = ltrim(rtrim ($REPORT_TE,' '),' ') ||','
   let $REPORT_TE = ltrim(rtrim ($REPORT_TE,' '),' ') || ltrim(rtrim($BSRCODES,' '),' ')
   let $REPORT_TE = ltrim(rtrim ($REPORT_TE,' '),' ') ||','
   let $REPORT_TE = ltrim(rtrim ($REPORT_TE,' '),' ') ||','
   let $REPORT_TE = ltrim(rtrim ($REPORT_TE,' '),' ') ||','
   let $REPORT_TE = ltrim(rtrim ($REPORT_TE,' '),' ') || ltrim(rtrim($REPORT_TITLE1,' '),' ')
   let $REPORT_TE = ltrim(rtrim ($REPORT_TE,' '),' ') || ','
   let $REPORT_TE = ltrim(rtrim ($REPORT_TE,' '),' ') || ltrim(rtrim($NAMEESTAB,' '),' ')
   write 1 from $REPORT_TE

   let $REPORT_TE = ltrim(rtrim($REPORT_TEXT5,' '),' ')
   let $REPORT_TE = ltrim(rtrim ($REPORT_TE,' '),' ') ||','

   let $REPORT_TE = ltrim(rtrim ($REPORT_TE,' '),' ') || ltrim(rtrim($DATESDEP,' '),' ')
   write 1 from $REPORT_TE

   let $REPORT_TE = ltrim(rtrim($REPORT_TEXT6,' '),' ')
   let $REPORT_TE = ltrim(rtrim ($REPORT_TE,' '),' ') || ','
   let $REPORT_TE = ltrim(rtrim ($REPORT_TE,' '),' ') || ltrim(rtrim($CHALLANNOS,' '),' ')
   write 1 from $REPORT_TE

   let $REPORT_TE = ltrim(rtrim($REPORT_TEXT7,' '),' ')
   let $REPORT_TE = ltrim(rtrim ($REPORT_TE,' '),' ') || ','
   let $REPORT_TE = ltrim(rtrim ($REPORT_TE,' '),' ') || ltrim(rtrim($TOTAL_PAID,' '),' ')
   let $REPORT_TE = ltrim(rtrim ($REPORT_TE,' '),' ') || ',,,'
   let $REPORT_TE = ltrim(rtrim ($REPORT_TE,' '),' ') || ltrim(rtrim($REPORT_TITLE2,' '),' ')
   let $REPORT_TE = ltrim(rtrim ($REPORT_TE,' '),' ') || ','
   let $REPORT_TE = ltrim(rtrim ($REPORT_TE,' '),' ') || ltrim(rtrim($TANNO,' '),' ')
   write 1 from $REPORT_TE

   let $REPORT_TE = ltrim(rtrim($REPORT_TEXT8,' '),' ')
   let $REPORT_TE = ltrim(rtrim ($REPORT_TE,' '),' ') || ','
   let $REPORT_TE = ltrim(rtrim ($REPORT_TE,' '),' ') || ltrim(rtrim($TOT_TDS,' '),' ')
   write 1 from $REPORT_TE

   let $REPORT_TE = ltrim(rtrim($REPORT_TEXT9,' '),' ')
   let $REPORT_TE = ltrim(rtrim ($REPORT_TE,' '),' ') || ','
   let $REPORT_TE = ltrim(rtrim ($REPORT_TE,' '),' ') || ltrim(rtrim($INT_PAID,' '),' ')
   write 1 from $REPORT_TE


   write 1 from ''

   let $REPORT_TE = ltrim(rtrim($REPORT_TEXT12,' '),' ')
   let $REPORT_TE = ltrim(rtrim ($REPORT_TE,' '),' ') || ','
   let $REPORT_TE = ltrim(rtrim ($REPORT_TE,' '),' ') || ltrim(rtrim($REPORT_TEXT13,' '),' ')
   let $REPORT_TE = ltrim(rtrim ($REPORT_TE,' '),' ') || ','
   let $REPORT_TE = ltrim(rtrim ($REPORT_TE,' '),' ') || ltrim(rtrim($REPORT_TEXT14,' '),' ')
   let $REPORT_TE = ltrim(rtrim ($REPORT_TE,' '),' ') || ','
   let $REPORT_TE = ltrim(rtrim ($REPORT_TE,' '),' ') || ltrim(rtrim($REPORT_TEXT15,' '),' ')
   let $REPORT_TE = ltrim(rtrim ($REPORT_TE,' '),' ') || ','
   let $REPORT_TE = ltrim(rtrim ($REPORT_TE,' '),' ') || ltrim(rtrim($REPORT_TEXTSECT,' '),' ')
   let $REPORT_TE = ltrim(rtrim ($REPORT_TE,' '),' ') || ','
   let $REPORT_TE = ltrim(rtrim ($REPORT_TE,' '),' ') || ltrim(rtrim($REPORT_TEXT16,' '),' ')
   let $REPORT_TE = ltrim(rtrim ($REPORT_TE,' '),' ') || ','
   let $REPORT_TE = ltrim(rtrim ($REPORT_TE,' '),' ') || ltrim(rtrim($REPORT_TEXT23,' '),' ')
   let $REPORT_TE = ltrim(rtrim ($REPORT_TE,' '),' ') || ','
   let $REPORT_TE = ltrim(rtrim ($REPORT_TE,' '),' ') || ltrim(rtrim($REPORT_TEXT17,' '),' ')
   let $REPORT_TE = ltrim(rtrim ($REPORT_TE,' '),' ') || ','
   let $REPORT_TE = ltrim(rtrim ($REPORT_TE,' '),' ') || ltrim(rtrim($REPORT_TEXT18,' '),' ')
   let $REPORT_TE = ltrim(rtrim ($REPORT_TE,' '),' ') || ','
   let $REPORT_TE = ltrim(rtrim ($REPORT_TE,' '),' ') || ltrim(rtrim($REPORT_TEXT19,' '),' ')
   let $REPORT_TE = ltrim(rtrim ($REPORT_TE,' '),' ') || ','
   let $REPORT_TE = ltrim(rtrim ($REPORT_TE,' '),' ') || ltrim(rtrim($REPORT_TEXT20,' '),' ')
   let $REPORT_TE = ltrim(rtrim ($REPORT_TE,' '),' ') || ','
   let $REPORT_TE = ltrim(rtrim ($REPORT_TE,' '),' ') || ltrim(rtrim($REPORT_TEXT21,' '),' ')
   let $REPORT_TE = ltrim(rtrim ($REPORT_TE,' '),' ') || ','
   let $REPORT_TE = ltrim(rtrim ($REPORT_TE,' '),' ') || ltrim(rtrim($REPORT_TEXT22,' '),' ')
   let $REPORT_TE = ltrim(rtrim ($REPORT_TE,' '),' ') || ','
   let $REPORT_TE = ltrim(rtrim ($REPORT_TE,' '),' ') || ltrim(rtrim($REPORT_TEXT24,' '),' ')
   let $REPORT_TE = ltrim(rtrim ($REPORT_TE,' '),' ') || ','
   let $REPORT_TE = ltrim(rtrim ($REPORT_TE,' '),' ') || ltrim(rtrim($REPORT_TEXT25,' '),' ')
   let $REPORT_TE = ltrim(rtrim ($REPORT_TE,' '),' ') || ','
   let $REPORT_TE = ltrim(rtrim ($REPORT_TE,' '),' ') || ltrim(rtrim($REPORT_TEXTSECT197,' '),' ')

   write 1 from $REPORT_TE


   !write 1 from $REPORT_TE

   let $REPORT_TE = '="[313]"' || ',' ||
                    '="[314]"' || ',' ||
                    '="[315]"' || ',' ||
                    '="[316]"' || ',' ||
                    '="[317]"' || ',' ||
                    '="[318]"' || ',' ||
                    '="[319]"' || ',' ||
                    '="[320]"' || ',' ||
                    '="[321]"' || ',' ||
                    '' || ',' ||
                    '="[322]"' || ',' ||
                    '="[323]"' || ',' ||
                    '="[324]"' || ',' ||
                    '="[325]"' || ',' ||
                    '="[326]"' || ',' ||
                    '="[327]"' || ',' !||
                    !'="[328]"' || ',' ||
                    !'="[329]"' || ',' 

   write 1 from $REPORT_TE

End-Procedure


!***********************************************************************
! Procedure: Write-Validate-Header                                     *
!                                                                      *
!                                                                      *
!***********************************************************************
begin-procedure Write-Validate-Header( $Id)


    let $REPORT_TE = ' '

! let $REPORT_TE = ltrim(rtrim ($REPORT_TE,' '),' ') || ltrim(rtrim($REPORT_TEXT150,' '),' ')



  !do Get_Translat_Info
   do Get_Field_Information ('GPINQT01', 'TEXT150',           $REPORT_TEXT150,        #DW)
   do Get_Field_Information ('GPINQT01', 'TEXT152',           $REPORT_TEXT152,        #DW)
   do Get_Field_Information ('GPINQT01', 'TEXT153',           $REPORT_TEXT153,        #DW)
   do Get_Field_Information ('GPINQT01', 'TEXT154',           $REPORT_TEXT154,        #DW)
   do Get_Field_Information ('GPINQT01', 'TEXT254',           $REPORT_SURCHARGE,      #DW)
   do Get_Field_Information ('GPINQT01', 'TEXTDECORBLINK',    $REPORT_EDUCESS,        #DW)
   do Get_Field_Information ('GPINQT01', 'TEXTALIGN',         $REPORT_NET,            #DW)

if $Id = 'taxable_income'
let validate_taxable_income.log(0) = $REPORT_TE
   let $REPORT_TE = ltrim(rtrim ($REPORT_TE,' '),' ') || ltrim(rtrim($REPORT_TEXT150,' '),' ')
let validate_taxable_income.log(1) = $REPORT_TE
  let $REPORT_TE = ' '
let validate_taxable_income.log(2) = $REPORT_TE
end-if

if $Id = 'surcharge'
let validate_surcharge.log(0) = $REPORT_TE
   let $REPORT_TE = ltrim(rtrim ($REPORT_TE,' '),' ') || ltrim(rtrim($REPORT_SURCHARGE,' '),' ')
let validate_surcharge.log(1) = $REPORT_TE
  let $REPORT_TE = ' '
let validate_surcharge.log(2) = $REPORT_TE
end-if

if $Id = 'educess'
let validate_educess.log(0) = $REPORT_TE
   let $REPORT_TE = ltrim(rtrim ($REPORT_TE,' '),' ') || ltrim(rtrim($REPORT_EDUCESS,' '),' ')
let validate_educess.log(1) = $REPORT_TE
  let $REPORT_TE = ' '
let validate_educess.log(2) = $REPORT_TE
end-if

if $Id = 'net'
let validate_net.log(0) = $REPORT_TE
   let $REPORT_TE = ltrim(rtrim ($REPORT_TE,' '),' ') || ltrim(rtrim($REPORT_NET,' '),' ')
let validate_net.log(1) = $REPORT_TE
  let $REPORT_TE = ' '
let validate_net.log(2) = $REPORT_TE
end-if





   !write 5 from $REPORT_TE
   !let $REPORT_TE = ' '
   !write 5 from $REPORT_TE


    let $REPORT_TE = ' '
   let $REPORT_TE = ltrim(rtrim($REPORT_TEXT154,' '),' ')
   let $REPORT_TE = ltrim(rtrim ($REPORT_TE,' '),' ') || ' ' || ltrim(rtrim($REPORT_TEXT153,' '),' ')
   let $REPORT_TE = ltrim(rtrim ($REPORT_TE,' '),' ') || ' ' || ltrim(rtrim($REPORT_TEXT152,' '),' ')


if $Id = 'taxable_income'
let validate_taxable_income.log(3) = $REPORT_TE
 let $REPORT_TE = ' '
let validate_taxable_income.log(4) = $REPORT_TE
end-if

if $Id = 'surcharge'
let validate_surcharge.log(3) = $REPORT_TE
 let $REPORT_TE = ' '
let validate_surcharge.log(4) = $REPORT_TE
end-if

if $Id = 'educess'
let validate_educess.log(3) = $REPORT_TE
 let $REPORT_TE = ' '
let validate_surcharge.log(4) = $REPORT_TE
end-if

if $Id = 'net'
let validate_net.log(3) = $REPORT_TE
 let $REPORT_TE = ' '
let validate_surcharge.log(4) = $REPORT_TE
end-if



 !write 5 from $REPORT_TE
 !let $REPORT_TE = ' '
 !write 5 from $REPORT_TE

end-procedure

!***********************************************************************
! Procedure: Write-Validate-Data                                       *
!                                                                      *
!                                                                      *
!***********************************************************************
begin-procedure Write-Validate-Data( $Parm, $Parm2, $Parm4, $Id, #count)


 let $REPORT_TE = ' '


let $REPORT_TE = $Parm
    let $REPORT_TE = '  ' ||ltrim(rtrim ($REPORT_TE,' '),' ')
   let $REPORT_TE = ltrim(rtrim ($REPORT_TE,' '),' ') || '      ' || ltrim(rtrim($Parm2,' '),' ')
   let $REPORT_TE = ltrim(rtrim ($REPORT_TE,' '),' ')
   let $REPORT_TE = ltrim(rtrim ($REPORT_TE,' '),' ') || '     ' || ltrim(rtrim($Parm4,' '),' ')


!write 5 from $REPORT_TE



if $Id = 'taxable_income'
let validate_taxable_income.log(#count) = $REPORT_TE
end-if
if $Id = 'surcharge'
let validate_surcharge.log(#count) = $REPORT_TE
end-if
if $Id = 'educess'
let validate_educess.log(#count) = $REPORT_TE
end-if
if $Id = 'net'
let validate_net.log(#count) = $REPORT_TE
end-if


end-procedure


!***********************************************************************
! Procedure: Write-Annexure1-Data                                      *
!                                                                      *
!                                                                      *
!***********************************************************************
begin-procedure Write-Annexure1-Data( $Parm1, $Parm2, $Parm3, $Parm4,
                                      $Parm5, $Parm6, $Parm7, $Parm8,
                                      $Parm9, $Parm10,$Parm11,$Parm12,
                                      $Parm13,$Parm14,$Parm15,$Parm16)

   let $REPORT_TE = $Parm1
   let $REPORT_TE = ltrim(rtrim ($REPORT_TE,' '),' ') || ','
   let $REPORT_TE = ltrim(rtrim ($REPORT_TE,' '),' ') || ltrim(rtrim($Parm2,' '),' ')
   let $REPORT_TE = ltrim(rtrim ($REPORT_TE,' '),' ') || ','
   let $REPORT_TE = ltrim(rtrim ($REPORT_TE,' '),' ') || ltrim(rtrim($Parm3,' '),' ')
   let $REPORT_TE = ltrim(rtrim ($REPORT_TE,' '),' ') || ','
   let $REPORT_TE = ltrim(rtrim ($REPORT_TE,' '),' ') || ltrim(rtrim($Parm4,' '),' ')
   let $REPORT_TE = ltrim(rtrim ($REPORT_TE,' '),' ') || ','
   let $REPORT_TE = ltrim(rtrim ($REPORT_TE,' '),' ') || ltrim(rtrim($Parm15,' '),' ')
   let $REPORT_TE = ltrim(rtrim ($REPORT_TE,' '),' ') || ','
   let $REPORT_TE = ltrim(rtrim ($REPORT_TE,' '),' ') || ltrim(rtrim($Parm5,' '),' ')
   let $REPORT_TE = ltrim(rtrim ($REPORT_TE,' '),' ') || ','
   let $REPORT_TE = ltrim(rtrim ($REPORT_TE,' '),' ') || ltrim(rtrim($Parm12,' '),' ')
   let $REPORT_TE = ltrim(rtrim ($REPORT_TE,' '),' ') || ','
   let $REPORT_TE = ltrim(rtrim ($REPORT_TE,' '),' ') || ltrim(rtrim($Parm6,' '),' ')
   let $REPORT_TE = ltrim(rtrim ($REPORT_TE,' '),' ') || ','
   let $REPORT_TE = ltrim(rtrim ($REPORT_TE,' '),' ') || ltrim(rtrim($Parm7,' '),' ')
   let $REPORT_TE = ltrim(rtrim ($REPORT_TE,' '),' ') || ','
   let $REPORT_TE = ltrim(rtrim ($REPORT_TE,' '),' ') || ltrim(rtrim($Parm8,' '),' ')
   let $REPORT_TE = ltrim(rtrim ($REPORT_TE,' '),' ') || ','
   let $REPORT_TE = ltrim(rtrim ($REPORT_TE,' '),' ') || ltrim(rtrim($Parm9,' '),' ')
   let $REPORT_TE = ltrim(rtrim ($REPORT_TE,' '),' ') || ','
   let $REPORT_TE = ltrim(rtrim ($REPORT_TE,' '),' ') || ltrim(rtrim($Parm10,' '),' ')
   let $REPORT_TE = ltrim(rtrim ($REPORT_TE,' '),' ') || ','
   let $REPORT_TE = ltrim(rtrim ($REPORT_TE,' '),' ') || ltrim(rtrim($Parm11,' '),' ')
   let $REPORT_TE = ltrim(rtrim ($REPORT_TE,' '),' ') || ','
   let $REPORT_TE = ltrim(rtrim ($REPORT_TE,' '),' ') || ltrim(rtrim($Parm13,' '),' ')
   let $REPORT_TE = ltrim(rtrim ($REPORT_TE,' '),' ') || ','
   let $REPORT_TE = ltrim(rtrim ($REPORT_TE,' '),' ') || ltrim(rtrim($Parm14,' '),' ')
   let $REPORT_TE = ltrim(rtrim ($REPORT_TE,' '),' ') || ','
   let $REPORT_TE = ltrim(rtrim ($REPORT_TE,' '),' ') || ltrim(rtrim($Parm16,' '),' ')

   write 1 from $REPORT_TE

end-procedure


!***********************************************************************
! Procedure:Write-Annexure1-Footer                                      *
!                                                                      *
!                                                                      *
!***********************************************************************
begin-procedure Write-Annexure1-Footer
   let $REPORT_TE = ' '

   write 1 from '':1
   write 1 from '':1
   write 1 from $REPORT_TEXT27:15  !

   let $REPORT_TE = $REPORT_TE || ltrim(rtrim($REPORT_TEXT28,' '),' ')
   let $REPORT_TE = ltrim(rtrim ($REPORT_TE,' '),' ') || ''
   let $REPORT_TE = ltrim(rtrim ($REPORT_TE,' '),' ') || ltrim(rtrim($REPORT_TEXT29,' '),' ')
   write 1 from $REPORT_TE

   let $REPORT_TE = ltrim(rtrim($REPORT_TEXT30,' '),' ')
   let $REPORT_TE = ltrim(rtrim($REPORT_TE, ' '), ' ')
   let $REPORT_TE = ltrim(rtrim ($REPORT_TE,' '),' ') || ','
   let $REPORT_TE = ltrim(rtrim($REPORT_TE,' '),' ') || ltrim(rtrim($place,' '),' ')
   let $REPORT_TE = ltrim(rtrim ($REPORT_TE,' '),' ') || ','
   let $REPORT_TE = ltrim(rtrim ($REPORT_TE,' '),' ') || ltrim(rtrim($REPORT_TEXT31,' '),' ')
   write 1 from $REPORT_TE

   let $REPORT_TE = ltrim(rtrim($REPORT_TEXT32,' '),' ')
   let $REPORT_TE = ltrim(rtrim ($REPORT_TE,' '),' ') || ','
   let $REPORT_TE = ltrim(rtrim($REPORT_TE,' '),' ') || ltrim(rtrim(&RNCT.CREATION_DT,' '),' ')
   let $REPORT_TE = ltrim(rtrim($REPORT_TE, ' '), ' ')
   let $REPORT_TE = ltrim(rtrim ($REPORT_TE,' '),' ') || ','
   let $REPORT_TE = ltrim(rtrim ($REPORT_TE,' '),' ') || ltrim(rtrim($REPORT_TEXT33,' '),' ')
   let $REPORT_TE = ltrim(rtrim ($REPORT_TE,' '),' ') || ','
   let $REPORT_TE = ltrim(rtrim ($REPORT_TE,' '),' ') || ltrim(rtrim(replace($Name_resp_prsn,',',' '),' '),' ')
   write 1 from $REPORT_TE

   let $REPORT_TE = ltrim(rtrim($REPORT_TEXT34,' '),' ')
   let $REPORT_TE = ltrim(rtrim($REPORT_TE, ' '), ' ')
   write 1 from $REPORT_TE

   let $REPORT_TE = ltrim(rtrim($REPORT_TEXT35,' '),' ') || ' ' || ltrim(rtrim($REPORT_TEXT35_1,' '),' ')

   let $REPORT_TE = ltrim(rtrim($REPORT_TE, ' '), ' ')
   write 1 from $REPORT_TE

   let $REPORT_TE = ltrim(rtrim($REPORT_TEXT35_2,' '),' ') || ' ' || ltrim(rtrim($REPORT_TEXT35_2A,' '),' ')
   let $REPORT_TE = ltrim(rtrim($REPORT_TE, ' '), ' ')
   write 1 from $REPORT_TE

   let $REPORT_TE = ltrim(rtrim($REPORT_TEXT35_3,' '),' ') 
   let $REPORT_TE = ltrim(rtrim($REPORT_TE, ' '), ' ')
   write 1 from $REPORT_TE


   let $REPORT_TE = ltrim(rtrim($REPORT_TEXT35_4,' '),' ')
   let $REPORT_TE = ltrim(rtrim($REPORT_TE, ' '), ' ')
   write 1 from $REPORT_TE


   let $REPORT_TE = ltrim(rtrim($REPORT_TEXT35_TH1,' '),' ')
   let $REPORT_TE = ltrim(rtrim($REPORT_TE, ' '), ' ') || ','
   let $REPORT_TE = ltrim(rtrim($REPORT_TE,' '),' ') || ltrim(rtrim($REPORT_TEXT35_TH2,' '),' ')
   let $REPORT_TE = ltrim(rtrim($REPORT_TE, ' '), ' ') || ','
   let $REPORT_TE = ltrim(rtrim($REPORT_TE,' '),' ') || ltrim(rtrim($REPORT_TEXT35_TH3,' '),' ')
   write 1 from $REPORT_TE


   let $REPORT_TE = ltrim(rtrim($REPORT_TEXT35_TB1,' '),' ')
   let $REPORT_TE = ltrim(rtrim($REPORT_TE, ' '), ' ') || ','
   let $REPORT_TE = ltrim(rtrim($REPORT_TE,' '),' ') || ltrim(rtrim($REPORT_TEXT35_TB2,' '),' ')
   let $REPORT_TE = ltrim(rtrim($REPORT_TE, ' '), ' ') || ','
   let $REPORT_TE = ltrim(rtrim($REPORT_TE,' '),' ') || ltrim(rtrim($REPORT_TEXT35_TB3,' '),' ')
   write 1 from $REPORT_TE


   let $REPORT_TE = ltrim(rtrim($REPORT_TEXT35_TB1,' '),' ')
   let $REPORT_TE = ltrim(rtrim($REPORT_TE, ' '), ' ') || ','
   let $REPORT_TE = ltrim(rtrim($REPORT_TE,' '),' ') || ltrim(rtrim($REPORT_TEXT35_TB2A,' '),' ')
   let $REPORT_TE = ltrim(rtrim($REPORT_TE, ' '), ' ') || ','
   let $REPORT_TE = ltrim(rtrim($REPORT_TE,' '),' ') || ltrim(rtrim($REPORT_TEXT35_TB3A,' '),' ')
   write 1 from $REPORT_TE


   let $REPORT_TE = ltrim(rtrim($REPORT_TEXT35_TB1,' '),' ')
   let $REPORT_TE = ltrim(rtrim($REPORT_TE, ' '), ' ') || ','
   let $REPORT_TE = ltrim(rtrim($REPORT_TE,' '),' ') || ltrim(rtrim($REPORT_TEXT35_TB2B,' '),' ')
   let $REPORT_TE = ltrim(rtrim($REPORT_TE, ' '), ' ') || ','
   let $REPORT_TE = ltrim(rtrim($REPORT_TE,' '),' ') || ltrim(rtrim($REPORT_TEXT35_TB3B,' '),' ')
   write 1 from $REPORT_TE

   close 1
end-procedure

!***********************************************************************
! Procedure: Print-Annexure2-Output                                    *
!                                                                      *
!                                                                      *
!***********************************************************************

begin-procedure Print-Annexure2-Output

   write 2 from $REPORT_TEXT37
   write 2 from ''


   let $REPORT_TEXT73 = ltrim(rtrim($REPORT_TEXT73,' '),' ') || ' ' || ltrim(rtrim($financial_year,' '),' ')
   let $REPORT_TEXT73 = ltrim(rtrim($REPORT_TEXT73,' '),' ') || ' ' || ltrim(rtrim($REPORT_TEXT74,' '),' ')
   write 2 from $REPORT_TEXT73

   write 2 from ''

   let $REPORT_TE = ltrim(rtrim($REPORT_TEXT38,' '),' ')
   let $REPORT_TE = ltrim(rtrim ($REPORT_TE,' '),' ') || ','
   let $REPORT_TE = ltrim(rtrim ($REPORT_TE,' '),' ') || ltrim(rtrim($REPORT_TEXT39,' '),' ')
   let $REPORT_TE = ltrim(rtrim ($REPORT_TE,' '),' ') || ','
   let $REPORT_TE = ltrim(rtrim ($REPORT_TE,' '),' ') || ltrim(rtrim($REPORT_TEXT40,' '),' ')
   let $REPORT_TE = ltrim(rtrim ($REPORT_TE,' '),' ') || ','
   let $REPORT_TE = ltrim(rtrim ($REPORT_TE,' '),' ') || ltrim(rtrim($REPORT_TEXT401,' '),' ') || ltrim(rtrim($REPORT_TEXT402,' '),' ')
   let $REPORT_TE = ltrim(rtrim ($REPORT_TE,' '),' ') || ','
   let $REPORT_TE = ltrim(rtrim ($REPORT_TE,' '),' ') || ltrim(rtrim($REPORT_TEXT41,' '),' ')
   let $REPORT_TE = ltrim(rtrim ($REPORT_TE,' '),' ') || ',,'
   let $REPORT_TE = ltrim(rtrim ($REPORT_TE,' '),' ') || ' '
   let $REPORT_TE = ltrim(rtrim ($REPORT_TE,' '),' ') || ltrim(rtrim($REPORT_TEXT42A,' '),' ')
   let $REPORT_TE = ltrim(rtrim ($REPORT_TE,' '),' ') || ','
   let $REPORT_TE = ltrim(rtrim ($REPORT_TE,' '),' ') || ltrim(rtrim($REPORT_TEXT42B,' '),' ')
   let $REPORT_TE = ltrim(rtrim ($REPORT_TE,' '),' ') || ','
   let $REPORT_TE = ltrim(rtrim ($REPORT_TE,' '),' ') || ltrim(rtrim($REPORT_TEXT42,' '),' ')
   let $REPORT_TE = ltrim(rtrim ($REPORT_TE,' '),' ') || ','
   let $REPORT_TE = ltrim(rtrim ($REPORT_TE,' '),' ') || ltrim(rtrim($REPORT_TEXT45,' '),' ')  !ET
   let $REPORT_TE = ltrim(rtrim ($REPORT_TE,' '),' ') || ','
   let $REPORT_TE = ltrim(rtrim ($REPORT_TE,' '),' ') || ltrim(rtrim($REPORT_TEXT45A,' '),' ')  ! PT
   let $REPORT_TE = ltrim(rtrim ($REPORT_TE,' '),' ') || ','
   let $REPORT_TE = ltrim(rtrim ($REPORT_TE,' '),' ') || ltrim(rtrim('Total deduction under section 16(ia)',' '),' ')   !SD
   let $REPORT_TE = ltrim(rtrim ($REPORT_TE,' '),' ') || ','
   let $REPORT_TE = ltrim(rtrim ($REPORT_TE,' '),' ') || ltrim(rtrim($REPORT_TEXT46,' '),' ')
   let $REPORT_TE = ltrim(rtrim ($REPORT_TE,' '),' ') || ','
   let $REPORT_TE = ltrim(rtrim ($REPORT_TE,' '),' ') || ltrim(rtrim($REPORT_TEXT48,' '),' ')
   let $REPORT_TE = ltrim(rtrim ($REPORT_TE,' '),' ') || ' ' || ltrim(rtrim($REPORT_TEXT49,' '),' ')
   let $REPORT_TE = ltrim(rtrim ($REPORT_TE,' '),' ') || ','
   let $REPORT_TE = ltrim(rtrim ($REPORT_TE,' '),' ') || ltrim(rtrim($REPORT_TEXT50,' '),' ')
   let $REPORT_TE = ltrim(rtrim ($REPORT_TE,' '),' ') || ','
   let $REPORT_TE = ltrim(rtrim ($REPORT_TE,' '),' ') || ltrim(rtrim($REPORT_TEXT51,' '),' ')
   let $REPORT_TE = ltrim(rtrim ($REPORT_TE,' '),' ') || ' ' || ltrim(rtrim($REPORT_TEXT52,' '),' ')
   let $REPORT_TE = ltrim(rtrim ($REPORT_TE,' '),' ') || ','
   let $REPORT_TE = ltrim(rtrim ($REPORT_TE,' '),' ') || ltrim(rtrim($REPORT_TEXT54,' '),' ')
   let $REPORT_TE = ltrim(rtrim ($REPORT_TE,' '),' ') || ','
   let $REPORT_TE = ltrim(rtrim ($REPORT_TE,' '),' ') || ltrim(rtrim($REPORT_TEXT56,' '),' ')
   let $REPORT_TE = ltrim(rtrim ($REPORT_TE,' '),' ') || ','
   let $REPORT_TE = ltrim(rtrim ($REPORT_TE,' '),' ') || ltrim(rtrim($REPORT_TEXT57,' '),' ')
   let $REPORT_TE = ltrim(rtrim ($REPORT_TE,' '),' ') || ','
   let $REPORT_TE = ltrim(rtrim ($REPORT_TE,' '),' ') || ltrim(rtrim($REPORT_TEXT58,' '),' ')
   let $REPORT_TE = ltrim(rtrim ($REPORT_TE,' '),' ') || ','
   let $REPORT_TE = ltrim(rtrim ($REPORT_TE,' '),' ') || ltrim(rtrim($REPORT_TEXT59,' '),' ')
   let $REPORT_TE = ltrim(rtrim ($REPORT_TE,' '),' ') || ','
   let $REPORT_TE = ltrim(rtrim ($REPORT_TE,' '),' ') || ltrim(rtrim($REPORT_TEXT60,' '),' ')
   let $REPORT_TE = ltrim(rtrim ($REPORT_TE,' '),' ') || ','
   let $REPORT_TE = ltrim(rtrim ($REPORT_TE,' '),' ') || ltrim(rtrim($REPORT_TEXT61,' '),' ')
   let $REPORT_TE = ltrim(rtrim ($REPORT_TE,' '),' ') || ','
   let $REPORT_TE = ltrim(rtrim ($REPORT_TE,' '),' ') || ltrim(rtrim($REPORT_TEXT62,' '),' ')
   let $REPORT_TE = ltrim(rtrim ($REPORT_TE,' '),' ') || ' ' || ltrim(rtrim($REPORT_TEXT63,' '),' ')
   let $REPORT_TE = ltrim(rtrim ($REPORT_TE,' '),' ') || ','
   let $REPORT_TE = ltrim(rtrim ($REPORT_TE,' '),' ') || ltrim(rtrim($REPORT_TEXT63A,' '),' ')
   let $REPORT_TE = ltrim(rtrim ($REPORT_TE,' '),' ') || ' ' || ltrim(rtrim($REPORT_TEXT63A_1,' '),' ')
   let $REPORT_TE = ltrim(rtrim ($REPORT_TE,' '),' ') || ','
   let $REPORT_TE = ltrim(rtrim ($REPORT_TE,' '),' ') || ltrim(rtrim($REPORT_TEXT63A_2,' '),' ')
   let $REPORT_TE = ltrim(rtrim ($REPORT_TE,' '),' ') || ','
   let $REPORT_TE = ltrim(rtrim ($REPORT_TE,' '),' ') || ltrim(rtrim($REPORT_TEXT64,' '),' ')
   let $REPORT_TE = ltrim(rtrim ($REPORT_TE,' '),' ') || ','
   let $REPORT_TE = ltrim(rtrim ($REPORT_TE,' '),' ') || ltrim(rtrim($REPORT_TEXT64A,' '),' ')
   let $REPORT_TE = ltrim(rtrim ($REPORT_TE,' '),' ') || ','
   
   !landLord Info starts
   let $REPORT_TE = ltrim(rtrim ($REPORT_TE,' '),' ') || ltrim(rtrim($HOUSERENTGT1L_TXT,' '),' ')
   let $REPORT_TE = ltrim(rtrim ($REPORT_TE,' '),' ') || ','

   let $REPORT_TE = ltrim(rtrim ($REPORT_TE,' '),' ') || ltrim(rtrim($PAN_LANDLORD1_TXT,' '),' ')
   let $REPORT_TE = ltrim(rtrim ($REPORT_TE,' '),' ') || ','
   let $REPORT_TE = ltrim(rtrim ($REPORT_TE,' '),' ') || ltrim(rtrim($NAME_LANDLORD1_TXT,' '),' ')
   let $REPORT_TE = ltrim(rtrim ($REPORT_TE,' '),' ') || ','
   let $REPORT_TE = ltrim(rtrim ($REPORT_TE,' '),' ') || ltrim(rtrim($PAN_LANDLORD2_TXT,' '),' ')
   let $REPORT_TE = ltrim(rtrim ($REPORT_TE,' '),' ') || ','
   let $REPORT_TE = ltrim(rtrim ($REPORT_TE,' '),' ') || ltrim(rtrim($NAME_LANDLORD2_TXT,' '),' ')
   let $REPORT_TE = ltrim(rtrim ($REPORT_TE,' '),' ') || ','
   let $REPORT_TE = ltrim(rtrim ($REPORT_TE,' '),' ') || ltrim(rtrim($PAN_LANDLORD3_TXT,' '),' ')
   let $REPORT_TE = ltrim(rtrim ($REPORT_TE,' '),' ') || ','
   let $REPORT_TE = ltrim(rtrim ($REPORT_TE,' '),' ') || ltrim(rtrim($NAME_LANDLORD3_TXT,' '),' ')
   let $REPORT_TE = ltrim(rtrim ($REPORT_TE,' '),' ') || ','
   let $REPORT_TE = ltrim(rtrim ($REPORT_TE,' '),' ') || ltrim(rtrim($PAN_LANDLORD4_TXT,' '),' ')
   let $REPORT_TE = ltrim(rtrim ($REPORT_TE,' '),' ') || ','
   let $REPORT_TE = ltrim(rtrim ($REPORT_TE,' '),' ') || ltrim(rtrim($NAME_LANDLORD4_TXT,' '),' ')
   let $REPORT_TE = ltrim(rtrim ($REPORT_TE,' '),' ') || ','
   
   let $REPORT_TE = ltrim(rtrim ($REPORT_TE,' '),' ') || ltrim(rtrim($INCFHOUPROP_TXT,' '),' ')
   let $REPORT_TE = ltrim(rtrim ($REPORT_TE,' '),' ') || ','
   let $REPORT_TE = ltrim(rtrim ($REPORT_TE,' '),' ') || ltrim(rtrim($PAN_LENDER1_TXT,' '),' ')
   let $REPORT_TE = ltrim(rtrim ($REPORT_TE,' '),' ') || ','
   let $REPORT_TE = ltrim(rtrim ($REPORT_TE,' '),' ') || ltrim(rtrim($NAME_LENDER1_TXT,' '),' ')
   let $REPORT_TE = ltrim(rtrim ($REPORT_TE,' '),' ') || ','
   let $REPORT_TE = ltrim(rtrim ($REPORT_TE,' '),' ') || ltrim(rtrim($PAN_LENDER2_TXT,' '),' ')
   let $REPORT_TE = ltrim(rtrim ($REPORT_TE,' '),' ') || ','
   let $REPORT_TE = ltrim(rtrim ($REPORT_TE,' '),' ') || ltrim(rtrim($NAME_LENDER2_TXT,' '),' ')
   let $REPORT_TE = ltrim(rtrim ($REPORT_TE,' '),' ') || ','
   let $REPORT_TE = ltrim(rtrim ($REPORT_TE,' '),' ') || ltrim(rtrim($PAN_LENDER3_TXT,' '),' ')
   let $REPORT_TE = ltrim(rtrim ($REPORT_TE,' '),' ') || ','
   let $REPORT_TE = ltrim(rtrim ($REPORT_TE,' '),' ') || ltrim(rtrim($NAME_LENDER3_TXT,' '),' ')
   let $REPORT_TE = ltrim(rtrim ($REPORT_TE,' '),' ') || ','
   let $REPORT_TE = ltrim(rtrim ($REPORT_TE,' '),' ') || ltrim(rtrim($PAN_LENDER4_TXT,' '),' ')
   let $REPORT_TE = ltrim(rtrim ($REPORT_TE,' '),' ') || ','  
   let $REPORT_TE = ltrim(rtrim ($REPORT_TE,' '),' ') || ltrim(rtrim($NAME_LENDER4_TXT,' '),' ')
   let $REPORT_TE = ltrim(rtrim ($REPORT_TE,' '),' ') || ','
   let $REPORT_TE = ltrim(rtrim ($REPORT_TE,' '),' ') || ltrim(rtrim($SUPER_ANN_FUND_IND_TXT,' '),' ')
   let $REPORT_TE = ltrim(rtrim ($REPORT_TE,' '),' ') || ','
   let $REPORT_TE = ltrim(rtrim ($REPORT_TE,' '),' ') || ltrim(rtrim($SUP_ANN_FUN_NM_TXT ,' '),' ')
   let $REPORT_TE = ltrim(rtrim ($REPORT_TE,' '),' ') || ','
   let $REPORT_TE = ltrim(rtrim ($REPORT_TE,' '),' ') || ltrim(rtrim($SUP_ANN_FUN_DTFROM_TXT,' '),' ')
   let $REPORT_TE = ltrim(rtrim ($REPORT_TE,' '),' ') || ','
   let $REPORT_TE = ltrim(rtrim ($REPORT_TE,' '),' ') || ltrim(rtrim($SUP_ANN_FUN_DTTO_TXT,' '),' ')
   let $REPORT_TE = ltrim(rtrim ($REPORT_TE,' '),' ') || ','
   let $REPORT_TE = ltrim(rtrim ($REPORT_TE,' '),' ') || ltrim(rtrim($SUP_ANN_FUN_AMT_PAID_TXT,' '),' ')
   let $REPORT_TE = ltrim(rtrim ($REPORT_TE,' '),' ') || ','
   let $REPORT_TE = ltrim(rtrim ($REPORT_TE,' '),' ') || ltrim(rtrim($SUP_ANN_DED_TAX_RT_TXT,' '),' ')
   let $REPORT_TE = ltrim(rtrim ($REPORT_TE,' '),' ') || ','
   let $REPORT_TE = ltrim(rtrim ($REPORT_TE,' '),' ') || ltrim(rtrim($SUP_ANN_DED_TAX_AMT_TXT,' '),' ')
   let $REPORT_TE = ltrim(rtrim ($REPORT_TE,' '),' ') || ','
   let $REPORT_TE = ltrim(rtrim ($REPORT_TE,' '),' ') || ltrim(rtrim($SUP_ANN_GRS_TOT_TXT,' '),' ') || ltrim(rtrim($SUP_ANN_GRS_TOT1_TXT,' '),' ')

   let $REPORT_TE = ltrim(rtrim ($REPORT_TE,' '),' ') ||','
   
   !landlord, lENDER, SUP ANN info ends
   
   !NEW CODE for V6.4
   let $REPORT_TE = ltrim(rtrim ($REPORT_TE,' '),' ') || ltrim(rtrim($TEXT_SEC_17_1,' '),' ')
   let $REPORT_TE = ltrim(rtrim ($REPORT_TE,' '),' ') || ','
   
   let $REPORT_TE = ltrim(rtrim ($REPORT_TE,' '),' ') || ltrim(rtrim($TEXT_SEC_17_2,' '),' ')
   let $REPORT_TE = ltrim(rtrim ($REPORT_TE,' '),' ') || ','
   
   let $REPORT_TE = ltrim(rtrim ($REPORT_TE,' '),' ') || ltrim(rtrim($TEXT_SEC_17_3,' '),' ')
   let $REPORT_TE = ltrim(rtrim ($REPORT_TE,' '),' ') || ','   
  
   let $REPORT_TE = ltrim(rtrim ($REPORT_TE,' '),' ') || ltrim(rtrim($TEXT_SEC_10_5,' '),' ')
   let $REPORT_TE = ltrim(rtrim ($REPORT_TE,' '),' ') || ','
   
   let $REPORT_TE = ltrim(rtrim ($REPORT_TE,' '),' ') || ltrim(rtrim($TEXT_SEC_10_10,' '),' ')
   let $REPORT_TE = ltrim(rtrim ($REPORT_TE,' '),' ') || ','
   
   let $REPORT_TE = ltrim(rtrim ($REPORT_TE,' '),' ') || ltrim(rtrim($TEXT_SEC_10_10A,' '),' ')
   let $REPORT_TE = ltrim(rtrim ($REPORT_TE,' '),' ') || ','
   
   let $REPORT_TE = ltrim(rtrim ($REPORT_TE,' '),' ') || ltrim(rtrim($TEXT_SEC_10_10AA,' '),' ')
   let $REPORT_TE = ltrim(rtrim ($REPORT_TE,' '),' ') || ','
   
   let $REPORT_TE = ltrim(rtrim ($REPORT_TE,' '),' ') || ltrim(rtrim($TEXT_SEC_10_13A,' '),' ')
   let $REPORT_TE = ltrim(rtrim ($REPORT_TE,' '),' ') || ','
   
   let $REPORT_TE = ltrim(rtrim ($REPORT_TE,' '),' ') || ltrim(rtrim($TEXT_SEC_10_OTH,' '),' ')
   let $REPORT_TE = ltrim(rtrim ($REPORT_TE,' '),' ') || ','
   
   let $REPORT_TE = ltrim(rtrim ($REPORT_TE,' '),' ') || ltrim(rtrim($TEXT_SEC_10_TOT,' '),' ')
   let $REPORT_TE = ltrim(rtrim ($REPORT_TE,' '),' ') || ','
   
   let $REPORT_TE = ltrim(rtrim ($REPORT_TE,' '),' ') || ltrim(rtrim($TEXT_SEC_192_2B,' '),' ')
   let $REPORT_TE = ltrim(rtrim ($REPORT_TE,' '),' ') || ','
 
   ! New Code V6.5
   let $REPORT_TE = ltrim(rtrim ($REPORT_TE,' '),' ') || ltrim(rtrim($TEXT_SEC_80C_GRS,' '),' ')
   let $REPORT_TE = ltrim(rtrim ($REPORT_TE,' '),' ') || ','
   ! New Code V6.5
   
   let $REPORT_TE = ltrim(rtrim ($REPORT_TE,' '),' ') || ltrim(rtrim($TEXT_SEC_80C,' '),' ')
   let $REPORT_TE = ltrim(rtrim ($REPORT_TE,' '),' ') || ','

   ! New Code V6.5
   let $REPORT_TE = ltrim(rtrim ($REPORT_TE,' '),' ') || ltrim(rtrim($TEXT_SEC_80CCC_GRS,' '),' ')
   let $REPORT_TE = ltrim(rtrim ($REPORT_TE,' '),' ') || ','
   ! New Code V6.5
   
   let $REPORT_TE = ltrim(rtrim ($REPORT_TE,' '),' ') || ltrim(rtrim($TEXT_SEC_80CCC,' '),' ')
   let $REPORT_TE = ltrim(rtrim ($REPORT_TE,' '),' ') || ','
   
   ! New Code V6.5
   let $REPORT_TE = ltrim(rtrim ($REPORT_TE,' '),' ') || ltrim(rtrim($TEXT_SEC_80CCD1_GRS,' '),' ')
   let $REPORT_TE = ltrim(rtrim ($REPORT_TE,' '),' ') || ','   
   ! New Code V6.5
   
   let $REPORT_TE = ltrim(rtrim ($REPORT_TE,' '),' ') || ltrim(rtrim($TEXT_SEC_80CCD1,' '),' ')
   let $REPORT_TE = ltrim(rtrim ($REPORT_TE,' '),' ') || ','
   
   ! New Code V6.5
   let $REPORT_TE = ltrim(rtrim ($REPORT_TE,' '),' ') || ltrim(rtrim($TEXT_SEC_80CCD1B_GRS,' '),' ')
   let $REPORT_TE = ltrim(rtrim ($REPORT_TE,' '),' ') || ','   
   ! New Code V6.5
   
   let $REPORT_TE = ltrim(rtrim ($REPORT_TE,' '),' ') || ltrim(rtrim($TEXT_SEC_80CCD1B,' '),' ')
   let $REPORT_TE = ltrim(rtrim ($REPORT_TE,' '),' ') || ','

   ! New Code V6.5
   let $REPORT_TE = ltrim(rtrim ($REPORT_TE,' '),' ') || ltrim(rtrim($TEXT_SEC_80CCD2_GRS,' '),' ')
   let $REPORT_TE = ltrim(rtrim ($REPORT_TE,' '),' ') || ','   
   ! New Code V6.5
   
   let $REPORT_TE = ltrim(rtrim ($REPORT_TE,' '),' ') || ltrim(rtrim($TEXT_SEC_80CCD2,' '),' ')
   let $REPORT_TE = ltrim(rtrim ($REPORT_TE,' '),' ') || ','
  
   ! New Code V6.5
   let $REPORT_TE = ltrim(rtrim ($REPORT_TE,' '),' ') || ltrim(rtrim($TEXT_SEC_80D_GRS,' '),' ')
   let $REPORT_TE = ltrim(rtrim ($REPORT_TE,' '),' ') || ','   
   ! New Code V6.5
   
   let $REPORT_TE = ltrim(rtrim ($REPORT_TE,' '),' ') || ltrim(rtrim($TEXT_SEC_80D,' '),' ')
   let $REPORT_TE = ltrim(rtrim ($REPORT_TE,' '),' ') || ','

   ! New Code V6.5
   let $REPORT_TE = ltrim(rtrim ($REPORT_TE,' '),' ') || ltrim(rtrim($TEXT_SEC_80E_GRS,' '),' ')
   let $REPORT_TE = ltrim(rtrim ($REPORT_TE,' '),' ') || ','   
   ! New Code V6.5
   
   let $REPORT_TE = ltrim(rtrim ($REPORT_TE,' '),' ') || ltrim(rtrim($TEXT_SEC_80E,' '),' ')
   let $REPORT_TE = ltrim(rtrim ($REPORT_TE,' '),' ') || ','
   
   ! New Code V6.5
   let $REPORT_TE = ltrim(rtrim ($REPORT_TE,' '),' ') || ltrim(rtrim($TEXT_SEC_80G_GRS,' '),' ')
   let $REPORT_TE = ltrim(rtrim ($REPORT_TE,' '),' ') || ','
   
   let $REPORT_TE = ltrim(rtrim ($REPORT_TE,' '),' ') || ltrim(rtrim($TEXT_SEC_80G_QUAL,' '),' ')
   let $REPORT_TE = ltrim(rtrim ($REPORT_TE,' '),' ') || ','
   ! New Code V6.5
   
   let $REPORT_TE = ltrim(rtrim ($REPORT_TE,' '),' ') || ltrim(rtrim($TEXT_SEC_80G,' '),' ')
   let $REPORT_TE = ltrim(rtrim ($REPORT_TE,' '),' ') || ','
  
   ! New Code V6.5
   let $REPORT_TE = ltrim(rtrim ($REPORT_TE,' '),' ') || ltrim(rtrim($TEXT_SEC_80TTA_GRS,' '),' ')
   let $REPORT_TE = ltrim(rtrim ($REPORT_TE,' '),' ') || ','
   
   let $REPORT_TE = ltrim(rtrim ($REPORT_TE,' '),' ') || ltrim(rtrim($TEXT_SEC_80TTA_QUAL,' '),' ')
   let $REPORT_TE = ltrim(rtrim ($REPORT_TE,' '),' ') || ','
   ! New Code V6.5
   
   let $REPORT_TE = ltrim(rtrim ($REPORT_TE,' '),' ') || ltrim(rtrim($TEXT_SEC_80TTA,' '),' ')
   let $REPORT_TE = ltrim(rtrim ($REPORT_TE,' '),' ') || ','
   
   let $REPORT_TE = ltrim(rtrim ($REPORT_TE,' '),' ') || ltrim(rtrim($TEXT_SEC_87A,' '),' ')
   let $REPORT_TE = ltrim(rtrim ($REPORT_TE,' '),' ') || ','   

   ! New Code V6.5
   let $REPORT_TE = ltrim(rtrim ($REPORT_TE,' '),' ') || ltrim(rtrim($TEXT_SEC_CH6OTH_GRS,' '),' ')
   let $REPORT_TE = ltrim(rtrim ($REPORT_TE,' '),' ') || ','
   
   let $REPORT_TE = ltrim(rtrim ($REPORT_TE,' '),' ') || ltrim(rtrim($REPORT_TEXT53,' '),' ')
   let $REPORT_TE = ltrim(rtrim ($REPORT_TE,' '),' ') || ','
   ! New Code V6.5
   
   write 2 from $REPORT_TE

    let $REPORT_TE = '' || ',' ||
                    '' || ',' ||
                    '' || ',' ||
                    '' || ',' ||
                    'Date From' || ',' ||
                    'Date To' || ','
   write 2 from $REPORT_TE

    let $REPORT_TE = '="[330]"' || ',' ||
                    '="[331]"' || ',' ||
                    '="[332]"' || ',' ||
                    '="[333]"' || ',' ||
                    '="[334]"' || ',' ||
                    '="[334]"' || ',' ||
                    '="[338]"' || ',' ||
                    '="[339]"' || ',' ||
                    '' || ',' ||
                    '="[349]"' || ',' ||
                    '="[350]"' || ',' ||
                    '="[348]"' || ',' ||
                    '="[351]"' || ',' ||  
                    '="[352]"' || ',' ||
                    '="[355]"' || ',' ||
                    '' || ',' ||
                    !'' || ',' ||
                    '="[366]"' || ',' ||
                    '="[367]"' || ',' ||
                    '="[368]"' || ',' ||
                    '="[370]"' || ',' ||
                    '="[371]"' || ',' ||
                    '="[372]"' || ',' ||
                    '="[373]"' || ',' ||
                    '="[374]"' || ',' ||
                    '="[375]"' || ',' ||
                    '="[376]"' || ',' ||
                    '="[377]"' || ',' || 
                    '="[345]"' || ',' ||
                    '="[345]"' || ',' ||
                    '="[345]"' || ',' ||
                    '' || ',' ||      
                    '="[345]"' || ',' ||
                    '' || ',' ||    
                    '="[345]"' || ',' ||
                    '' || ',' ||    
                    '="[345]"' || ',' ||
                    '' || ',' ||    
                    
                    '="[353]"' || ',' ||
                    '="[353]"' || ',' ||
                    '="[353]"' || ',' ||
                    '="[353]"' || ',' ||
                    '="[353]"' || ',' ||
                    '="[353]"' || ',' ||
                    '="[353]"' || ',' ||
                    '="[353]"' || ',' ||
                    '="[353]"' || ',' ||
                    
                    '' || ',' ||    
                    '' || ',' ||    
                    '' || ',' ||    
                    '' || ',' ||
                    '' || ',' ||    
                    '' || ',' ||    
                    '' || ',' ||    
                    '' || ',' ||                    
                    
                      
                    
                    '="[335]"' || ',' ||
                    '="[336]"' || ',' ||
                    '="[337]"' || ',' ||
                    '="[340]"' || ',' ||
                    '="[341]"' || ',' ||
                    '="[342]"' || ',' ||
                    '="[343]"' || ',' ||
                    '="[344]"' || ',' ||
                    '="[346]"' || ',' ||
                    '="[347]"' || ',' ||
                    '="[354]"' || ',' ||
                    '' || ',' ||                      ! New Code V6.5
                    '="[356]"' || ',' ||
                    '' || ',' ||                      ! New Code V6.5
                    '="[357]"' || ',' ||
                    '' || ',' ||                      ! New Code V6.5
                    '="[358]"' || ',' ||
                    '' || ',' ||                      ! New Code V6.5
                    '="[359]"' || ',' ||
                    '' || ',' ||                      ! New Code V6.5
                    '="[360]"' || ',' ||
                    '' || ',' ||                      ! New Code V6.5
                    '="[361]"' || ',' ||
                    '' || ',' ||                      ! New Code V6.5
                    '="[362]"' || ',' ||
                    '' || ',' ||                      ! New Code V6.5
                    '' || ',' ||                      ! New Code V6.5
                    '="[363]"' || ',' ||
                    '' || ',' ||                      ! New Code V6.5
                    '' || ',' ||                      ! New Code V6.5
                    '="[364]"' || ',' ||
                    '="[369]"' || ',' ||              ! New Code V6.5
                    '' || ',' ||                      ! New Code V6.5
                    '="[365]"' || ','                 ! New Code V6.5

   write 2 from $REPORT_TE

  end-procedure

!************************************************************************
! Procedure Get-Annexure1-Data                                          *
!                                                                       *
!************************************************************************

Begin-Procedure Get-Annexure1-Data
   DO Get-Month-Detail

   if $WriteChlnData <>'1'
    let $Filename1 = '{FILEPREFIX}'|| 'Annexure1_'||$ANNEX1FILESUFFIX||'.csv' ||'{FILESUFFIX}'
    open $Filename1 as 1 for-writing record=9999:vary
    status = #filestat
     if #filestat != 0
        show 'Cannot open file ' $Filename1
     end-if
   end-if

   LET $BSRCODES = ''
   DO Get-bsr-Fields
   LET $DATESDEP   = ''
   LET $CHALLANNOS = ''
   DO Get-vh-date-Fields

   LET $SECTIONS = ''
   LET $SECTCODE = ''   
   LET $SECT197 = ''
   DO Get-section-Fields

   LET #LATEFEE = 0
   let $MRHDCHLN = ''
   DO Get-Fee_MinorHead-Fields

   LET #TOTAL_PAID = 0
   LET $INT_PAID   = '0'
   LET $OTHER_AMT  = '0'
   DO Get-INT-OTH-Fields
   LET $TOT_TDS = '0'
   

   DO Get-tot-Tds-Fields
   MOVE #TOTAL_PAID TO $TOTAL_PAID 99999999999.99

   if $WriteChlnData <>'1'
   do Print-Write-Output
   end-if

   IF RTRIM(LTRIM(&RNCT.GP_GENRPT_SORT_OPT, ' '), ' ') = '10'
      LET $WHERECL = 'ORDER BY Ab.GP_GENRPT_BREAK1, Ab.EMPLID, Ab.EMPL_RCD'
   ELSE
      LET $WHERECL = 'ORDER BY Ab.GP_GENRPT_BREAK1, EMPNMb.NAME, Ab.EMPL_RCD'
   END-IF

   let #sl_no      = 0
   LET #TL_totsal  = 0
   LET #TL_tds_cal = 0
   LET #TL_tdssur  = 0
   LET #TL_tdsedu  = 0
   LET #TL_tdsval  = 0
   LET #TL_tdsval  = 0
   let #DeducteeCnt = 0
   Let $list = '0'
   LET #Serial = 0
   LET $Val = '0'


Begin-Select DISTINCT
Ab.EMPLID
Ab.CAL_RUN_ID
Ab.EMPL_RCD
Ab.GP_PAYGROUP
Ab.CAL_ID
Ab.ORIG_CAL_RUN_ID
Ab.GP_GENRPT_BREAK1
Ab.PYMT_DT
Ab.PRD_END_DT
EMPNMb.NAME

    move &Ab.EMPLID          to $EmplIdAb
    move &Ab.CAL_RUN_ID      to $Cal_Run_Id
    move &Ab.GP_PAYGROUP     to $GP_Paygroup
    move &Ab.CAL_ID          to $Cal_ID
    move &Ab.ORIG_CAL_RUN_ID to $Orig_Cal_Id
    move &Ab.EMPL_RCD        to $Empl_Rec

    let $emppan = ''
    let $EMPIDPAN = &Ab.EMPLID
    do Get_Emp_TanPan_Info
    do Get-tds-Fields

    move #TaxableInc       to $VParm6   8888888888.88
    let $VParm4 = replace(rtrim(ltrim(&EMPNMb.NAME, ' '), ' '), ',', ' ')
    let $VParm2 = rtrim(ltrim(&Ab.EMPLID , ' '), ' ')
    let $Id = 'taxable_income'


  if $WriteChlnData <> '1'
  if $VParm6  = '0'  or   $VParm6  = '0.00'
  if $Val = '0'
     do Write-Validate-Header( $Id)
     LET $Val = '1'
  end-if

   Let #list = 1
   add 1 to #Serial

   let #count_taxable = #Serial + 4
   move #Serial to $VParm   888888
   do Write-Validate-Data( $VParm, $VParm2, $VParm4, $Id, #count_taxable)
  end-if
  end-if


   if  #tdsval <> 0 


     add 1 to #DeducteeCnt
     let #tds_cal = #tdsval - #tdssurmonth - #tdseducessmonth
   add 1 to #sl_no

   move #sl_no to $Parm1   888888
   let $Parm2 = rtrim(ltrim(&Ab.EMPLID , ' '), ' ')
   let $Parm3 = rtrim(ltrim($emppan    , ' '), ' ')

   if $Parm3 = ''
      let $Parm3 = $NilPan
   end-if

   let $Parm4 = replace(rtrim(ltrim(&EMPNMb.NAME, ' '), ' '), ',', ' ')
   move &Ab.PYMT_DT       to $Parm5   DD/MM/YYYY
   move #TaxableInc       to $Parm6   8888888888.88

        move #tds_cal          to $Parm7   8888888888.88
        move #tdssurmonth      to $Parm8   8888888888.88
        move #tdseducessmonth  to $Parm9   8888888888.88
        move #tdsval           to $Parm10  8888888888.88
        move #tdsval           to $Parm11  8888888888.88
        let $Parm12            =  $Parm5

        let #TL_totsal  = #TL_totsal  + #TaxableInc
        let #TL_tds_cal = #TL_tds_cal + #tds_cal
        let #TL_tdssur  = #TL_tdssur  + #tdssurmonth
        let #TL_tdsedu  = #TL_tdsedu  + #tdseducessmonth
        let #TL_tdsval  = #TL_tdsval  + #tdsval

        do get-date-deposited
        
        Let $sec197cert = ''
        Let $sect197rate = ''

        do Get-Emp-section-Fields

        !let $Parm14  = ''
        if rtrim($WriteChlnData,' ') <> '1'
            do Write-Annexure1-Data($Parm1, $Parm2, $Parm3, $Parm4,
                                    $Parm5, $Parm6, $Parm7, $Parm8,
                                    $Parm9, $Parm10,$Parm11,$Parm12,
                                    $Parm13,$sect197rate,$SECTCODE,$sec197cert)
            do Write-Deductee-Detail-Rec
        end-if
    end-if
    do initialize-empl-vars

    move &rnct.end_dt to $End_Date

FROM PS_GPIN_24Q_TMP Ab, PS_ESTAB_TBL_GPIN Cb, PS_NAMES  EMPNMb
WHERE EMPNMb.EMPLID     = Ab.EMPLID
and Ab.JOBINSTANCE      = #prcs_job_instance
AND Ab.PRD_BGN_DT       >= $Cal_Prd_Bgn_Dt
AND Ab.PRD_END_DT       <= $Cal_Prd_End_Dt
and Cb.EFFDT            = (SELECT MAX(EFFDT) FROM PS_ESTAB_TBL_GPIN
                            WHERE ESTABID = Cb.ESTABID
                            and   EFFDT <= $Cal_Prd_End_Dt)
and EMPNMb.NAME_TYPE    = 'PRI'
and EMPNMb.EFFDT        = (SELECT MAX(EFFDT) FROM PS_NAMES
                           WHERE EMPLID = EMPNMb.EMPLID
                           and NAME_TYPE = EMPNMb.NAME_TYPE
                           and EFFDT <= $Cal_Prd_End_Dt)
and Ab.GP_GENRPT_BREAK1 [$ESTABIDIN]
[$WHERECL]
End-Select

   move #TL_totsal  to $Parm6   8888888888.88
   move #TL_tds_cal to $Parm7   8888888888.88
   move #TL_tdssur  to $Parm8   8888888888.88
   move #TL_tdsedu  to $Parm9   8888888888.88
   move #TL_tdsval  to $Parm10  8888888888.88
   move #TL_tdsval  to $Parm11  8888888888.88

   if $WriteChlnData <> '1'
   do Write-Annexure1-Data( '', '', '', '',
                            '', '', '', '',
                            '', '', '', '',
                            '','','','')

   do Write-Annexure1-Data( 'Total', '', '', '',
                            '', $Parm6, $Parm7, $Parm8,
                            $Parm9, $Parm10,$Parm11,'',
                            '','','','')
   end-if
End-Procedure ! Get-Annexure1-Data

!*****************************************************************************
!  Procedure Get-bsr-Fields                                                  *
!                                                                            *
!*****************************************************************************

Begin-Procedure Get-bsr-Fields
if $EstRTAN = 'E' 
Begin-Select distinct
EST.GPIN_BSR_CODE

   let $BSRCODES = $BSRCODES || ' ' || rtrim(ltrim(&EST.GPIN_BSR_CODE, ' '), ' ')

   move &RNCT.ESTABID to $Estab_Id

FROM PS_GPIN_QT_F24_DTL EST
WHERE EST.ESTABID [$ESTABIDIN] 
and EST.GPIN_YEAR_CD    = &RNCT.GPIN_YEAR_CD
and EST.CAL_PRD_ID      = $CAL_PRD_ID
AND EST.GPIN_SR_NBR     = #GPIN_SR_NBR
and EST.GPIN_QUARTER_ID = &RNCT.GPIN_QUARTER_ID
End-Select
else
Begin-Select distinct
TAN.GPIN_BSR_CODE

   let $BSRCODES = $BSRCODES || ' ' || rtrim(ltrim(&TAN.GPIN_BSR_CODE, ' '), ' ')

FROM PS_GPIN_F24TAN_DTL TAN
WHERE TAN.GPIN_IT_TAN_NBR = $RCTAN 
and TAN.GPIN_YEAR_CD    = &RNCT.GPIN_YEAR_CD
and TAN.CAL_PRD_ID      = $CAL_PRD_ID
AND TAN.GPIN_SR_NBR     = #GPIN_SR_NBR
and TAN.GPIN_QUARTER_ID = &RNCT.GPIN_QUARTER_ID
End-Select
end-if

End-Procedure !Get-bsr-Fields

!***************************************************************************
!  Procedure:   get-date-deposited                                         *
!                                                                          *
!***************************************************************************

Begin-Procedure get-date-deposited
   move &Ab.PRD_END_DT to $monthdep MON

if $EstRTAN = 'E'
Begin-Select
MAX(EST1.GPIN_VCHR_DT) &GPIN_VCHR_DT_EST

    MOVE &GPIN_VCHR_DT_EST TO $Parm13 DD/MM/YYYY
    MOVE &GPIN_VCHR_DT_EST TO $GPIN_VCH_DT DDMMYYYY

FROM PS_GPIN_QT_F24_DTL EST1
WHERE EST1.ESTABID [$ESTABIDIN]
AND EST1.GPIN_YEAR_CD = &RNCT.GPIN_YEAR_CD
AND EST1.GPIN_QUARTER_ID = &RNCT.GPIN_QUARTER_ID
AND EST1.GPIN_SR_NBR     = #GPIN_SR_NBR
AND EST1.CAL_PRD_ID      = $CAL_PRD_ID
End-Select
else
Begin-Select
MAX(TAN1.GPIN_VCHR_DT) &GPIN_VCHR_DT_TAN

   MOVE &GPIN_VCHR_DT_TAN TO $Parm13 DD/MM/YYYY
   MOVE &GPIN_VCHR_DT_TAN TO $GPIN_VCH_DT DDMMYYYY

FROM PS_GPIN_F24TAN_DTL TAN1
WHERE TAN1.GPIN_IT_TAN_NBR = $RCTAN
AND TAN1.GPIN_YEAR_CD = &RNCT.GPIN_YEAR_CD
AND TAN1.GPIN_QUARTER_ID = &RNCT.GPIN_QUARTER_ID
AND TAN1.GPIN_SR_NBR     = #GPIN_SR_NBR
AND TAN1.CAL_PRD_ID      = $CAL_PRD_ID
End-Select
end-if


End-Procedure !get-date-deposited

!*****************************************************************************
! Procedure:    Get-vh-date-Fields                                           *
!                                                                            *
!*****************************************************************************

Begin-Procedure Get-vh-date-Fields

if $EstRTAN = 'E'
Begin-Select distinct
EST2.GPIN_VCHR_NBR
EST2.GPIN_VCHR_DT

   MOVE &EST2.GPIN_VCHR_NBR TO $VNBR
   MOVE &EST2.GPIN_VCHR_DT  TO $VDT     DD/MM/YYYY

   LET $DATESDEP   = $DATESDEP   || ' ' || $VDT
   LET $CHALLANNOS = $CHALLANNOS || ' ' || RTRIM(LTRIM($VNBR, ' '), ' ')

FROM PS_GPIN_QT_F24_DTL EST2
WHERE EST2.ESTABID [$ESTABIDIN]
AND EST2.GPIN_YEAR_CD = &RNCT.GPIN_YEAR_CD
AND EST2.GPIN_QUARTER_ID = &RNCT.GPIN_QUARTER_ID
AND EST2.CAL_PRD_ID = $CAL_PRD_ID
AND EST2.GPIN_SR_NBR = #GPIN_SR_NBR
End-Select
else
Begin-Select distinct
TAN2.GPIN_VCHR_NBR
TAN2.GPIN_VCHR_DT

   MOVE &TAN2.GPIN_VCHR_NBR TO $VNBR
   MOVE &TAN2.GPIN_VCHR_DT  TO $VDT     DD/MM/YYYY

   LET $DATESDEP   = $DATESDEP   || ' ' || $VDT
   LET $CHALLANNOS = $CHALLANNOS || ' ' || RTRIM(LTRIM($VNBR, ' '), ' ')

FROM PS_GPIN_F24TAN_DTL TAN2
WHERE TAN2.GPIN_IT_TAN_NBR = $RCTAN
AND TAN2.GPIN_YEAR_CD = &RNCT.GPIN_YEAR_CD
AND TAN2.GPIN_QUARTER_ID = &RNCT.GPIN_QUARTER_ID
AND TAN2.CAL_PRD_ID = $CAL_PRD_ID
AND TAN2.GPIN_SR_NBR = #GPIN_SR_NBR
End-Select
end-if
End-Procedure !Get-vh-date-Fields

!*********************************************************************************
! Procedure: Get-section-Fields                                                  *
!                                                                                *
!*********************************************************************************

Begin-Procedure Get-section-Fields
if $EstRTAN = 'E'
Begin-Select distinct
EST3.GPIN_SECTION_DTL
EST3.GPIN_TDS_SECT_CODE

   LET $SECTIONS = $SECTIONS || ' ' || RTRIM(LTRIM(&EST3.GPIN_SECTION_DTL, ' '), ' ')
   MOVE &EST3.GPIN_TDS_SECT_CODE TO $SECTCODE

FROM PS_GPIN_QT_F24_DTL EST3
WHERE EST3.ESTABID [$ESTABIDIN]
AND EST3.GPIN_YEAR_CD = &RNCT.GPIN_YEAR_CD
AND EST3.GPIN_QUARTER_ID = &RNCT.GPIN_QUARTER_ID
AND EST3.CAL_PRD_ID = $CAL_PRD_ID
AND EST3.GPIN_SR_NBR= #GPIN_SR_NBR
End-Select
else
Begin-Select distinct
TAN3.GPIN_SECTION_DTL
TAN3.GPIN_TDS_SECT_CODE

   LET $SECTIONS = $SECTIONS || ' ' || RTRIM(LTRIM(&TAN3.GPIN_SECTION_DTL, ' '), ' ')
   MOVE &TAN3.GPIN_TDS_SECT_CODE TO $SECTCODE

FROM PS_GPIN_F24TAN_DTL TAN3
WHERE TAN3.GPIN_IT_TAN_NBR = $RCTAN
AND TAN3.GPIN_YEAR_CD = &RNCT.GPIN_YEAR_CD
AND TAN3.GPIN_QUARTER_ID = &RNCT.GPIN_QUARTER_ID
AND TAN3.CAL_PRD_ID = $CAL_PRD_ID
AND TAN3.GPIN_SR_NBR= #GPIN_SR_NBR
End-Select
end-if

End-Procedure !Get-section-Fields


!*********************************************************************************
! Procedure: Get-Emp-section-Fields                                                  *
!                                                                                *
!*********************************************************************************
Begin-Procedure Get-Emp-section-Fields

if $EstRTAN = 'E'
Begin-Select distinct
EST4.GPIN_SEC197_DED
EST4.GPIN_CERTNO_SEC197

   MOVE &EST4.GPIN_SEC197_DED TO $sect197rate 
   MOVE &EST4.GPIN_CERTNO_SEC197 TO $sec197cert

FROM PS_GPIN_QTF24_EPAN EST4
WHERE EST4.ESTABID [$ESTABIDIN]
AND EST4.GPIN_YEAR_CD = &RNCT.GPIN_YEAR_CD
AND EST4.GPIN_QUARTER_ID = &RNCT.GPIN_QUARTER_ID
AND EST4.CAL_PRD_ID = $CAL_PRD_ID
AND EST4.GPIN_SR_NBR= #GPIN_SR_NBR
AND EST4.EMPLID=&Ab.EMPLID
End-Select
else
Begin-Select distinct
TAN4.GPIN_SEC197_DED
TAN4.GPIN_CERTNO_SEC197

   MOVE &TAN4.GPIN_SEC197_DED TO $sect197rate 
   MOVE &TAN4.GPIN_CERTNO_SEC197 TO $sec197cert

FROM PS_GPIN_F24TN_EPAN TAN4
WHERE TAN4.GPIN_IT_TAN_NBR = $RCTAN
AND TAN4.GPIN_YEAR_CD = &RNCT.GPIN_YEAR_CD
AND TAN4.GPIN_QUARTER_ID = &RNCT.GPIN_QUARTER_ID
AND TAN4.CAL_PRD_ID = $CAL_PRD_ID
AND TAN4.GPIN_SR_NBR= #GPIN_SR_NBR
AND TAN4.EMPLID=&Ab.EMPLID
End-Select
end-if
End-Procedure !Get-Emp-section-Fields


!*********************************************************************************
! Procedure: Get-Prev-Form24Q-Details                                            *
!                                                                                *
!*********************************************************************************

Begin-Procedure Get-Prev-Form24Q-Details

Let $Prev_F24Q-Exists = ''
Let $Prev_Token_No = ''


if $EstRTAN = 'E' 
    let $F24QMSTTBL = 'PS_GPIN_QT_F24_TBL '
    let $sWHR = 'ESTABID ' || $ESTABIDIN || ' '
else
    let $F24QMSTTBL = 'PS_GPIN_QT_F24_TAN'
    let $sWHR = 'GPIN_IT_TAN_NBR =' || '''' || $RCTAN ||'''' || ' '
end-if


Begin-Select distinct
GPIN_F24Q_EXISTS
GPIN_F24Q_TOKEN_NO

   MOVE &GPIN_F24Q_EXISTS TO $Prev_F24Q-Exists
   LET #Token_No = &GPIN_F24Q_TOKEN_NO
   MOVE #Token_No TO $Prev_Token_No 999999999999999


FROM [$F24QMSTTBL]
WHERE [$sWHR]
AND GPIN_YEAR_CD = &RNCT.GPIN_YEAR_CD
AND GPIN_QUARTER_ID = &RNCT.GPIN_QUARTER_ID
End-Select

End-Procedure !Get-Prev-Form24Q-Details


!*********************************************************************************
! Procedure: Get-Fee_MinorHead-Fields                                            *
!                                                                                *
!*********************************************************************************

Begin-Procedure Get-Fee_MinorHead-Fields

if $EstRTAN = 'E'
Begin-Select distinct
EST5.GPIN_LATE_FEE
EST5.GPIN_MRHD_CHLN

   LET #LATEFEE = &EST5.GPIN_LATE_FEE
   MOVE &EST5.GPIN_MRHD_CHLN TO $MRHDCHLN

FROM PS_GPIN_QT_F24_DTL EST5
WHERE EST5.ESTABID [$ESTABIDIN]
AND EST5.GPIN_YEAR_CD = &RNCT.GPIN_YEAR_CD
AND EST5.GPIN_QUARTER_ID = &RNCT.GPIN_QUARTER_ID
AND EST5.CAL_PRD_ID = $CAL_PRD_ID
AND EST5.GPIN_SR_NBR= #GPIN_SR_NBR
End-Select
else
Begin-Select distinct
TAN5.GPIN_LATE_FEE
TAN5.GPIN_MRHD_CHLN

   LET #LATEFEE = &TAN5.GPIN_LATE_FEE
   MOVE &TAN5.GPIN_MRHD_CHLN TO $MRHDCHLN

FROM PS_GPIN_F24TAN_DTL TAN5
WHERE TAN5.GPIN_IT_TAN_NBR = $RCTAN
AND TAN5.GPIN_YEAR_CD = &RNCT.GPIN_YEAR_CD
AND TAN5.GPIN_QUARTER_ID = &RNCT.GPIN_QUARTER_ID
AND TAN5.CAL_PRD_ID = $CAL_PRD_ID
AND TAN5.GPIN_SR_NBR= #GPIN_SR_NBR
End-Select
end-if

End-Procedure !Get-Fee_MinorHead-Fields


!***********************************************************************************
!  Procedure: Get-INT-OTH-Fields                                                   *
!                                                                                  *
!***********************************************************************************

Begin-Procedure Get-INT-OTH-Fields
   let #GPIN_TDS_INT_AMT = 0
   let #GPIN_TDS_OTH_AMT = 0

if $EstRTAN = 'E'
Begin-Select
SUM(EST6.GPIN_TDS_INT_AMT) &GPIN_TDS_INT_AMT_EST
SUM(EST6.GPIN_TDS_OTH_AMT) &GPIN_TDS_OTH_AMT_EST

   MOVE &GPIN_TDS_INT_AMT_EST TO $INT_PAID
   MOVE &GPIN_TDS_OTH_AMT_EST TO $OTHER_AMT
   let #GPIN_TDS_INT_AMT = &GPIN_TDS_INT_AMT_EST
   let #GPIN_TDS_OTH_AMT = &GPIN_TDS_OTH_AMT_EST


FROM PS_GPIN_QT_F24_DTL EST6
WHERE EST6.ESTABID [$ESTABIDIN]
AND EST6.GPIN_YEAR_CD = &RNCT.GPIN_YEAR_CD
AND EST6.GPIN_QUARTER_ID = &RNCT.GPIN_QUARTER_ID
AND EST6.CAL_PRD_ID = $CAL_PRD_ID
AND EST6.GPIN_SR_NBR = #GPIN_SR_NBR
End-Select
else
Begin-Select
SUM(TAN6.GPIN_TDS_INT_AMT) &GPIN_TDS_INT_AMT_TAN
SUM(TAN6.GPIN_TDS_OTH_AMT) &GPIN_TDS_OTH_AMT_TAN

   MOVE &GPIN_TDS_INT_AMT_TAN TO $INT_PAID
   MOVE &GPIN_TDS_OTH_AMT_TAN TO $OTHER_AMT
   let #GPIN_TDS_INT_AMT = &GPIN_TDS_INT_AMT_TAN
   let #GPIN_TDS_OTH_AMT = &GPIN_TDS_OTH_AMT_TAN

FROM PS_GPIN_F24TAN_DTL TAN6
WHERE TAN6.GPIN_IT_TAN_NBR = $RCTAN
AND TAN6.GPIN_YEAR_CD = &RNCT.GPIN_YEAR_CD
AND TAN6.GPIN_QUARTER_ID = &RNCT.GPIN_QUARTER_ID
AND TAN6.CAL_PRD_ID = $CAL_PRD_ID
AND TAN6.GPIN_SR_NBR = #GPIN_SR_NBR
End-Select

end-if


End-Procedure !Get-INT-OTH-Fields

!*********************************************************************************************
! Procedure:   Get-tot-Tds-Fields                                                              *
! Description: This prints the detail report field and also the Employee                     *
!              PAN number and Name details                                                  *
!                                                                                            *
!*********************************************************************************************

Begin-Procedure Get-tot-Tds-Fields
Begin-Select
SUM(MP31.CALC_RSLT_VAL)   &CALC_VAL21

   Move &CALC_VAL21 To #tot_td_an1

FROM PS_GPIN_24Q_TMP3 MP31, PS_GPIN_24Q_TMP MP1
WHERE  MP31.JOBINSTANCE = #prcs_job_instance
AND MP31.JOBINSTANCE     = MP1.JOBINSTANCE
AND MP31.EMPLID          = MP1.EMPLID
AND MP31.CAL_RUN_ID      = MP1.CAL_RUN_ID
AND MP31.EMPL_RCD        = MP1.EMPL_RCD
AND MP31.GP_PAYGROUP     = MP1.GP_PAYGROUP
AND MP31.CAL_ID          = MP1.CAL_ID
AND MP31.ORIG_CAL_RUN_ID = MP1.ORIG_CAL_RUN_ID
AND MP31.RSLT_SEG_NUM    = MP1.RSLT_SEG_NUM
AND MP31.RSLT_VER_NUM    = MP1.RSLT_VER_NUM
AND MP31.RSLT_REV_NUM    = MP1.RSLT_REV_NUM
AND MP1.PRD_BGN_DT       >= $Cal_Prd_Bgn_Dt
AND MP1.PRD_END_DT       <= $Cal_Prd_End_Dt
and MP1.GP_GENRPT_BREAK1 [$ESTABIDIN]
and MP31.GPIN_FLD_NAME = 'F24Q_TDS'
End-Select

   MOVE #tot_td_an1 TO $TOT_TDS

End-Procedure !Get-tot-Tds-Fields


!*********************************************************************************************
! Procedure:   Get-Tds-Fields                                                                *
! Description: This prints the detail report field and also the Employee                     *
!              PAN number and Name details  !                                                *
!                                                                                            *
!*********************************************************************************************

Begin-Procedure Get-Tds-Fields

   let #tds_cal = 0
   let #totsal  = 0
   let #tdsval  = 0
   let #tdssur  = 0
   let #tdsedu  = 0
   let #TaxableInc = 0
   let #tdssurmonth = 0
   let #tdseducessmonth  = 0

Begin-Select
MP31.GPIN_FLD_NAME
MP31.CAL_ID
SUM(MP31.CALC_RSLT_VAL)   &CALC_VAL1

   move &Ab.EMPLID to $EMPLID
   Move &mp31.gpin_fld_name  To  $rptfldname
   Move &CALC_VAL1 To #repval
   let $rptfldname = LTRIM(rtrim($rptfldname,' '), ' ')

   Evaluate  $rptfldname
      when = 'F24Q_TAXBL_AMT'
          ADD #repval to #TaxableInc
          break
      when = 'F24Q_TOTAL_SAL'
          ADD #repval to #totsal
          break
      when = 'F24Q_TDS'
          move #repval to #tdsval
          break
      when = 'F24Q_TDS_SURCH'
          move #repval to #tdssur
          break
      when = 'F24Q_SURCHR_MON'
          move #repval to #tdssurmonth
          break
      when = 'F24Q_TDS_EDUCES'
          move #repval to #tdsedu
          break
      when = 'F24Q_EDUCES_MON'
          move #repval to #tdseducessmonth
          break
   End-Evaluate

   let #tds_cal = #tdsval - #tdssur - #tdsedu

FROM PS_GPIN_24Q_TMP3 MP31,PS_GPIN_24Q_TMP MP1
WHERE  MP31.JOBINSTANCE = #prcs_job_instance
and MP1.JOBINSTANCE = #prcs_job_instance
AND MP31.EMPLID           = $EmplIdAb
AND MP31.CAL_RUN_ID       = $Cal_Run_Id
AND MP31.EMPL_RCD         = $Empl_Rec
AND MP31.GP_PAYGROUP      = $GP_Paygroup
AND MP31.CAL_ID           = $Cal_ID
AND MP31.ORIG_CAL_RUN_ID  = $Orig_Cal_Id
AND MP31.EMPLID          = MP1.EMPLID
AND MP31.CAL_RUN_ID      = MP1.CAL_RUN_ID
AND MP31.EMPL_RCD        = MP1.EMPL_RCD
AND MP31.GP_PAYGROUP     = MP1.GP_PAYGROUP
AND MP31.CAL_ID          = MP1.CAL_ID
AND MP31.ORIG_CAL_RUN_ID = MP1.ORIG_CAL_RUN_ID
AND MP31.RSLT_SEG_NUM    = MP1.RSLT_SEG_NUM
AND MP31.RSLT_VER_NUM    = MP1.RSLT_VER_NUM
AND MP31.RSLT_REV_NUM    = MP1.RSLT_REV_NUM
and MP1.GP_GENRPT_BREAK1 [$ESTABIDIN]
GROUP BY MP31.GPIN_FLD_NAME, MP31.CAL_ID
End-Select

End-Procedure !Get-Tds-Fields


!**********************************************************************************************
! Procedure: Get-Estab-Info                                                                   *
!                                                                                             *
!                                                                                             *
!**********************************************************************************************

Begin-Procedure Get-Estab-Info

   let #sl_no            = 0
   let $sav_emplid       = ''

   IF RTRIM(LTRIM(&RNCT.GP_GENRPT_SORT_OPT, ' '), ' ') = '10'
       LET $WHERECL = 'ORDER BY A.GP_GENRPT_BREAK1, A.EMPLID, A.EMPL_RCD'
   ELSE
       LET $WHERECL = 'ORDER BY A.GP_GENRPT_BREAK1, EMPNM.NAME, A.EMPL_RCD'
   END-IF

Begin-Select DISTINCT
A.EMPLID
A.EMPL_RCD
A.GP_GENRPT_BREAK1
EMPNM.NAME
EMPMNT.HIRE_DT
EMPMNT.REHIRE_DT
EMPMNT.TERMINATION_DT
TDS.GPIN_SR_CITIZEN
PERS.SEX
PER.BIRTHDATE

    Move &A.EMPLID to $Emp_Id
    Move &EMPNM.NAME To $empname
    If (&EMPMNT.REHIRE_DT > &EMPMNT.HIRE_DT)
        Move &EMPMNT.REHIRE_DT To $hrdt
    Else
        Move &EMPMNT.HIRE_DT To $hrdt
    End-If

    let #Fin_Yr = to_number(&RNCT.GPIN_YEAR_CD)
    let $Fin_Bgn_Dt = edit(#Fin_Yr, '9999')||'0401'
    let $Fin_Bgn_Dt = Strtodate($Fin_Bgn_Dt)

    if $hrdt < $Fin_Bgn_Dt
       let $hrdt = $Fin_Bgn_Dt
    end-if

    If (&EMPMNT.TERMINATION_DT <> '') and (&EMPMNT.TERMINATION_DT <= &RNCT.END_DT )
        Move &EMPMNT.TERMINATION_DT To $termntdt
    Else
        let #Fin_Yr = to_number(&RNCT.GPIN_YEAR_CD) + 1
        let $Fin_End_Dt = edit(#Fin_Yr, '9999')||'0331'
        let $termntdt = Strtodate($Fin_End_Dt)
    End-If

    let $B_date = edit(&PER.BIRTHDATE,'dd/mm/yyyy')
    let $B_mon = substr($B_date, 4,2)
    let $B_dd = substr($B_date,1,2)
    Let #EMP_AGE = floor(datediff(&RNCT.END_DT, &PER.BIRTHDATE,'year'))

  
    If ($cur_mon <  $B_mon) Or
            ($cur_mon =  $B_mon And
                $cur_dd < $B_dd) 
       let  #EMP_AGE = #EMP_AGE - 1
    End-If
  
    If #EMP_AGE >80
       let $val330 = 'O'
    Else
      If (&TDS.GPIN_SR_CITIZEN = 'Y')
            let $val330 = 'S'
      Else
          !if (&PERS.SEX = 'F')
          !  let $val330 = 'W'
          !Else
          let $val330 = 'G'
         !End-If
      End-if
    End-if
  
    let $EMPIDPAN = &A.EMPLID
    do Get_Emp_TanPan_Info
    let $emppan = rtrim(ltrim($emppan, ' '), ' ')

    if isblank($emppan) or length($emppan) = 0 or $emppan = ''
        let $PanNotExists = 'Y'
    else
        let $PanNotExists = 'N'
    end-if


   
    do Get-Rpt-Fields

    let #val334    = 0
    let #val334A   = 0
    let #val334B   = 0
    let #val336    = 0
    let #val337    = 0
    let #val339    = 0
    let #val338    = 0
    let #val340    = 0
    let #val341    = 0
    let #val342    = 0
    let #val343    = 0
    let #val344    = 0
    let #val345    = 0
    let #val345A   = 0
    let #val345B   = 0
    let #val346    = 0
    let #val347    = 0
    let #val348    = 0

    let #incnotsal = 0

    DO Get-Rpt-Yrly-Fields
    

    let #val334    = #tds_gross_sal - #sec16ded   !income chargible Under head Salaries , 351
    let #val334A   = #tds_curemp_income   !338
    let #val334B   = #tds_prevemp_income  !339
    let #val336    = #val334 + #incnotsal - #sec80rent !#tds_gross_sal - #sec16ded + #incnotsal   Gross total Income , 355
    let #val337    = #sec80cce  !17
    
    let #val_oth_chap6a   = 0
    let #val339    = #totchap6a + #val_oth_chap6a  !366

    !let #val338    = #val339 - #val337


    let #val338    = #val339 - #val337 - #sec80ccf  !#totchap6a - #sec80cce - #sec80ccf , sec80ccG not applicable for curent tax year  OTHER CHAPTER 6A DEDUCTIONS
    
    let #val_oth_chap6a = #val338

    if #val338 <> 0
      let #Chap6ADedCnt = 1
    end-if
    let #val340    = #val336 - #val339   !#tds_gross_sal - #sec16ded + #incnotsal - #totchap6a , Toatl taxable Income , 367
    let #val341    = #totinctax  !Income Tax on total Income , 368
    let #val342    = #tdssurcharge  !Surcharge, 370
    let #val343    = #EducationCess  !371
    let #val344    = #s89rel        !372, 
    let #val345    = #val341 + #val342 + #val343 - #val344  !#totinctax + #tdssurcharge + #EducationCess - #s89rel  , Net tax Liability, 373

    let #roundtax    = (#val345 / 10)
    let #roundtax    = round(#roundtax,0)
    let #val345    = (#roundtax * 10)

    let #val346    = #TdsYtd      !376
    let #roundtax1    = (#val346 / 10)
    let #roundtax1    = round(#roundtax1,0)
    let #val346   = (#roundtax1 * 10)       

    let #val345A = #val346 - #PrevTdsYtd   !#TdsYtd - #PrevTdsYtd   374
    let #roundtax2    = (#val345A / 10)
    let #roundtax2    = round(#roundtax2,0)
    let #val345A   = (#roundtax2 * 10)

    let #val345B = #PrevTdsYtd    !375
    let #roundtax3    = (#val345B / 10)
    let #roundtax3    = round(#roundtax3,0)
    let #val345B   = (#roundtax3 * 10)

    let #val347    = #val345 - #val346  !#totinctax + #tdssurcharge + #EducationCess - #s89rel - #TdsYtd

    let #sum8910   = #totsal + #hra + #TVAL1
    let #dif1213   = #sum8910 - #sec16ded
    let #sum1415   = #dif1213 + #incnotsal
    let #sum1718   = #sec80don + #sec80rent
    let #val19     = #totded + #sec80rent + #sec80don
    let #val21     = #sum1415 - #val19
    let #sum2627   = #tottds + #tdssur
    LET #inctaxpbl = #totinctax - #taxreb - #F24Q_REB_88B - #F24Q_REB_88C - #F24Q_REB_88D + #tdssur
    let #val29     = #inctaxpbl - #s89rel
    
    evaluate $assessment_year
    when = '2019 - 2020'
       let #sec16ded_SD = 40000
       break   
    when = '2020 - 2021'
       let #sec16ded_SD = 50000
       break   
       
    when = '2021 - 2022'
       let #sec16ded_SD = 50000
       break  
       
    end-evaluate
    
    let #val_sec16_2 = 0
    let #val_sec16_3 = #sec16ded-#sec16ded_SD
    let #val_shortfall = 0
   
    
    if #val345 > 0
       add 1 to #DeducteeCount
       add 1 to #sl_no

       let $Parm1 = edit(#sl_no,'999999')
       let $Parm2 = rtrim(ltrim($emppan, ' '), ' ')
       if $Parm2 = ''
        let $Parm2 = $NilPan
       end-if
       let $Parm3 = replace($empname,',',' ')
       let $Parm4 = $val330  !Employee Category S or G etc
       Do Format-DateTime($hrdt, $out, {DEFMDY}, '','')
       move $hrdt to $hrdt1 dd/mm/yyyy
       let $Parm5 = $hrdt1
       

        show 'Value 336:   '   #val336
       Do Format-DateTime($termntdt, $out, {DEFMDY}, '','')
       move $termntdt to $Term_Date dd/mm/yyyy
       let $Parm6  = $Term_Date
       let $Parm6A = edit(#val334A,'9999999999.99')   ! Current Emp
       let $Parm6B = edit(#val334B,'9999999999.99')    !Previous EMp
       let $Parm7  = edit(#tds_gross_sal,'9999999999.99')
       let $Parm7A = edit(0.00,'9999999999.99')
       let $Parm8  = edit(#sec16ded,'9999999999.99')                !52400
       let $Parm8A  = edit(#val_sec16_2,'9999999999.99')!16(ii)     0  Entertainment Tax
       let $Parm8B  = edit(#val_sec16_3,'9999999999.99')  !16(i)    2400 PT
       let $Parm8C  = edit(#sec16ded_SD,'9999999999.99')  !16(ia)  50000
       let $Parm9  = edit(#val334,'9999999999.99')
       let $Parm10 = edit(#incnotsal,'9999999999.99')
       !let $Parm10 = edit(#sec80rent,'9999999999.99') 
       let $Parm11 = edit(#val336,'9999999999.99')
       let $Parm12 = edit(#val337,'9999999999.99')      
       !let $Parm13 = edit(#val_oth_chap6a,'9999999999.99')  !New Code v6.5
       let $Parm14 = edit(#val339,'9999999999.99')
       let $Parm15 = edit(#val340,'9999999999.99')  !total taxable Income
       let $Parm16 = edit(#totinctax,'9999999999.99')
       let $Parm17 = edit(#tdssurcharge,'9999999999.99')!edit(#sec80rent,'9999999999.99')
       let $Parm18 = edit(#EducationCess,'9999999999.99')!edit(#totded,'9999999999.99')
       let $Parm19 = edit(#s89rel,'9999999999.99')!edit(#val19,'9999999999.99')
       let $Parm20 = edit(#val345,'9999999999.99')!edit(#val21,'9999999999.99')
       let $Parm20A = edit(#val345A,'9999999999.99')!edit(#val21,'9999999999.99')
       let $Parm20B = edit(#val345B,'9999999999.99')!edit(#val21,'9999999999.99')
       let $Parm21 = edit(#val346,'9999999999.99')!edit(#totinctax,'9999999999.99')
       let $Parm22 = edit(#val_shortfall,'9999999999.99')!edit(#taxreb,'9999999999.99')
       let $Parm23 = $PanNotExists
       
       let $Param24 = edit(#val341,'9999999999.99')
       let $Param25 = edit(#val342,'9999999999.99')
       let $Param26 = edit(#val343,'9999999999.99')
       let $Param27 = edit(#val344,'9999999999.99')    
       let $Param31 = edit(#sec80cce,'9999999999.99')
       
       !new code for V6.4  starts
       
       let #F24Q_SEC10_TOT = #F24Q_SEC10_5 + #F24Q_SEC10_10 + #F24Q_SEC10_10A + #F24Q_SEC10_10AA + #F24Q_SEC10_13A + #F24Q_SEC10_OTH
       let $Parm32 = edit(#F24Q_SEC17_1,'9999999999.99')
       let $Parm33 = edit(#F24Q_SEC17_2,'9999999999.99')
       let $Parm34 = edit(#F24Q_SEC17_3,'9999999999.99')
       let $Parm35 = edit(#F24Q_SEC10_5,'9999999999.99')
       let $Parm36 = edit(#F24Q_SEC10_10,'9999999999.99')
       let $Parm37 = edit(#F24Q_SEC10_10A,'9999999999.99')
       let $Parm38 = edit(#F24Q_SEC10_10AA,'9999999999.99')
       let $Parm39 = edit(#F24Q_SEC10_13A,'9999999999.99')
       let $Parm40 = edit(#F24Q_SEC10_OTH,'9999999999.99')
       let $Parm41 = edit(#F24Q_SEC10_TOT,'9999999999.99')
       let $Parm42 = edit(#F24Q_SEC192_2B,'9999999999.99')
       !let $Parm43 = edit(#F24Q_SEC80C,'9999999999.99')
       !let $Parm44 = edit(#F24Q_SEC80CCC,'9999999999.99')
       let $Parm45 = edit(#F24Q_SEC80CCD1,'9999999999.99')
       let $Parm46 = edit(#F24Q_SEC80CCD1B,'9999999999.99')
       let $Parm47 = edit(#F24Q_SEC80CCD2,'9999999999.99')
       let $Parm48 = edit(#F24Q_SEC80D,'9999999999.99')
       let $Parm49 = edit(#F24Q_SEC80E,'9999999999.99')
       let $Parm50 = edit(#F24Q_SEC80TTA,'9999999999.99')


       !new code for v6.4 ends

       ! New Code v6.5
       let $Parm43_Gross = edit(#F24Q_80C_DECL,'9999999999.99')  ! Section 80C
       if #F24Q_80C_DECL > #lim_sec80c
          let $Parm43 = edit(#lim_sec80c ,'9999999999.99')
       else
          let $Parm43 = edit(#F24Q_80C_DECL ,'9999999999.99')
       end-if
       
       if #F24Q_80CCC_DECL > #lim_sec80ccc
          let $Parm44 = edit(#lim_sec80ccc,'9999999999.99')
       else
          let $Parm44 = edit(#F24Q_80CCC_DECL,'9999999999.99')
       end-if

       let $Parm44_Gross = edit(#F24Q_80CCC_DECL ,'9999999999.99')
       let $Parm45_Gross = edit(#F24Q_SEC80CCD1, '9999999999.99')
       let $Parm46_Gross = edit(#F24Q_SEC80CCD1B,'9999999999.99')
       let $Parm47_Gross = edit(#F24Q_SEC80CCD2,'9999999999.99')
       let $Parm48_Gross = edit(#F24Q_80D_DECL ,'9999999999.99')
       let $Parm51 = edit(#F24Q_80TTA_DECL,'9999999999.99')

       ! Section 80TTA Qualifying Amount
       if #lim_sec80tta > #F24Q_SEC80TTA            !#F24Q_80TTA_DECL
          let $Parm52 = edit(#F24Q_SEC80TTA,'9999999999.99')
       else
          let $Parm52 = edit(#lim_sec80tta,'9999999999.99')
       end-if

       let #temp3  = #sec80g_50 * 2
       let #temp3  = #temp3 + #sec80g_100  ! Section 80G Gross
       let #sec80don1 = #sec80g_50 + #sec80g_100
       
       
       let $Parm80G_Gross  = edit(#temp3,'9999999999.99')
       let $Parm80G_Qual   = edit(#sec80don1,'9999999999.99')
       let $Parm80G_Deduct = edit(#sec80don1,'9999999999.99')

       let $Parm_Rbt_sec_87A = edit(#taxreb,'9999999999.99')

       let $Parm53 = edit(#F24Q_80E_DECL,'9999999999.99')

       let $Parm13       = edit(#F24Q_6AOTH_QUAL,'9999999999.99')
       let $Parm13_Gross = edit(#F24Q_6AOTH_GROS,'9999999999.99')

       ! New Code v6.5


       let #DD_Tot_Sal1 = #totsal

       let #DD_TDS_IncTax = 0
       let #BatchGrsTotInc = #BatchGrsTotInc + #val336
       let #DD_TDS_Surcharge = 0
       let #DD_Edu_Cess = 0

       Move &A.EMPLID          to $EmplIdAb

       do get-dedcutee-tds
       let $FinYrBgnDt = ltrim(rtrim(&RNCT.GPIN_YEAR_CD,' '),' ') || '0401'
       
       if $WriteBatchHrd <> '1'
         if $Quarter = 'Q4'

           do Write-Salary-Detail-Rec
         end-if
    
         ! New Code V6.5
         !do Write-Annexure2-Data( $Parm1, $Parm2, $Parm3, $Parm4,
         !                                 $Parm5, $Parm6, $Parm6A, $Parm6B,$Parm7, $Parm8A , $Parm8B, $Parm8C, $Parm8,
         !                                 $Parm9, $Parm10,$Parm11,$Parm12, $Parm13, $Parm14,
         !                                 $Parm15,$Parm16,$Parm17,$Parm18, $Parm19, $Parm20A,
         !                                 $Parm20B,$Parm20, $Parm21,$Parm22,$Parm23,
         !                                 $Parm32,$Parm33, $Parm34,$Parm35,$Parm36,
         !                                 $Parm37,$Parm38,$Parm39,$Parm40, $Parm41, $Parm42,
         !                                 $Parm43,$Parm44,$Parm45,$Parm46, $Parm47, $Parm48,
         !                                 $Parm49,$Parm50
         !                                 )
         
         !new code v6.5+ starts
         !do Write-Annexure2-Data( $Parm1, $Parm2, $Parm3, $Parm4,
          !                                $Parm5, $Parm6, $Parm6A, $Parm6B,$Parm7, $Parm8A , $Parm8B, $Parm8C, $Parm8,
           !                               $Parm9, $Parm10,$Parm11,$Parm12, $Parm13, $Parm14,
            !                              $Parm15,$Parm16,$Parm17,$Parm18, $Parm19, $Parm20A,
             !                             $Parm20B,$Parm20, $Parm21,$Parm22,$Parm23,
              !                            $Parm32,$Parm33, $Parm34,$Parm35,$Parm36,
               !                           $Parm37,$Parm38,$Parm39,$Parm40, $Parm41, $Parm42, 
          !                          $Parm43_Gross, $Parm43, $Parm44_Gross, $Parm44, $Parm45_Gross, $Parm45, $Parm46_Gross, $Parm46, 
          !                                $Parm47_Gross, $Parm47, $Parm48_Gross, $Parm48, $Parm49_Gross, $Parm49, 
           !                               $Parm80G_Gross, $Parm80G_Qual, $Parm80G_Deduct, $Parm_Rbt_sec_87A ,
            !                              $Parm50, $Parm51, $Parm52, $Parm53, $Parm13_Gross
             !                       )
         ! New Code V6.5
       
              !$Parm16,$Parm17,$Parm18,
              !$Parm19,$Parm20,$Parm20A,$Parm20B,$Parm21,$Parm22,$Parm23, $Parm6A,$Parm6B,)
              
              
              
         do Write-Annexure2-Data( $Parm1, $Parm2, $Parm3, $Parm4,
                                          $Parm5, $Parm6, $Parm6A, $Parm6B,$Parm7, $Parm8A , $Parm8B, $Parm8C, $Parm8,
                                          $Parm9, $Parm10,$Parm11,$Parm12, $Parm13, $Parm14,
                                          $Parm15,$Parm16,$Parm17,$Parm18, $Parm19, $Parm20A,
                                          $Parm20B,$Parm20, $Parm21,$Parm22,$Parm23,
                                          $Parm32,$Parm33, $Parm34,$Parm35,$Parm36,
                                          $Parm37,$Parm38,$Parm39,$Parm40, $Parm41, $Parm42, 
                                  $Parm43_Gross, $Parm43, $Parm44_Gross, $Parm44, $Parm45_Gross, $Parm45, $Parm46_Gross,$Parm46, 
                                  $Parm47_Gross, $Parm47, $Parm48_Gross, $Parm48, $Parm49_Gross, $Parm49, 
                                  $Parm80G_Gross, $Parm80G_Qual, $Parm80G_Deduct, $Parm_Rbt_sec_87A ,
                                  $Parm50, $Parm51, $Parm52, $Parm53, $Parm13_Gross, $Parm54 , $Parm55 , $Parm56, $Parm57 ,
                                  $Parm58 , $Parm59 , $Parm60, $Parm61 , $Parm62 , $Parm63 , $Parm64 , $Parm65 , $Parm66 , $Parm67,
                                  $Parm68 , $Parm69 , $Parm70 , $Parm71 , $Parm72, $Parm73,  $Parm74 , $Parm75 , $Parm76, $Parm77 ,
                                  $Parm78 , $Parm79
                                  )
        !new code v6.5+ ends
       end-if
  end-if
  do initialize-empl-vars
  
  let #Chap6ADedCnt  = 0
  let #sec80cce_cnt = 0
  let #sec80ccf_cnt = 0

FROM PS_GPIN_24Q_TMP A , PS_ESTAB_TBL_GPIN C, PS_NAMES  EMPNM ,PS_EMPLOYMENT EMPMNT
,PS_GPIN_TDS_GEN TDS ,PS_PERS_DATA_EFFDT PERS,PS_PERSON PER
WHERE A.GP_GENRPT_BREAK1 = C.ESTABID
AND A.GP_GENRPT_BREAK1   [$ESTABIDIN]
AND EMPMNT.EMPLID        = EMPNM.EMPLID
AND EMPMNT.EMPLID        = A.EMPLID
AND A.JOBINSTANCE        = #prcs_job_instance
AND C.EFFDT              = (SELECT MAX(EFFDT) FROM PS_ESTAB_TBL_GPIN
                              WHERE ESTABID = C.ESTABID
                              AND   EFFDT <= &RNCT.END_DT)
AND EMPNM.NAME_TYPE      = 'PRI'
AND EMPNM.EFFDT          = (SELECT MAX(EFFDT) FROM PS_NAMES
                             WHERE EMPLID = EMPNM.EMPLID
                             AND NAME_TYPE = EMPNM.NAME_TYPE
                             AND EFFDT <= &rnct.end_dt)
AND TDS.EMPLID           = A.EMPLID
AND TDS.EFFDT            = (SELECT MAX(EFFDT) FROM PS_GPIN_TDS_GEN
                             WHERE EMPLID = TDS.EMPLID
                             AND EFFDT <= &rnct.end_dt)
AND PERS.EMPLID          = A.EMPLID
AND PERS.EFFDT           = (SELECT MAX(EFFDT) FROM PS_PERS_DATA_EFFDT
                             WHERE EMPLID   = PERS.EMPLID
                             AND EFFDT <= &rnct.end_dt)
AND PER.EMPLID = A.EMPLID
[$WHERECL]
End-Select

End-Procedure ! Get-Estab-Info

!************************************************************************
! Procedure: get-dedcutee-tds                                  *
! Descripton : Writing the Deductee Detail Record                       *
!                                                                       *
!************************************************************************
begin-procedure get-dedcutee-tds

   let #DD_TDS_IncTax    = 0
   let #DD_TDS_Surcharge = 0
   let #DD_Edu_Cess      = 0
   let #tds_cal          = 0
   let #totsal           = 0
   let #tdsval           = 0
   let #tdssur           = 0
   let #tdsedu           = 0

Begin-Select DISTINCT
Ab1.CAL_RUN_ID
Ab1.EMPL_RCD
Ab1.GP_PAYGROUP
Ab1.CAL_ID
Ab1.ORIG_CAL_RUN_ID

   move &Ab1.CAL_RUN_ID      to $Cal_Run_Id
   move &Ab1.GP_PAYGROUP     to $GP_Paygroup
   move &Ab1.CAL_ID          to $Cal_ID
   move &Ab1.ORIG_CAL_RUN_ID to $Orig_Cal_Id
   move &Ab1.EMPL_RCD        to $Empl_Rec

   do Get-tds-Fields

   let #DD_TDS_IncTax    = #DD_TDS_IncTax + (#tdsval - #tdssur - #tdsedu)
   let #DD_TDS_Surcharge = #DD_TDS_Surcharge + #tdssur
   let #DD_Edu_Cess      = #DD_Edu_Cess + #tdsedu

FROM PS_GPIN_24Q_TMP Ab1 , PS_ESTAB_TBL_GPIN Cb1, PS_NAMES  EMPNMb1
WHERE Ab1.GP_GENRPT_BREAK1 = Cb1.ESTABID
and Ab1.GP_GENRPT_BREAK1 [$ESTABIDIN]
and Ab1.EMPLID = $EmplIdAb
and EMPNMb1.EMPLID = Ab1.EMPLID
and Ab1.JOBINSTANCE = #prcs_job_instance
and Cb1.EFFDT = (SELECT MAX(EFFDT) FROM PS_ESTAB_TBL_GPIN
                 WHERE ESTABID = Cb1.ESTABID
                 and   EFFDT <= &RNCT.END_DT)
and EMPNMb1.NAME_TYPE = 'PRI'
and EMPNMb1.EFFDT = (SELECT MAX(EFFDT) FROM PS_NAMES
                    WHERE EMPLID = EMPNMb1.EMPLID
                    and NAME_TYPE = EMPNMb1.NAME_TYPE
                    and EFFDT <= &rnct.end_dt)
End-Select
end-procedure

!************************************************************************
! Procedure: Write-Deductee-Detail-Rec                                  *
! Descripton : Writing the Deductee Detail Record                       *
!                                                                       *
!************************************************************************

Begin-Procedure Write-Deductee-Detail-Rec

   let $DD_Tot1 = ''

   add 1 to #LineNum
   let $LineNum   = edit(#LineNum,'999999999')
   let #DD_Rec_No = #CD_Rec_No
   let $DD_Rec_No = edit(#DD_Rec_No,'999999999')
   let $DD_Batch_No = edit($DD_Batch_No,'999999999')
   let $DD_Sr_No  = edit(#sl_no,'999999999')
   let $DD_Emp_PAN       = ltrim(edit($emppan,'XXXXXXXXXX'),' ')
   if $DD_Emp_PAN = ''
       let $DD_Emp_PAN = $NilPan
   end-if

   let $RsnLwrDed = $sect197rate
   let $DD_Name_Of_Emp   = edit($Parm4,'XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX')

   do get-emp-dates

   let $DD_Emp_From_Date = edit($DD_Emp_From_Date,'XXXXXXXX')
   let $DD_Emp_To_Date   = edit($DD_Emp_To_Date,'XXXXXXXX')


   let $DD_tds_cal          = edit(#tds_cal,'999999999990.00')
   let $DD_tdssurmonth      = edit(#tdssurmonth,'999999999990.00')
   let $DD_tdseducessmonth  = edit(#tdseducessmonth,'999999999990.00')
   let $DD_tdsval           = edit(#tdsval,'999999999990.00')
   let $DD_TaxableInc       = edit(#TaxableInc,'999999999990.00')
   let $DD_AmtPd_Dt         = edit(&Ab.PYMT_DT,'DDMMYYYY')
   let $DD_Tax_Ded_Dt       = $DD_AmtPd_Dt
   !let $DD_Dep_Dt          = edit(&GPIN_VCH_DT,'DDMMYYYY')
   let $DD_Dep_Dt           = $GPIN_VCH_DT

   let #DD_Tot_Sal       = edit(#DD_Tot_Sal1,'999999999999V99')
   let $DD_Tot_Sal       = edit(#DD_Tot_Sal,'00000000000000')
   let #DD_HRA           = edit(#hra,'999999999999V99')
   let $DD_HRA           = edit(#DD_HRA,'00000000000000')
   let #DD_Perq_Val      = edit(#TVAL1,'999999999999V99')
   let $DD_Perq_Val      = edit(#DD_Perq_Val,'00000000000000')
   let #DD_Perq_Exmpt    = edit(#perqex,'999999999999V99')
   let $DD_Perq_Exmpt    = edit(#DD_Perq_Exmpt,'00000000000000')
   let #DD_Tot1          = edit(#sum8910,'999999999999V99')
   let $DD_Tot1          = edit(#DD_Tot1,'00000000000000')
   let #DD_Sec16_Ded     = edit(#sec16ded,'999999999999V99')
   let $DD_Sec16_Ded     = edit(#DD_Sec16_Ded,'00000000000000')
   let #DD_Inc_Sal       = edit(#dif1213,'999999999999V99')
   let $DD_Inc_Sal       = edit(#DD_Inc_Sal,'00000000000000')

   if #incnotsal >= 0
      let $DD_Flag_Oth_Inc = 'P'
   else
      let $DD_Flag_Oth_Inc = 'N'
   end-if

   let #DD_Inc_Otr_Sal     = edit(#incnotsal,'999999999999V99')
   let $DD_Inc_Otr_Sal     = edit(#DD_Inc_Otr_Sal,'0000000000000')
   let #DD_Inc_Otr_Sal     = edit(#sum1415,'999999999999V99')
   let $DD_Gross_Tot_Inc   = edit(#DD_Inc_Otr_Sal,'00000000000000')
   let #DD_Sect80G         = edit(#sec80don,'999999999999V99')
   let $DD_Sect80G         = edit(#DD_Sect80G,'00000000000000')
   let #DD_Sect80GG        = edit(#sec80rent,'999999999999V99')
   let $DD_Sect80GG        = edit(#DD_Sect80GG,'00000000000000')
   let #DD_Chap_VIA        = edit(#totded,'999999999999V99')
   let $DD_Chap_VIA        = edit(#DD_Chap_VIA,'00000000000000')
   let #DD_Tot_Chap_VIA    = edit(#val19,'999999999999V99')
   let $DD_Tot_Chap_VIA    = edit(#DD_Tot_Chap_VIA,'00000000000000')
   let #DD_Tot_Tax_Inc     = edit(#val21,'999999999999V99')
   let $DD_Tot_Tax_Inc     = edit(#DD_Tot_Tax_Inc,'00000000000000')
   let #DD_Inc_Tax_Tot_Inc = edit(#totinctax,'999999999999V99')
   let $DD_Inc_Tax_Tot_Inc = edit(#DD_Inc_Tax_Tot_Inc,'00000000000000')
   let #DD_Sect88          = edit(#taxreb,'999999999999V99')
   let $DD_Sect88          = edit(#DD_Sect88,'00000000000000')
   let #DD_Sect88B         = edit(#F24Q_REB_88B,'999999999999V99')
   let $DD_Sect88B         = edit(#DD_Sect88B,'00000000000000')
   let #DD_Sect88C         = edit(#F24Q_REB_88C,'999999999999V99')
   let $DD_Sect88C         = edit(#DD_Sect88C,'00000000000000')
   let #DD_Sect88D         = edit(#F24Q_REB_88D,'999999999999V99')
   let $DD_Sect88D         = edit(#DD_Sect88D,'00000000000000')
   let #DD_Inc_Tax_Paybl   = edit(#inctaxpbl,'999999999999V99')
   let $DD_Inc_Tax_Paybl   = edit(#DD_Inc_Tax_Paybl,'00000000000000')
   let #DD_Sect89          = edit(#s89rel,'999999999999V99')
   let $DD_Sect89          = edit(#DD_Sect89,'00000000000000')
   let #DD_Net_Tax_Paybl   = edit(#val29,'999999999999V99')
   let $DD_Net_Tax_Paybl   = edit(#DD_Net_Tax_Paybl,'00000000000000')

   let #DD_TDS_IncTax1     = edit(#DD_TDS_IncTax,'999999999999V99')
   let $DD_TDS_IncTax      = edit(#DD_TDS_IncTax1,'00000000000000')

   let #DD_TDS_Surcharge1  = edit(#DD_TDS_Surcharge,'999999999999V99')
   let $DD_TDS_Surcharge   = edit(#DD_TDS_Surcharge1,'00000000000000')

   let #DD_Edu_Cess1       = edit(#DD_Edu_Cess,'999999999999V99')
   let $DD_Edu_Cess        = edit(#DD_Edu_Cess1,'00000000000000')

   let #Tot_Tax_Ded_Src    = #DD_TDS_IncTax + #DD_TDS_Surcharge + #DD_Edu_Cess
   let #DD_TotTax_Ded_Src  = edit(#Tot_Tax_Ded_Src,'999999999999V99')
   let $DD_TotTax_Ded_Src  = edit(#DD_TotTax_Ded_Src,'00000000000000')

   let #Tax_Payable        = #val29 - #Tot_Tax_Ded_Src
   let #DD_Tax_Payable     = edit(#Tax_Payable,'99999999999V99')
   let $DD_Tax_Payable     = edit(#DD_Tax_Payable,'0000000000000')

   if #Tax_Payable >= 0
      let $DD_Flag_tax_Pybl = 'P'
   else
      let $DD_Flag_tax_Pybl = 'N'
   end-if

   let $DD_Remarks   = edit($DD_Remarks,'BBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBB')
   
   let $REPORT_TITLE = ltrim(rtrim($LineNum,' '),' ')||'^'
   let $REPORT_TITLE = $REPORT_TITLE || ltrim(rtrim($DD_Record_Type,' '),' ')||'^'
   let $REPORT_TITLE = $REPORT_TITLE || ltrim(rtrim($DD_Batch_No,' '),' ')||'^'
   let $REPORT_TITLE = $REPORT_TITLE || ltrim(rtrim($DD_Rec_No,' '),' ')||'^'
   let $REPORT_TITLE = $REPORT_TITLE || ltrim(rtrim($DD_Sr_No,' '),' ')||'^'
   let $REPORT_TITLE = $REPORT_TITLE || ltrim(rtrim($Mode,' '),' ')||'^'
   let $REPORT_TITLE = $REPORT_TITLE || ltrim(rtrim($EmplIdAb,' '),' ')||'^'
   let $REPORT_TITLE = $REPORT_TITLE || ltrim(rtrim($PartyCode,' '),' ')||'^'
   let $REPORT_TITLE = $REPORT_TITLE || ltrim(rtrim($PartyPan,' '),' ')||'^'
   let $REPORT_TITLE = $REPORT_TITLE || ltrim(rtrim($DD_Emp_PAN, ' '),' ')||'^'
   let $REPORT_TITLE = $REPORT_TITLE || ltrim(rtrim($LstPartyPanRefNo, ' '),' ')||'^'
   let $REPORT_TITLE = $REPORT_TITLE || ltrim(rtrim($PanRefNum, ' '),' ')||'^'
   let $REPORT_TITLE = $REPORT_TITLE || ltrim(rtrim($DD_Name_Of_Emp,' '),' ')||'^'
   let $REPORT_TITLE = $REPORT_TITLE || ltrim(rtrim($DD_tds_cal,' '),' ')||'^'
   let $REPORT_TITLE = $REPORT_TITLE || ltrim(rtrim($DD_tdssurmonth,' '),' ')||'^'
   let $REPORT_TITLE = $REPORT_TITLE || ltrim(rtrim($DD_tdseducessmonth,' '),' ')||'^'
   let $REPORT_TITLE = $REPORT_TITLE || ltrim(rtrim($DD_tdsval,' '),' ')||'^'
   let $REPORT_TITLE = $REPORT_TITLE || ltrim(rtrim($LstTDSDep,' '),' ')||'^'
   let $REPORT_TITLE = $REPORT_TITLE || ltrim(rtrim($DD_tdsval,' '),' ')||'^'
   let $REPORT_TITLE = $REPORT_TITLE || ltrim(rtrim($LstTotTaxDep,' '),' ')||'^'
   let $REPORT_TITLE = $REPORT_TITLE || ltrim(rtrim($TotValPurchase,' '),' ')||'^'
   let $REPORT_TITLE = $REPORT_TITLE || ltrim(rtrim($DD_TaxableInc,' '),' ')||'^'
   let $REPORT_TITLE = $REPORT_TITLE || ltrim(rtrim($DD_AmtPd_Dt,' '),' ')||'^'
   let $REPORT_TITLE = $REPORT_TITLE || ltrim(rtrim($DD_Tax_Ded_Dt,' '),' ')||'^'
   let $REPORT_TITLE = $REPORT_TITLE || ltrim(rtrim($DD_Dep_Dt,' '),' ')||'^'
   let $REPORT_TITLE = $REPORT_TITLE || ltrim(rtrim($RateTaxDed,' '),' ')||'^'
   let $REPORT_TITLE = $REPORT_TITLE || ltrim(rtrim($GrossInd,' '),' ')||'^'
   let $REPORT_TITLE = $REPORT_TITLE || ltrim(rtrim($Book_CashInd,' '),' ')||'^'
   let $REPORT_TITLE = $REPORT_TITLE || ltrim(rtrim($TaxDedCerDt,' '),' ')||'^'
   let $REPORT_TITLE = $REPORT_TITLE || ltrim(rtrim($RsnLwrDed,' '),' ')||'^'
   let $REPORT_TITLE = $REPORT_TITLE || ltrim(rtrim($Remark,' '),' ')||'^'
   let $REPORT_TITLE = $REPORT_TITLE || ltrim(rtrim($Remark,' '),' ')||'^'
   let $REPORT_TITLE = $REPORT_TITLE || ltrim(rtrim($SECTCODE,' '),' ')||'^'
   let $REPORT_TITLE = $REPORT_TITLE || ltrim(rtrim($sec197cert,' '),' ')||'^'
   let $REPORT_TITLE = $REPORT_TITLE || ltrim(rtrim($Filler1,' '),' ')||'^'
   let $REPORT_TITLE = $REPORT_TITLE || ltrim(rtrim($Filler2,' '),' ')||'^'
   let $REPORT_TITLE = $REPORT_TITLE || ltrim(rtrim($Filler3,' '),' ')||'^'
   let $REPORT_TITLE = $REPORT_TITLE || ltrim(rtrim($Filler4,' '),' ')||'^'
   let $REPORT_TITLE = $REPORT_TITLE || ltrim(rtrim($Filler5,' '),' ')||'^'
   let $REPORT_TITLE = $REPORT_TITLE || ltrim(rtrim($Filler6,' '),' ')||'^'
   let $REPORT_TITLE = $REPORT_TITLE || ltrim(rtrim($Filler7,' '),' ')||'^'
   let $REPORT_TITLE = $REPORT_TITLE || ltrim(rtrim($Filler8,' '),' ')||'^'
   let $REPORT_TITLE = $REPORT_TITLE || ltrim(rtrim($RCDHash,' '),' ')
   
   write 4 from $REPORT_TITLE ! Print Deductee Detail record

end-procedure


!************************************************************************
! Procedure: Write-Salary-Detail-Rec                                    *
! Description : Writing the Salary Detail Record                        *
!                                                                       *
!************************************************************************

Begin-Procedure Write-Salary-Detail-Rec

   
   add 1 to #LineNum
   let $LineNum      = edit(#LineNum,'999999999')
   !let #SD_Rec_No    = #CD_Rec_No
   let $SD_Rec_No    = edit($CD_Batch_No,'999999999')
   let $SD_Sr_No     = edit(#sl_no,'999999999')
   let $SD_Emp_PAN   = ltrim(edit($emppan,'XXXXXXXXXX'),' ')
   if $SD_Emp_PAN = ''
     let $SD_Emp_PAN = $NilPan
   end-if
   let $SD_Name_Of_Emp   = edit($Parm3,'XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX')
   let $SD_EmpCat        = $val330
   let $SD_Emp_From_Date = $DD_Emp_From_Date
   let $SD_Emp_To_Date   = $DD_Emp_To_Date
   let $SD_TotSal        = $Parm7
   let #SD_Sec16DecCnt   = #Sec16PTDedCnt + #Sec16StdDedCnt
   let $SD_Sec16DecCnt   = edit(#SD_Sec16DecCnt,'999999990')
   let $SD_sec16ded      = edit(#sec16ded,'999999999990.00')
   let $SD_IncChrgblSal  = edit(#val334,'999999999990.00')
   let $SD_incnotsal     = edit(#incnotsal,'999999999990.00')
   let $SD_GrsTotInc     = edit(#val336,'999999999990.00')
   let #Chap6ADedTotCnt  = #Chap6ADedCnt + #sec80cce_cnt + #sec80ccf_cnt
   let $SD_Chap6ADedTotCnt  = edit(#Chap6ADedTotCnt,'999999999')
   let $SD_Chap6ATotDed  = edit(#val339,'999999999990.00')
   let $SD_TotTaxInc     = edit(#val340,'999999999990.00')
   let $SD_totinctax     = edit(#val341,'999999999990.00')
   let $SD_tdssurcharge  = edit(#val342,'999999999990.00')




let $VParm4 = replace(rtrim(ltrim(&EMPNM.NAME, ' '), ' '), ',', ' ')
    let $VParm2 = rtrim(ltrim(&A.EMPLID , ' '), ' ')

if #val342 > (#val336 - #val339) or #val342 < 0 
    
  let $Id = 'surcharge'
  if $Val_surcharge = '0'
  do Write-Validate-Header( $Id)
  LET $Val_surcharge = '1'
  end-if

  add 1 to #Serial_surcharge

   let #count_surcharge = #Serial_surcharge + 4
   move #Serial_surcharge to $VParm   888888
   do Write-Validate-Data( $VParm, $VParm2, $VParm4, $Id, #count_surcharge)

end-if

if #val343 > (#val336 - #val339) or #val343 < 0 
   
 let $Id = 'educess'
  if $Val_educess = '0'
  do Write-Validate-Header( $Id)
  LET $Val_educess = '1'
  end-if

  add 1 to #Serial_educess

   let #count_educess = #Serial_educess + 4
   move #Serial_educess to $VParm   888888
   do Write-Validate-Data( $VParm, $VParm2, $VParm4, $Id, #count_educess)

end-if


if #val345 > (#val336 - #val339) or #val345 < 0 
   
 let $Id = 'net'

  if $Val_net = '0'
  do Write-Validate-Header( $Id)
  LET $Val_net = '1'
  end-if

  add 1 to #Serial_net

   let #count_net = #Serial_net + 4
   move #Serial_net to $VParm   888888
   do Write-Validate-Data( $VParm, $VParm2, $VParm4, $Id, #count_net)

end-if


   let $SD_tdssurcharge = edit(#val342,'999999999990.00')
   let $SD_EducationCess = edit(#val343,'999999999990.00')
   let $SD_s89rel        = edit(#val344,'999999999990.00')
   let $SD_NetIncTaxPybl = edit(#val345,'999999999990.00')
   let $SD_TdsYtd        = edit(#val346,'999999999990.00')
   let $SD_ShrtfallTaxDed= edit(#val347,'999999999990.00')

    let $SD_CurTaxamt = edit(#val334A,'9999999999.99')
    let $SD_PrevTaxamt = edit(#val334B,'9999999999.99')
    let $SD_CurTax = edit(#val345A,'9999999999.99')
    let $SD_PrevTax = edit(#val345B,'9999999999.99')
    let $SD_PANExist = $PanNotExists
    
    ! Whether aggregate rent payment exceeds rupees one lakh during previous year

    IF #F24_RENT_PAID > 100000 
        LET $SD_Rent_exceed_1Lakh = 'Y'
    ELSE
        LET $SD_Rent_exceed_1Lakh = 'N'
    END-IF 
    
    ! landlord details
    let #PAN_count = 0
    let $PAN_count = '0'
    let $PAN_Landlord1 = ''
    let $Name_Landlord1 = ''
    let $PAN_Landlord2 = ''
    let $Name_Landlord2 = ''
    let $PAN_Landlord3 = ''
    let $Name_Landlord3 = ''
    let $PAN_Landlord4 = ''
    let $Name_Landlord4 = ''        
    
    MOVE &RNCT.GPIN_YEAR_CD TO #HRA_year
    LET #HRA_year = #HRA_year + 1
    LET $HRA_year = EDIT(#HRA_year,'9999')
    
    if $SD_Rent_exceed_1Lakh = 'Y' 
        do Get-HRA-Details 
    end-if

        ! Lender's details
    
        DO Get-House-Inc-Loss 
    
    if $Int_paid_flag = 'N'
        let $PAN_cnt = '0'
        let $PAN_Lender1 = ''
        let $Name_Lender1 = ''
        let $PAN_Lender2 = ''
        let $Name_Lender2 = ''
        let $PAN_Lender3 = ''
        let $Name_Lender3 = ''
        let $PAN_Lender4 = ''
        let $Name_Lender4 = '' 
    end-if
    
    ! Superannuation Details
    
    LET $Superannuation_fund = 'N'
    LET $Name_superann = ''
    LET $DateFrom_Superann = ''
    let $DateTo_Superann = ''
    let $AmtRepaid_superann = ''
    let $Averaterate_Ded = ''
    let $AmtDed_Superann = ''
    Let $GrossTotal_Superann = ''
    
    ! Form24Q V6.4  starts
    !let $HRA_sec_10_13A        = edit(#hra,'999999999990.00')
    
    let #F24Q_SEC10_TOT = #F24Q_SEC10_5 + #F24Q_SEC10_10 + #F24Q_SEC10_10A + #F24Q_SEC10_10AA + #F24Q_SEC10_13A + #F24Q_SEC10_OTH
    
    
    let $Parm32 = edit(#F24Q_SEC17_1,'9999999999.99')
    let $Parm33 = edit(#F24Q_SEC17_2,'9999999999.99')
    let $Parm34 = edit(#F24Q_SEC17_3,'9999999999.99')
    let $Parm35 = edit(#F24Q_SEC10_5,'9999999999.99')
    let $Parm36 = edit(#F24Q_SEC10_10,'9999999999.99')
    let $Parm37 = edit(#F24Q_SEC10_10A,'9999999999.99')
    let $Parm38 = edit(#F24Q_SEC10_10AA,'9999999999.99')
    let $Parm39 = edit(#F24Q_SEC10_13A,'9999999999.99')
    let $Parm40 = edit(#F24Q_SEC10_OTH,'9999999999.99')
    let $Parm41 = edit(#F24Q_SEC10_TOT,'9999999999.99') 
    let $Param42 = edit(#F24Q_SEC192_2B,'9999999999.99')    
    !let $Parm43 = edit(#F24Q_SEC80C,'9999999999.99')  ! New Code v6.5
    !let $Parm44 = edit(#F24Q_SEC80CCC,'9999999999.99')  ! New Code v6.5
    let $Parm45 = edit(#F24Q_SEC80CCD1,'9999999999.99')
    let $Parm46 = edit(#F24Q_SEC80CCD1B,'9999999999.99')
    let $Parm47 = edit(#F24Q_SEC80CCD2,'9999999999.99')
    let $Parm48 = edit(#F24Q_SEC80D,'9999999999.99')
    let $Parm49 = edit(#F24Q_SEC80E,'9999999999.99')
    let $Parm50 = edit(#F24Q_SEC80TTA,'9999999999.99')


    let $SD_Sec_80 =   edit(#sec80cce,'999999999990.00')
    let $Gross_Sal_sec17_1 =  edit(#F24Q_SEC17_1, '999999999990.00')
    let $Val_Prereq_sec17_2 = edit(#F24Q_SEC17_2, '999999999990.00')
    let $Prof_Lieu_Sal_sec17_3 = edit(#F24Q_SEC17_2, '999999999990.00')
    let $Travel_Conc_sec_10_5 =  edit(#F24Q_SEC10_5,'999999999990.00')
    let $Death_Gra_sec_10_10 = edit(#F24Q_SEC10_10,'999999999990.00')
    let $Cummuted_pen_sec_10_10A = edit(#F24Q_SEC10_10A,'999999999990.00')
    let $Leave_encash_sec_10_10AA = edit(#F24Q_SEC10_10AA,'999999999990.00')
    let $HRA_sec_10_13A = edit(#F24Q_SEC10_13A,'999999999990.00')
    let $Amt_oth_sec_10 = edit(#F24Q_SEC10_OTH,'999999999990.00')
    let $Tot_Amt_sec_10 = edit(#F24Q_SEC10_TOT,'999999999990.00')
    let $Amt_Sec_192_2b = edit(#F24Q_SEC192_2B,'999999999990.00')
    let $Rbt_sec_87A =   edit(#taxreb,'999999999990.00')

    ! Form24Q V6.4  ends

    !version  6.5 starts  
    let $Parm43_Gross = edit(#F24Q_80C_DECL,'9999999999.99')
    let $Parm51 = edit(#F24Q_80TTA_DECL,'9999999999.99') 
    !version 6.5 ends

    !version 6.5+ starts
    
    let $Parm54 =  $SD_Rent_exceed_1Lakh
    let $Parm55 = ltrim(rtrim($PAN_Landlord1,' '),' ')
    let $Parm56 = ltrim(rtrim($Name_Landlord1,' '),' ')
    let $Parm57 = ltrim(rtrim($PAN_Landlord2,' '),' ')
    let $Parm58 = ltrim(rtrim($Name_Landlord2,' '),' ')
    let $Parm59 = ltrim(rtrim($PAN_Landlord3,' '),' ')
    let $Parm60 = ltrim(rtrim($Name_Landlord3,' '),' ')
    let $Parm61 = ltrim(rtrim($PAN_Landlord4,' '),' ')
    let $Parm62 = ltrim(rtrim($Name_Landlord4,' '),' ')
    
    let $Parm63 = ltrim(rtrim($Int_paid_flag,' '),' ')
    let $Parm64 = ltrim(rtrim($PAN_Lender1,' '),' ')
    let $Parm65 = ltrim(rtrim($Name_Lender1,' '),' ')
    let $Parm66 = ltrim(rtrim($PAN_Lender2,' '),' ')
    let $Parm67 = ltrim(rtrim($Name_Lender2,' '),' ')
    let $Parm68 = ltrim(rtrim($PAN_Lender3,' '),' ')
    let $Parm69 = ltrim(rtrim($Name_Lender3,' '),' ')
    let $Parm70 = ltrim(rtrim($PAN_Lender4,' '),' ')
    let $Parm71 = ltrim(rtrim($Name_Lender4,' '),' ')
    
    let $Parm72 = ltrim(rtrim($Superannuation_fund,' '),' ')
    let $Parm73 = ltrim(rtrim($Name_superann,' '),' ')
    let $Parm74 = ltrim(rtrim($DateFrom_Superann,' '),' ')
    let $Parm75 = ltrim(rtrim($DateTo_Superann,' '),' ')
    let $Parm76 = ltrim(rtrim($AmtRepaid_superann,' '),' ')
    let $Parm77 = ltrim(rtrim($Averaterate_Ded,' '),' ')
    let $Parm78 = ltrim(rtrim($AmtDed_Superann,' '),' ')
    let $Parm79 = ltrim(rtrim($GrossTotal_Superann,' '),' ')
    
    !version 6.5+ ends
    
   let $REPORT_TITLE = ltrim(rtrim($LineNum,' '),' ')||'^'
   let $REPORT_TITLE = $REPORT_TITLE || ltrim(rtrim($SD_Record_Type,' '),' ')||'^'
   let $REPORT_TITLE = $REPORT_TITLE || ltrim(rtrim($SD_Rec_No,' '),' ')||'^'
   let $REPORT_TITLE = $REPORT_TITLE || ltrim(rtrim($SD_Sr_No,' '),' ')||'^'
   let $REPORT_TITLE = $REPORT_TITLE || ltrim(rtrim($SD_Mode,' '),' ')||'^'
   let $REPORT_TITLE = $REPORT_TITLE || ltrim(rtrim($Filler7,' '),' ')||'^'
   let $REPORT_TITLE = $REPORT_TITLE || ltrim(rtrim($SD_Emp_PAN,' '),' ')||'^'
   let $REPORT_TITLE = $REPORT_TITLE || ltrim(rtrim($PanRefNum,' '),' ')||'^'
   let $REPORT_TITLE = $REPORT_TITLE || ltrim(rtrim($SD_Name_Of_Emp,' '),' ')||'^'
   let $REPORT_TITLE = $REPORT_TITLE || ltrim(rtrim($SD_EmpCat,' '),' ')||'^'
   let $REPORT_TITLE = $REPORT_TITLE || ltrim(rtrim($SD_Emp_From_Date,' '),' ')||'^'
   let $REPORT_TITLE = $REPORT_TITLE || ltrim(rtrim($SD_Emp_To_Date,' '),' ')||'^'
   let $REPORT_TITLE = $REPORT_TITLE || ltrim(rtrim($SD_TotSal,' '),' ')||'^'
   let $REPORT_TITLE = $REPORT_TITLE || ltrim(rtrim($Filler8,' '),' ')||'^'
   let $REPORT_TITLE = $REPORT_TITLE || ltrim(rtrim($SD_Sec16DecCnt,' '),' ')||'^'
   let $REPORT_TITLE = $REPORT_TITLE || ltrim(rtrim($SD_sec16ded,' '),' ')||'^'
   let $REPORT_TITLE = $REPORT_TITLE || ltrim(rtrim($SD_IncChrgblSal,' '),' ')||'^'
   let $REPORT_TITLE = $REPORT_TITLE || ltrim(rtrim($SD_incnotsal,' '),' ')||'^'
   let $REPORT_TITLE = $REPORT_TITLE || ltrim(rtrim($SD_GrsTotInc,' '),' ')||'^'
   let $REPORT_TITLE = $REPORT_TITLE || ltrim(rtrim($SD_LstGrsTotInc,' '),' ')||'^'
   let $REPORT_TITLE = $REPORT_TITLE || ltrim(rtrim($SD_Chap6ADedTotCnt,' '),' ')||'^'
   let $REPORT_TITLE = $REPORT_TITLE || ltrim(rtrim($SD_Chap6ATotDed,' '),' ')||'^'
   let $REPORT_TITLE = $REPORT_TITLE || ltrim(rtrim($SD_TotTaxInc,' '),' ')||'^'
   let $REPORT_TITLE = $REPORT_TITLE || ltrim(rtrim($SD_totinctax,' '),' ')||'^'
   let $REPORT_TITLE = $REPORT_TITLE || ltrim(rtrim($SD_tdssurcharge,' '),' ')||'^'
   let $REPORT_TITLE = $REPORT_TITLE || ltrim(rtrim($SD_EducationCess,' '),' ')||'^'
   let $REPORT_TITLE = $REPORT_TITLE || ltrim(rtrim($SD_s89rel,' '),' ')||'^'
   let $REPORT_TITLE = $REPORT_TITLE || ltrim(rtrim($SD_NetIncTaxPybl,' '),' ')||'^'
   let $REPORT_TITLE = $REPORT_TITLE || ltrim(rtrim($SD_TdsYtd,' '),' ')||'^'
   let $REPORT_TITLE = $REPORT_TITLE || ltrim(rtrim($SD_ShrtfallTaxDed,' '),' ')||'^'   
   let $REPORT_TITLE = $REPORT_TITLE || ltrim(rtrim($SD_Sec_80,' '),' ')||'^'  !newly added   
   let $REPORT_TITLE = $REPORT_TITLE || ltrim(rtrim($Remark,' '),' ')||'^'
   let $REPORT_TITLE = $REPORT_TITLE || ltrim(rtrim($Remark,' '),' ')||'^'
   !let $REPORT_TITLE = $REPORT_TITLE || ltrim(rtrim($Remark,' '),' ')||'^'
   let $REPORT_TITLE = $REPORT_TITLE || ltrim(rtrim($SD_CurTaxamt,' '),' ')||'^'
   let $REPORT_TITLE = $REPORT_TITLE || ltrim(rtrim($SD_PrevTaxamt,' '),' ')||'^'
   let $REPORT_TITLE = $REPORT_TITLE || ltrim(rtrim($SD_CurTax,' '),' ')||'^'
   let $REPORT_TITLE = $REPORT_TITLE || ltrim(rtrim($SD_PrevTax,' '),' ')||'^'
   let $REPORT_TITLE = $REPORT_TITLE || ltrim(rtrim($SD_PANExist,' '),' ')||'^'
   let $REPORT_TITLE = $REPORT_TITLE || ltrim(rtrim($SD_Rent_exceed_1Lakh,' '),' ')||'^'
   let $REPORT_TITLE = $REPORT_TITLE || ltrim(rtrim($PAN_count,' '),' ')||'^'
   let $REPORT_TITLE = $REPORT_TITLE || ltrim(rtrim($PAN_Landlord1,' '),' ')||'^'
   let $REPORT_TITLE = $REPORT_TITLE || ltrim(rtrim($Name_Landlord1,' '),' ')||'^'
   let $REPORT_TITLE = $REPORT_TITLE || ltrim(rtrim($PAN_Landlord2,' '),' ')||'^'
   let $REPORT_TITLE = $REPORT_TITLE || ltrim(rtrim($Name_Landlord2,' '),' ')||'^'
   let $REPORT_TITLE = $REPORT_TITLE || ltrim(rtrim($PAN_Landlord3,' '),' ')||'^'
   let $REPORT_TITLE = $REPORT_TITLE || ltrim(rtrim($Name_Landlord3,' '),' ')||'^'
   let $REPORT_TITLE = $REPORT_TITLE || ltrim(rtrim($PAN_Landlord4,' '),' ')||'^'
   let $REPORT_TITLE = $REPORT_TITLE || ltrim(rtrim($Name_Landlord4,' '),' ')||'^'
   let $REPORT_TITLE = $REPORT_TITLE || ltrim(rtrim($Int_paid_flag,' '),' ')||'^'
   let $REPORT_TITLE = $REPORT_TITLE || ltrim(rtrim($PAN_cnt,' '),' ')||'^'
   let $REPORT_TITLE = $REPORT_TITLE || ltrim(rtrim($PAN_Lender1,' '),' ')||'^'
   let $REPORT_TITLE = $REPORT_TITLE || ltrim(rtrim($Name_Lender1,' '),' ')||'^'
   let $REPORT_TITLE = $REPORT_TITLE || ltrim(rtrim($PAN_Lender2,' '),' ')||'^'
   let $REPORT_TITLE = $REPORT_TITLE || ltrim(rtrim($Name_Lender2,' '),' ')||'^'
   let $REPORT_TITLE = $REPORT_TITLE || ltrim(rtrim($PAN_Lender3,' '),' ')||'^'
   let $REPORT_TITLE = $REPORT_TITLE || ltrim(rtrim($Name_Lender3,' '),' ')||'^'
   let $REPORT_TITLE = $REPORT_TITLE || ltrim(rtrim($PAN_Lender4,' '),' ')||'^'
   let $REPORT_TITLE = $REPORT_TITLE || ltrim(rtrim($Name_Lender4,' '),' ')||'^'
   let $REPORT_TITLE = $REPORT_TITLE || ltrim(rtrim($Superannuation_fund,' '),' ')||'^'
   let $REPORT_TITLE = $REPORT_TITLE || ltrim(rtrim($Name_superann,' '),' ')||'^'
   let $REPORT_TITLE = $REPORT_TITLE || ltrim(rtrim($DateFrom_Superann,' '),' ')||'^'
   let $REPORT_TITLE = $REPORT_TITLE || ltrim(rtrim($DateTo_Superann,' '),' ')||'^'
   let $REPORT_TITLE = $REPORT_TITLE || ltrim(rtrim($AmtRepaid_superann,' '),' ')||'^'
   let $REPORT_TITLE = $REPORT_TITLE || ltrim(rtrim($Averaterate_Ded,' '),' ')||'^'
   let $REPORT_TITLE = $REPORT_TITLE || ltrim(rtrim($AmtDed_Superann,' '),' ')||'^'
   let $REPORT_TITLE = $REPORT_TITLE || ltrim(rtrim($GrossTotal_Superann,' '),' ')||'^'
   
   !new code
   Let $REPORT_TITLE = $REPORT_TITLE || ltrim(rtrim($Gross_Sal_sec17_1,' '),' ')||'^'
   Let $REPORT_TITLE = $REPORT_TITLE || ltrim(rtrim($Val_Prereq_sec17_2,' '),' ')||'^'
   Let $REPORT_TITLE = $REPORT_TITLE || ltrim(rtrim($Prof_Lieu_Sal_sec17_3,' '),' ')||'^'
   Let $REPORT_TITLE = $REPORT_TITLE || ltrim(rtrim($Travel_Conc_sec_10_5,' '),' ')||'^'
   Let $REPORT_TITLE = $REPORT_TITLE || ltrim(rtrim($Death_Gra_sec_10_10,' '),' ')||'^'
   Let $REPORT_TITLE = $REPORT_TITLE || ltrim(rtrim($Cummuted_pen_sec_10_10A,' '),' ')||'^'
   Let $REPORT_TITLE = $REPORT_TITLE || ltrim(rtrim($Leave_encash_sec_10_10AA,' '),' ')||'^'
   Let $REPORT_TITLE = $REPORT_TITLE || ltrim(rtrim($HRA_sec_10_13A,' '),' ')||'^'
   Let $REPORT_TITLE = $REPORT_TITLE || ltrim(rtrim($Amt_oth_sec_10,' '),' ')||'^'
   Let $REPORT_TITLE = $REPORT_TITLE || ltrim(rtrim($Tot_Amt_sec_10,' '),' ')||'^'
   Let $REPORT_TITLE = $REPORT_TITLE || ltrim(rtrim($Amt_Sec_192_2b,' '),' ')||'^'
   Let $REPORT_TITLE = $REPORT_TITLE || ltrim(rtrim($Rbt_sec_87A,' '),' ')||'^'
   
   !new code ends   
   let $REPORT_TITLE = $REPORT_TITLE || ltrim(rtrim($RCDHash,' '),' ')
       
   Write 4 from $REPORT_TITLE ! Print Salary Detail Records
   !do initialize-empl-vars
   
   if #SD_Sec16DecCnt <> 0
   let #sec16ded_SD = 0   
   evaluate $assessment_year
   when = '2019 - 2020'
    let #sec16ded_SD = 40000
    break   
    when = '2020 - 2021'
    let #sec16ded_SD = 50000
    break   
   end-evaluate
   
   let $S16_sec16ded_SD   = edit(#sec16ded_SD,'999999999990.00')   
   
   Do Write-Section16-Details
   end-if

   if #Chap6ADedTotCnt <> 0
    if #sec80cce_cnt <> 0
     let #C6A_sl_no = 0
     let $C6A_Section_ID = '80CCE'
     let $C6A_sec80cce   = edit(#sec80cce,'999999999990.00')
     let $C6A_GRS = edit(#sec80cce,'999999999990.00')  ! New Code v6.5
     !let $C6A_QUL  = edit(#lim_sec80cce,'999999999990.00') ! New Code v6.5
     let $C6A_QUL  = edit(0,'999999999990.00') ! New Code v6.5
     Do Write-Chapter6A-Details
    end-if
    if #sec80ccf_cnt <> 0 and #sec80ccf > 0
     let $C6A_Section_ID = '80CCF'
     let $C6A_sec80cce   = edit(#sec80ccf,'999999999990.00')
     let $C6A_GRS = edit(#sec80ccf,'999999999990.00')  ! New Code v6.5
     !let $C6A_QUL  = edit(#lim_sec80ccf,'999999999990.00')  ! New Code v6.5
     let $C6A_QUL  = edit(0,'999999999990.00')  ! New Code v6.5
     Do Write-Chapter6A-Details
   end-IF

    if #Chap6ADedCnt <> 0
     let $C6A_Section_ID = 'OTHERS'
     let $C6A_sec80cce   = edit(#val338,'999999999990.00')
     let $C6A_GRS = edit(#F24Q_6AOTH_GROS,'999999999990.00')  ! New Code v6.5
     let $C6A_QUL  = edit(#F24Q_6AOTH_QUAL,'999999999990.00')  ! New Code v6.5
     Do Write-Chapter6A-Details
    end-if
   end-if
end-procedure

!************************************************************************
! Procedure: Write-Section16-Details                                    *
! Description : Writing the Section 16 details                          *
!                                                                       *
!************************************************************************
Begin-Procedure Write-Section16-Details
   let #S16_sl_no = 0
   add 1 to #LineNum
   let $LineNum        = edit(#LineNum,'999999999')
   let $S16_Batch_No   = $CD_Batch_No
   let $S16_Rec_No     = $SD_Sr_No
   add 1 to #S16_sl_no
   let $S16_Sr_No      = edit(#S16_sl_no,'999999999')
   let $REPORT_TITLE = ltrim(rtrim($LineNum,' '),' ')||'^'                          !Increased by 1
   let $REPORT_TITLE = $REPORT_TITLE ||ltrim(rtrim($S16_Record_Type,' '),' ')||'^'  !Hardcoded to 'S16'
   let $REPORT_TITLE = $REPORT_TITLE ||ltrim(rtrim($S16_Batch_No,' '),' ')||'^'     !Hardcoded to 1
   let $REPORT_TITLE = $REPORT_TITLE ||ltrim(rtrim($S16_Rec_No,' '),' ')||'^'       !same as
   let $REPORT_TITLE = $REPORT_TITLE ||ltrim(rtrim($S16_Sr_No,' '),' ')||'^'
   let $REPORT_TITLE = $REPORT_TITLE ||ltrim(rtrim($S16_Section_ID_ia,' '),' ')||'^'    !Hardcoded to '16(ia)'
   let $REPORT_TITLE = $REPORT_TITLE ||ltrim(rtrim($S16_sec16ded_SD,' '),' ')||'^'
   let $REPORT_TITLE = $REPORT_TITLE || ltrim(rtrim($RCDHash,' '),' ')
   
   Write 4 from $REPORT_TITLE ! Print Section 16
   
   add 1 to #LineNum
   let $LineNum        = edit(#LineNum,'999999999')
   add 1 to #S16_sl_no
   let $S16_Sr_No      = edit(#S16_sl_no,'999999999')
   
   let #sec16ded_tmp  = #sec16ded - #sec16ded_SD
   let $S16_sec16ded   = edit(#sec16ded_tmp,'999999999990.00')
   
   let $REPORT_TITLE = ltrim(rtrim($LineNum,' '),' ')||'^'
   let $REPORT_TITLE = $REPORT_TITLE ||ltrim(rtrim($S16_Record_Type,' '),' ')||'^'  !Hardcoded to 'S16'
   let $REPORT_TITLE = $REPORT_TITLE ||ltrim(rtrim($S16_Batch_No,' '),' ')||'^'     !Hardcoded to 1
   let $REPORT_TITLE = $REPORT_TITLE ||ltrim(rtrim($S16_Rec_No,' '),' ')||'^'
   let $REPORT_TITLE = $REPORT_TITLE ||ltrim(rtrim($S16_Sr_No,' '),' ')||'^'
   let $REPORT_TITLE = $REPORT_TITLE ||ltrim(rtrim($S16_Section_ID,' '),' ')||'^'   !Hardcoded to '16(iii)'
   let $REPORT_TITLE = $REPORT_TITLE ||ltrim(rtrim($S16_sec16ded,' '),' ')||'^'
   let $REPORT_TITLE = $REPORT_TITLE || ltrim(rtrim($RCDHash,' '),' ')


   Write 4 from $REPORT_TITLE ! Print Section 16 
End-Procedure !Write-Section16-Details


!************************************************************************
! Procedure: Write-Chapter6A-Details                                    *
! Descripton : Writing the Chapter 6A details                           *
!                                                                       *
!************************************************************************

Begin-Procedure Write-Chapter6A-Details
   add 1 to #LineNum
   let $LineNum        = edit(#LineNum,'999999999')
   let $C6A_Batch_No   = $CD_Batch_No
   let $C6A_Rec_No     = $SD_Sr_No
   add 1 to #C6A_sl_no
   let $C6A_sl_no      = edit(#C6A_sl_no,'999999999')


   let $REPORT_TITLE = ltrim(rtrim($LineNum,' '),' ')||'^'
   let $REPORT_TITLE = $REPORT_TITLE ||ltrim(rtrim($C6A_Record_Type,' '),' ')||'^'
   let $REPORT_TITLE = $REPORT_TITLE ||ltrim(rtrim($C6A_Batch_No,' '),' ')||'^'
   let $REPORT_TITLE = $REPORT_TITLE ||ltrim(rtrim($C6A_Rec_No,' '),' ')||'^'
   let $REPORT_TITLE = $REPORT_TITLE ||ltrim(rtrim($C6A_sl_no,' '),' ')||'^'
   let $REPORT_TITLE = $REPORT_TITLE ||ltrim(rtrim($C6A_Section_ID,' '),' ')||'^'
   let $REPORT_TITLE = $REPORT_TITLE ||ltrim(rtrim($C6A_sec80cce,' '),' ')||'^'
   let $REPORT_TITLE = $REPORT_TITLE ||ltrim(rtrim($C6A_GRS,' '),' ')||'^'   ! New Code v6.5
   let $REPORT_TITLE = $REPORT_TITLE ||ltrim(rtrim($C6A_QUL,' '),' ')||'^'   ! New Code v6.5
   
   let $REPORT_TITLE = $REPORT_TITLE || ltrim(rtrim($RCDHash,' '),' ')

   Write 4 from $REPORT_TITLE ! Print Chapter VI-A Details

End-Procedure !Write-Chapter6A-Details



!************************************************************************
! Procedure: Write-Perquisite-Detail-Rec                                *
! Descripton : Writing the Perquisite Detail Record                     *
!                                                                       *
!************************************************************************

Begin-Procedure Write-Perquisite-Detail-Rec

   add 1 to #LineNum
   move #LineNum to $LineNum 000000000
   add 1 to #PD_Rec_No
   move #PD_Rec_No to $PD_Rec_No 000000000

   let $PD_Name_Of_Emp = edit($empname,'XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX')
   move #sl_no to $PD_Sr_No 000000000
   let #PD_Cost_Furniture = edit(#f24q_cost_furn,'999999999999V99')
   let $PD_Cost_Furniture = edit(#PD_Cost_Furniture,'00000000000000')
   let #PD_Perq_Val_Furn  = edit(#TVAL2,'999999999999V99')
   let $PD_Perq_Val_Furn  = edit(#PD_Perq_Val_Furn,'00000000000000')
   let #PD_Tot1           = edit(#TVAL,'999999999999V99')
   let $PD_Tot1           = edit(#PD_Tot1,'00000000000000')
   let $PD_Rent           = edit($Parm_Ann38,'00000000000000')
   let #PD_Convy          = edit(#f24q_perqconve,'999999999999V99')
   let $PD_Convy          = edit(#PD_Convy,'00000000000000')
   let #PD_Remun          = edit(#f24q_remun,'999999999999V99')
   let $PD_Remun          = edit(#PD_Remun,'00000000000000')
   let #PD_Free_Leave     = edit(#f24q_travel,'999999999999V99')
   let $PD_Free_Leave     = edit(#PD_Free_Leave,'00000000000000')
   let #PD_Otr_Benifit    = edit(#f24q_ben_other,'999999999999V99')
   let $PD_Otr_Benifit    = edit(#PD_Otr_Benifit,'00000000000000')
   let #PD_Emp_PF         = edit(#f24q_perqvalue,'999999999999V99')
   let $PD_Emp_PF         = edit(#PD_Emp_PF,'00000000000000')
   let #PD_PF_Interest    = edit(#f24q_interst,'999999999999V99')
   let $PD_PF_Interest    = edit(#PD_PF_Interest,'00000000000000')
   let #PD_Tot2           = edit(#TVAL3,'999999999999V99')
   let $PD_Tot2           = edit(#PD_Tot2,'00000000000000')

   let $REPORT_TITLE = ltrim(rtrim($LineNum,' '),' ')
   let $REPORT_TITLE = $REPORT_TITLE || ltrim(rtrim($PD_Rec_Type,' '),' ')
   let $REPORT_TITLE = $REPORT_TITLE || ltrim(rtrim($PD_Batch_Num,' '),' ')
   let $REPORT_TITLE = $REPORT_TITLE || ltrim(rtrim($PD_Rec_No,' '),' ')
   let $REPORT_TITLE = $REPORT_TITLE || ltrim($PD_Name_Of_Emp,' ')
   let $REPORT_TITLE = $REPORT_TITLE || ltrim(rtrim($PD_Sr_No,' '),' ')
   let $REPORT_TITLE = $REPORT_TITLE || ltrim(rtrim($PD_Val_Where_Accmo,' '),' ')
   let $REPORT_TITLE = $REPORT_TITLE || ltrim(rtrim($PD_Val_As_If,' '),' ')
   let $REPORT_TITLE = $REPORT_TITLE || ltrim(rtrim($PD_Cost_Furniture,' '),' ')
   let $REPORT_TITLE = $REPORT_TITLE || ltrim(rtrim($PD_Perq_Val_Furn,' '),' ')
   let $REPORT_TITLE = $REPORT_TITLE || ltrim(rtrim($PD_Tot1,' '),' ')
   let $REPORT_TITLE = $REPORT_TITLE || ltrim(rtrim($PD_Rent,' '),' ')
   let $REPORT_TITLE = $REPORT_TITLE || ltrim(rtrim($PD_Val_Of_Perq,' '),' ')
   let $REPORT_TITLE = $REPORT_TITLE || ltrim(rtrim($PD_Convy,' '),' ')
   let $REPORT_TITLE = $REPORT_TITLE || ltrim(rtrim($PD_Remun,' '),' ')
   let $REPORT_TITLE = $REPORT_TITLE || ltrim(rtrim($PD_Free_Leave,' '),' ')
   let $REPORT_TITLE = $REPORT_TITLE || ltrim(rtrim($PD_Otr_Benifit,' '),' ')
   let $REPORT_TITLE = $REPORT_TITLE || ltrim(rtrim($PD_Emp_PF,' '),' ')
   let $REPORT_TITLE = $REPORT_TITLE || ltrim(rtrim($PD_PF_Interest,' '),' ')
   let $REPORT_TITLE = $REPORT_TITLE || ltrim(rtrim($PD_Tot2,' '),' ')

   write 4 from $REPORT_TITLE ! Print Per-Requisite record


end-procedure

!************************************************************************
! Procedure: Perquisite_Detail                                          *
! Description: Gets Perquiaite record Values                            *
!                                                                       *
!************************************************************************

Begin-Procedure Perquisite_Detail

   let #sl_no = 0

Begin-Select DISTINCT
A1.EMPLID
EMPNM1.NAME

   do initialize-empl-vars

   let $Emp_Id  = ''
   let $empname = ''

   Move &A1.EMPLID to $Emp_Id
   Move &EMPNM1.NAME To $empname

   do Get-Rpt-Fields

   add 1 to #sl_no

   LET #TVAL       = (#f24q_cost_furn * 0.01) + #f24q_accom
   LET #TVAL3      =  #TVAL + + #f24q_perqconve + #f24q_remun + #f24q_travel + #f24q_ben_other
                            + #f24q_perqvalue + #f24q_interst
   LET #TVAL2      = #f24q_cost_furn * 0.01

   IF #f24q_cost_furn > 0
      let $PD_Val_As_If = edit(#f24q_accom,'00000000000000')
      let $PD_Val_Of_Perq = edit(#TVAL,'00000000000000')
      let $Parm_Ann33  = ''
      let $PD_Val_Where_Accmo = '00000000000000'
   ELSE
      let $Parm_Ann34  = ''
      let $PD_Val_As_If = '00000000000000'
      let $PD_Val_Where_Accmo = edit(#f24q_accom,'00000000000000' )
      let $PD_Val_Of_Perq = edit(#f24q_accom,'00000000000000')
   END-IF

   let $Parm_Ann38  = 0

   if (#f24q_accom      <> 0   or
       #f24q_cost_furn  <> 0   or
       #f24q_perqconve  <> 0   or
       #f24q_remun      <> 0   or
       #f24q_travel     <> 0   or
       #f24q_ben_other  <> 0   or
       #f24q_perqvalue  <> 0   or
       #f24q_interst    <> 0   or
       #perq            <> 0   )

       do Write-Perquisite-Detail-Rec

   end-if

FROM PS_GPIN_24Q_TMP A1 , PS_ESTAB_TBL_GPIN C, PS_NAMES  EMPNM1 ,PS_EMPLOYMENT EMPMNT
WHERE A1.GP_GENRPT_BREAK1 = C.ESTABID
AND A1.GP_GENRPT_BREAK1   [$ESTABIDIN]
AND EMPMNT.EMPLID         = EMPNM1.EMPLID
AND EMPMNT.EMPLID         = A1.EMPLID
AND A1.JOBINSTANCE        = #prcs_job_instance
AND C.EFFDT               = (SELECT MAX(EFFDT) FROM PS_ESTAB_TBL_GPIN
                              WHERE ESTABID = C.ESTABID
                              AND   EFFDT <= &RNCT.END_DT)
AND EMPNM1.NAME_TYPE      = 'PRI'
AND EMPNM1.EFFDT          = (SELECT MAX(EFFDT) FROM PS_NAMES
                             WHERE EMPLID = EMPNM1.EMPLID
                             AND NAME_TYPE = EMPNM1.NAME_TYPE
                             AND EFFDT <= &rnct.end_dt)
end-select

end-procedure


!************************************************************************
! Procedure: get-emp-dates                                              *
! Description: Gets the employees active dates in the financial yeat    *
!                                                                       *
!************************************************************************

Begin-Procedure get-emp-dates

   let $Fin_Start1 = ''
   let $Fin_End1 = ''



   let $Fin_End1    = strtodate($Fin_End,'YYYYMMDD')
   let $Date2       = edit($termntdt,'YYYYMMDD')
   let $Date4       = strtodate($Date2,'YYYYMMDD')

      let $DD_Emp_From_Date = edit($hrdt,'DDMMYYYY')

   if $Date4 = ''
      let $DD_Emp_To_Date = edit($Fin_End,'DDMMYYYY')
   else
      let #datedif = datediff($Fin_end1, $Date4, 'day')
      if #datedif < 0
         let $DD_Emp_To_Date = edit($Fin_End,'DDMMYYYY')
      else
         let $DD_Emp_To_Date = edit($Date4,'DDMMYYYY')
      end-if
   end-if
end-procedure


!************************************************************************
! Procedure: Get_Emp_TanPan_Info                                        *
!                                                                       *
!************************************************************************

Begin-Procedure Get_Emp_TanPan_Info
let $emppan = ''
Begin-Select
PNID.NATIONAL_ID

   Move &PNID.NATIONAL_ID To $emppan

FROM PS_PERS_NID PNID
WHERE PNID.COUNTRY = 'IND'
AND PNID.NATIONAL_ID_TYPE = 'PAN'
AND PNID.EMPLID = $EMPIDPAN 
AND PNID.NATIONAL_ID<>' '
End-Select

End-Procedure


!************************************************************************
! Procedure: Get-NILPAN-MSGEntry                                        *
!                                                                       *
!************************************************************************

Begin-Procedure Get-NILPAN-MSGEntry

let $NilPan = ''

BEGIN-SELECT
MSG.MESSAGE_TEXT

   let $NilPan = &MSG.MESSAGE_TEXT

FROM PSMSGCATDEFN MSG
WHERE MESSAGE_SET_NBR=17411
AND MESSAGE_NBR=250
END-SELECT

End-Procedure


!**************************************************************************
!Procedure: Get_Emp_TaxDedn_Details                                       *
!                                                                         *
!**************************************************************************

Begin-Procedure Get_Emp_TaxDedn_Details

if $EstRTAN = 'E' 
Begin-Select
ESPAN.GPIN_IT_PAN_NBR

   Move &ESPAN.GPIN_IT_PAN_NBR To $emppan1

FROM PS_GPIN_QTF24_EPAN ESPAN
WHERE ESPAN.ESTABID [$ESTABIDIN] 
and ESPAN.GPIN_YEAR_CD    = &RNCT.GPIN_YEAR_CD
and ESPAN.CAL_PRD_ID      = $CAL_PRD_ID
AND ESPAN.GPIN_SR_NBR     = #GPIN_SR_NBR
and ESPAN.GPIN_QUARTER_ID = &RNCT.GPIN_QUARTER_ID
AND ESPAN.EMPLID = &Ab.EMPLID
End-Select
else
Begin-Select
TNPAN.GPIN_IT_PAN_NBR

   Move &TNPAN.GPIN_IT_PAN_NBR To $emppan1

FROM PS_GPIN_F24TN_EPAN TNPAN
WHERE TNPAN.GPIN_IT_TAN_NBR = $RCTAN 
and TNPAN.GPIN_YEAR_CD    = &RNCT.GPIN_YEAR_CD
and TNPAN.CAL_PRD_ID      = $CAL_PRD_ID
AND TNPAN.GPIN_SR_NBR     = #GPIN_SR_NBR
and TNPAN.GPIN_QUARTER_ID = &RNCT.GPIN_QUARTER_ID
AND TNPAN.EMPLID = &Ab.EMPLID
End-Select
end-if

End-Procedure



!***************************************************************************
!Procedure:   Get-Rpt-Fields                                               *
!Description: This prints the detail report field and also the Employee    *
!             PAN number and Name details                                  *
!***************************************************************************

Begin-Procedure Get-Rpt-Fields

   do initialize-empl-vars

Begin-Select
MP3.GPIN_FLD_NAME
SUM(MP3.CALC_RSLT_VAL)   &CALC_VAL

   Move &mp3.gpin_fld_name  To  $rptfldname
   Move &CALC_VAL To #repval
   let $rptfldname = LTRIM(rtrim($rptfldname,' '), ' ')

   Evaluate  $rptfldname
      when = 'F24Q_TOTAL_SAL'
         ADD #repval to #totsal
         break
      when = 'F24Q_TDS'
         move #repval to #tdsval
         break
      when = 'F24Q_HRA_OTHALL'
         move #repval to #hra
         break
      when = 'F24Q_PERQAMT'
         move #repval to #perq
         break
      when = 'F24Q_PERQAMT_EX'
         move #repval to #perqex
         break
      when = 'F24Q_INC_NOT_SL'
         move #repval to #incnotsal
        break

      when = 'F24Q_S80GG_RENT'
         move #repval to #sec80rent
         break
      when = 'F24Q_TOT_TAX_RE'
         move #repval to #taxreb
         break
      when = 'F24Q_S89_RELIEF'
         move #repval to #s89rel
         break
      when = 'F24Q_TOTAL_TDS'
         move #repval to #tottds
         break
      when = 'F24Q_TOT_DEDTN'
         move #repval to #totded
         break
      when = 'F24Q_ACCOM'
         move #repval to   #f24q_accom
         break
      when = 'F24Q_BEN_OTHER'
         move #repval to   #f24q_ben_other
         break
      when = 'F24Q_COST_FURN'
         move #repval to   #f24q_cost_furn
         break
      when = 'F24Q_INTERST'
         move #repval to  #f24q_interst
         break
      when = 'F24Q_PERQCONVE'
         move #repval to   #f24q_perqconve
         break
      when = 'F24Q_PERQFURN'
         move #repval to   #f24q_perqfurn
         break
      when = 'F24Q_PERQVALUE'
         move #repval to  #f24q_perqvalue
         break
      when = 'F24Q_REMUN'
         move #repval to  #f24q_remun
         break
      when = 'F24Q_TRAVEL'
         move #repval to   #f24q_travel
         break
      when = 'F24Q_VALUE_ACCO'
         move #repval to   #f24q_value_acco
         break
      when = 'F24Q_REB_88B'
         move #repval to   #F24Q_REB_88B
         break
      when = 'F24Q_REB_88C'
         move #repval to   #F24Q_REB_88C
         break
      when = 'F24Q_REB_88D'   ! new
         move #repval to   #F24Q_REB_88D
         break
      when = 'F24Q_PT_DED'
         let #Sec16PTDedCnt = 1
         break
      when = 'F24Q_STD_DED'
         let #Sec16StdDedCnt = 1
         break

   End-Evaluate

FROM PS_GPIN_24Q_TMP3 MP3, PS_GPIN_24Q_TMP MP
WHERE  MP3.JOBINSTANCE = #prcs_job_instance
AND MP3.EMPLID = $Emp_Id
AND MP3.JOBINSTANCE     = MP.JOBINSTANCE
AND MP3.EMPLID          = MP.EMPLID
AND MP3.CAL_RUN_ID      = MP.CAL_RUN_ID
AND MP3.EMPL_RCD        = MP.EMPL_RCD
AND MP3.GP_PAYGROUP     = MP.GP_PAYGROUP
AND MP3.CAL_ID          = MP.CAL_ID
AND MP3.ORIG_CAL_RUN_ID = MP.ORIG_CAL_RUN_ID
AND MP3.RSLT_SEG_NUM    = MP.RSLT_SEG_NUM
AND MP3.RSLT_VER_NUM    = MP.RSLT_VER_NUM
AND MP3.RSLT_REV_NUM    = MP.RSLT_REV_NUM
and MP.GP_GENRPT_BREAK1 [$ESTABIDIN]
GROUP BY MP3.GPIN_FLD_NAME

End-Select
End-Procedure !Get-Rpt-Fields

!***********************************************************************
! Procedure: Get-Rpt-Yrly-Fields-Other                                 *
!                                                                      *
!                                                                      *
!***********************************************************************
Begin-procedure Get-Rpt-Yrly-Fields-Other

         let #totinctax = 0
         let #tdssurcharge = 0
         let #EducationCess = 0
         let #totinctax1 = 0
         let #tdssurcharge1 = 0
         let #EducationCess1 = 0

Begin-Select
MP32.GPIN_FLD_NAME
MP32.CAL_ID
AVG(MP32.CALC_RSLT_VAL) &SUM_VAL

   let $evl = ltrim(rtrim(&MP32.GPIN_FLD_NAME,' '),' ')
   Evaluate $evl
      
      when = 'F24Q_TDS'
         move &SUM_VAL to #totinctax1
         let #totinctax = #totinctax + #totinctax1
      break
      when = 'F24Q_SURCHR_MON'
         move &SUM_VAL to #tdssurcharge1
         let #tdssurcharge = #tdssurcharge + #tdssurcharge1
      break
      when = 'F24Q_EDUCES_MON'
         move &SUM_VAL to #EducationCess1
         let #EducationCess = #EducationCess + #EducationCess1
         break
   End-Evaluate

FROM PS_GPIN_24Q_TMP3 MP32,PS_GPIN_24Q_TMP MP2
WHERE  MP32.JOBINSTANCE = #prcs_job_instance
AND MP2.JOBINSTANCE = #prcs_job_instance
AND MP32.EMPLID           = $Emp_Id
AND MP32.EMPLID          = MP2.EMPLID
AND MP32.CAL_RUN_ID      = MP2.CAL_RUN_ID
AND MP32.EMPL_RCD        = MP2.EMPL_RCD
AND MP32.GP_PAYGROUP     = MP2.GP_PAYGROUP
AND MP32.CAL_ID          = MP2.CAL_ID
AND MP32.ORIG_CAL_RUN_ID = MP2.ORIG_CAL_RUN_ID
AND MP32.RSLT_SEG_NUM    = MP2.RSLT_SEG_NUM
AND MP32.RSLT_VER_NUM    = MP2.RSLT_VER_NUM
AND MP32.RSLT_REV_NUM    = MP2.RSLT_REV_NUM
AND MP2.GP_GENRPT_BREAK1 [$ESTABIDIN]
AND MP32.GPIN_FLD_NAME IN('F24Q_TDS','F24Q_EDUCES_MON','F24Q_SURCHR_MON')
GROUP BY MP32.GPIN_FLD_NAME,MP32.CAL_ID

END-SELECT

End-Procedure !Get-Rpt-Yrly-Fields-Other

!***********************************************************************


!***********************************************************************
! Procedure: Get-Rpt-Yrly-Fields                                       *
!                                                                      *
!                                                                      *
!***********************************************************************
Begin-procedure Get-Rpt-Yrly-Fields
         let #tds_gross_sal = 0
         let #tds_gross_sal1 = 0
         let #tds_prevemp_income = 0
         let #tds_prevemp_income1 = 0
         let #tds_curemp_income = 0
         let #tds_curemp_income1 = 0
         let #sec16ded = 0
         let #totchap6a = 0
         let #totinctax = 0
         let #tdssurcharge = 0
         let #EducationCess = 0
         let #TdsYtd1 = 0
         let #TdsYtd = 0
         let #PrevTdsYtd = 0
         let #PrevTdsYtd1 = 0
         let #sec80ccf = 0
         let #incnotsal = 0
         LET #F24_RENT_PAID = 0
Begin-Select
A.GPIN_FLD_NAME
A.CALC_RSLT_VAL
A.CAL_ID &CAL_ID

    let $evl = ltrim(rtrim(&A.GPIN_FLD_NAME,' '),' ')
    if instr(&CAL_ID,'#',1) = 0
       move &CAL_ID to $Calid_temp
    end-if

   Evaluate $evl
      when = 'F24Q_TDS_GR_SAL'
        if instr(&CAL_ID,'#',1) >0
           move &A.CALC_RSLT_VAL to #tds_gross_sal1
        else
           move &A.CALC_RSLT_VAL to #tds_gross_sal
        end-if
      break
      when = 'F24Q_TAXBLE_INC' 
         if instr(&CAL_ID,'#',1) >0
            move &A.CALC_RSLT_VAL to #tds_curemp_income1
         else
            move &A.CALC_RSLT_VAL to #tds_curemp_income
         end-if
      break

      when = 'F24Q_TOTPRE_INC'
         if instr(&CAL_ID,'#',1) >0
            move &A.CALC_RSLT_VAL to #tds_prevemp_income1
         else
            move &A.CALC_RSLT_VAL to #tds_prevemp_income
         end-if

      when = 'F24Q_SEC16_DEDN'
         move &A.CALC_RSLT_VAL to #sec16ded
      break
      when = 'F24Q_SECT_80CCE'
         move &A.CALC_RSLT_VAL to #sec80cce
         let #sec80cce_cnt = 1
      break
      when = 'F24Q_CHAPTER_6A'
         move &A.CALC_RSLT_VAL to #totchap6a
      break
      when = 'F24Q_TOT_INCTAX'
         move &A.CALC_RSLT_VAL to #totinctax
      break
      when = 'F24Q_TDS_SURCH'
         move &A.CALC_RSLT_VAL to #tdssurcharge
      break
      when = 'F24Q_TDS_EDUCES'
         move &A.CALC_RSLT_VAL to #EducationCess
         break
      when = 'F24Q_TDS_YTD'
         if instr(&CAL_ID,'#',1) >0
             move &A.CALC_RSLT_VAL to #TdsYtd1
         else
             move &A.CALC_RSLT_VAL to #TdsYtd
         end-if
         break
      when = 'F24Q_PREV_TDS'
         if instr(&CAL_ID,'#',1) >0
             move &A.CALC_RSLT_VAL to #PrevTdsYtd1
         else
             move &A.CALC_RSLT_VAL to #PrevTdsYtd
         end-if 
         break


      when = 'F24Q_SEC80CCF'
         move &A.CALC_RSLT_VAL to #sec80ccf
         let #sec80ccf_cnt = 1
         break

      when = 'F24Q_INC_NOT_SL'
         move &A.CALC_RSLT_VAL to #incnotsal
         break
      when = 'F24_RENT_PAID'
         move &A.CALC_RSLT_VAL to   #F24_RENT_PAID
         break
        when = 'F24Q_80G_50PCT'
         move  &A.CALC_RSLT_VAL to #sec80g_50
         break
      when = 'F24Q_80G_100PCT'
         move  &A.CALC_RSLT_VAL to #sec80g_100
         break
         
    when = 'F24Q_S80G_DON'
         move &A.CALC_RSLT_VAL to #sec80don
         break
         
         
             
    !new code    
      when = 'F24Q_SEC80C'
         move &A.CALC_RSLT_VAL to   #F24Q_SEC80C
         break       
      when = 'F24Q_SEC80CCC'
         move &A.CALC_RSLT_VAL to   #F24Q_SEC80CCC
         break
      when = 'F24Q_SEC80CCD1'
         move &A.CALC_RSLT_VAL to   #F24Q_SEC80CCD1
         break
      when = 'F24Q_SEC80CCD1B'
         move &A.CALC_RSLT_VAL to   #F24Q_SEC80CCD1B
         break
      when = 'F24Q_SEC80CCD2'
         move &A.CALC_RSLT_VAL to   #F24Q_SEC80CCD2
         break
      when = 'F24Q_SEC80D'
         move &A.CALC_RSLT_VAL to   #F24Q_SEC80D
         break
      when = 'F24Q_SEC80E'
         move &A.CALC_RSLT_VAL to   #F24Q_SEC80E
         break
      when = 'F24Q_SEC80TTA'
         move &A.CALC_RSLT_VAL to   #F24Q_SEC80TTA
         break
      when = 'F24Q_SEC17_1'
         move &A.CALC_RSLT_VAL to   #F24Q_SEC17_1
         break
      when = 'F24Q_SEC17_2'
         move &A.CALC_RSLT_VAL to   #F24Q_SEC17_2
         break
      when = 'F24Q_SEC17_3'
         move &A.CALC_RSLT_VAL to   #F24Q_SEC17_3
         break
      when = 'F24Q_SEC10_5'
         move &A.CALC_RSLT_VAL to   #F24Q_SEC10_5
         break
      when = 'F24Q_SEC10_10'
         move &A.CALC_RSLT_VAL to   #F24Q_SEC10_10
         break
      when = 'F24Q_SEC10_10A'
         move &A.CALC_RSLT_VAL to   #F24Q_SEC10_10A
         break       
      when = 'F24Q_SEC10_10AA'
         move &A.CALC_RSLT_VAL to   #F24Q_SEC10_10AA
         break       
      when = 'F24Q_SEC10_13A'
         move &A.CALC_RSLT_VAL to   #F24Q_SEC10_13A       
         break       
      when = 'F24Q_SEC10_OTH'
         move &A.CALC_RSLT_VAL to   #F24Q_SEC10_OTH
         break

      when = 'F24Q_SEC192_2B'
         move &A.CALC_RSLT_VAL to   #F24Q_SEC192_2B
         break

      ! New Code v6.5
      when = 'F24Q_80C_DECL'
         move &A.CALC_RSLT_VAL to   #F24Q_80C_DECL
         break
         
      when = 'F24Q_80CCC_DECL'
         move &A.CALC_RSLT_VAL to   #F24Q_80CCC_DECL
         break
      when = 'F24Q_80D_DECL'
         move &A.CALC_RSLT_VAL to   #F24Q_80D_DECL
         break
      when = 'F24Q_80TTA_DECL'
         move &A.CALC_RSLT_VAL to   #F24Q_80TTA_DECL
         break

      when = 'F24Q_80E_DECL'
         move &A.CALC_RSLT_VAL to #F24Q_80E_DECL
         break
      when = 'F24Q_SEC80CCD1B'
         move &A.CALC_RSLT_VAL to #F24Q_SEC80CCD1B
         break
      when = 'F24Q_SEC80CCD2'
         move &A.CALC_RSLT_VAL to #F24Q_SEC80CCD2
         break
      when = 'F24Q_6AOTH_QUAL'
         move &A.CALC_RSLT_VAL to #F24Q_6AOTH_QUAL
         break
      when = 'F24Q_6AOTH_GROS'
         move &A.CALC_RSLT_VAL to #F24Q_6AOTH_GROS
         break
      ! New Code v6.5
         
     
   End-Evaluate


FROM PS_GPIN_24Q_TMP3 A, PS_GPIN_24Q_TMP B, PS_GP_CAL_RUN C
WHERE  A.JOBINSTANCE = #prcs_job_instance
AND A.EMPLID = $Emp_Id
AND A.JOBINSTANCE     = B.JOBINSTANCE
AND A.EMPLID          = B.EMPLID
AND A.CAL_RUN_ID      = B.CAL_RUN_ID
AND A.EMPL_RCD        = B.EMPL_RCD
AND A.GP_PAYGROUP     = B.GP_PAYGROUP
AND A.CAL_ID          = B.CAL_ID
AND A.ORIG_CAL_RUN_ID = B.ORIG_CAL_RUN_ID
AND A.RSLT_SEG_NUM    = B.RSLT_SEG_NUM
AND A.RSLT_VER_NUM    = B.RSLT_VER_NUM
AND A.RSLT_REV_NUM    = B.RSLT_REV_NUM
and B.GP_GENRPT_BREAK1 [$ESTABIDIN]
AND C.CAL_RUN_ID      = B.CAL_RUN_ID
AND C.RUN_FINALIZED_IND= 'Y'
AND C.RUN_FINALIZED_TS = (SELECT MAX(C1.RUN_FINALIZED_TS) FROM PS_GP_CAL_RUN C1,PS_GPIN_24Q_TMP A1, PS_GPIN_24Q_TMP B1
                          WHERE C1.CAL_RUN_ID=A1.CAL_RUN_ID
                          AND A1.JOBINSTANCE = #prcs_job_instance
                          AND A1.EMPLID = $Emp_Id
                          AND A1.JOBINSTANCE     = B1.JOBINSTANCE
                          AND A1.EMPLID          = B1.EMPLID
                          AND A1.CAL_RUN_ID      = B1.CAL_RUN_ID
                          AND A1.EMPL_RCD        = B1.EMPL_RCD
                          AND A1.GP_PAYGROUP     = B1.GP_PAYGROUP
                          AND A1.CAL_ID          = B1.CAL_ID
                          AND A1.ORIG_CAL_RUN_ID = B1.ORIG_CAL_RUN_ID
                          AND A1.RSLT_SEG_NUM    = B1.RSLT_SEG_NUM
                          AND A1.RSLT_VER_NUM    = B1.RSLT_VER_NUM
                          AND A1.RSLT_REV_NUM    = B1.RSLT_REV_NUM
                          and B1.GP_GENRPT_BREAK1 [$ESTABIDIN]
                          AND C1.CAL_RUN_ID      = B1.CAL_RUN_ID
                          AND C1.RUN_FINALIZED_IND= 'Y')
End-Select

if #totinctax = 0
   Do Get-Rpt-Yrly-Fields-Other
   let #totinctax = #totinctax - #tdssurcharge - #EducationCess
end-if

if #TdsYtd1 > 0
   let #TdsYtd = #TdsYtd1
end-if

if #PrevTdsYtd1 > 0
   let #PrevTdsYtd = #PrevTdsYtd1
end-if


if #tds_prevemp_income1 > 0
   let #tds_prevemp_income = #tds_prevemp_income1
end-if

if #tds_curemp_income1 > 0
   let #tds_curemp_income = #tds_curemp_income1
end-if

if #tds_gross_sal1 >0
   let #tds_gross_sal = #tds_gross_sal1
end-if

End-Procedure !Get-Rpt-Yrly-Fields

!***********************************************************************
! Procedure: Write-Annexure2-Data                                      *
!                                                                      *
!                                                                      *
!***********************************************************************
!begin-procedure Write-Annexure2-Data( $Parm1, $Parm2, $Parm3, $Parm4,
!                                      $Parm5, $Parm6, $Parm6A,$Parm6B,$Parm7, $Parm7A, $Parm8,
!                                      $Parm9, $Parm10,$Parm11,$Parm12,
!                                      $Parm13,$Parm14,$Parm15,$Parm16,$Parm17,$Parm18,
!                                     $Parm19,$Parm20,$Parm20A,$Parm20B,$Parm21,$Parm22,$Parm23)

!begin-procedure Write-Annexure2-Data( $Parm1, $Parm2, $Parm3, $Parm4,
!                                      $Parm5, $Parm6, $Parm7, $Parm8,
!                                      $Parm9, $Parm10,$Parm11,$Parm14,
!                                     $Parm15,$Parm16,$Parm17,$Parm18,$Parm19,$Parm20,
!                                     $Parm21,$Parm22,$Parm31,$Parm6A,$Parm6B,$Parm20A,$Parm20B)
! New Code V6.5                                      
!begin-procedure Write-Annexure2-Data( $Parm1, $Parm2, $Parm3, $Parm4,
!                                      $Parm5, $Parm6, $Parm6A, $Parm6B,$Parm7, $Parm8A , $Parm8B, $Parm8C, $Parm8,
!                                      $Parm9, $Parm10,$Parm11,$Parm12, $Parm13, $Parm14,
!                                      $Parm15,$Parm16,$Parm17,$Parm18, $Parm19, $Parm20A,
!                                      $Parm20B,$Parm20, $Parm21,$Parm22,$Parm23,
!                                      $Parm32,$Parm33, $Parm34,$Parm35,$Parm36,
!                                      $Parm37,$Parm38,$Parm39,$Parm40, $Parm41, $Parm42,
!                                      $Parm43,$Parm44,$Parm45,$Parm46, $Parm47, $Parm48,
!                                      $Parm49,$Parm50)
!version 6.5+ starts
!begin-procedure Write-Annexure2-Data( $Parm1, $Parm2, $Parm3, $Parm4,
 !                                       $Parm5, $Parm6, $Parm6A, $Parm6B,$Parm7, $Parm8A , $Parm8B, $Parm8C, $Parm8,
  !                                      $Parm9, $Parm10,$Parm11,$Parm12, $Parm13, $Parm14,
   !                                     $Parm15,$Parm16,$Parm17,$Parm18, $Parm19, $Parm20A,
    !                                    $Parm20B,$Parm20, $Parm21,$Parm22,$Parm23,
     !                                   $Parm32,$Parm33, $Parm34,$Parm35,$Parm36,
      !                                  $Parm37,$Parm38,$Parm39,$Parm40, $Parm41, $Parm42, 
  !                                 $Parm43_Gross, $Parm43, $Parm44_Gross, $Parm44, $Parm45_Gross, $Parm45, $Parm46_Gross, $Parm46, 
  !                                      $Parm47_Gross, $Parm47, $Parm48_Gross, $Parm48, $Parm49_Gross, $Parm49, 
  !                                      $Parm80G_Gross, $Parm80G_Qual, $Parm80G_Deduct, $Parm_Rbt_sec_87A,
  !                                      $Parm50 , $Parm51 , $Parm52 , $Parm53 , $Parm13_Gross
   !                                 )
                                    
begin-procedure Write-Annexure2-Data( $Parm1, $Parm2, $Parm3, $Parm4,
$Parm5, $Parm6, $Parm6A, $Parm6B,$Parm7, $Parm8A , $Parm8B, $Parm8C, $Parm8,$Parm9, $Parm10,$Parm11,$Parm12, $Parm13, $Parm14,$Parm15,$Parm16,$Parm17,$Parm18, $Parm19, $Parm20A,
$Parm20B,$Parm20, $Parm21,$Parm22,$Parm23,$Parm32,$Parm33, $Parm34,$Parm35,$Parm36,$Parm37,$Parm38,$Parm39,$Parm40, $Parm41, $Parm42, 
$Parm43_Gross, $Parm43, $Parm44_Gross, $Parm44, $Parm45_Gross, $Parm45, $Parm46_Gross,$Parm46, 
$Parm47_Gross, $Parm47, $Parm48_Gross, $Parm48, $Parm49_Gross, $Parm49, 
$Parm80G_Gross, $Parm80G_Qual, $Parm80G_Deduct, $Parm_Rbt_sec_87A ,
$Parm50, $Parm51, $Parm52, $Parm53, $Parm13_Gross, $Parm54 , $Parm55 , $Parm56, $Parm57 ,
$Parm58 , $Parm59 , $Parm60, $Parm61 , $Parm62 , $Parm63 , $Parm64 , $Parm65 , $Parm66 , $Parm67,
$Parm68 , $Parm69 , $Parm70 , $Parm71 , $Parm72, $Parm73,  $Parm74 , $Parm75 , $Parm76, $Parm77 ,
$Parm78 , $Parm79 )
!version 6.5+ ends

   let $REPORT_TE = ltrim(rtrim($Parm1,' '),' ')
   let $REPORT_TE = ltrim(rtrim($REPORT_TE,' '),' ') || ','
   let $REPORT_TE = ltrim(rtrim($REPORT_TE,' '),' ') || $Parm2
   let $REPORT_TE = ltrim(rtrim($REPORT_TE,' '),' ') || ','
   let $REPORT_TE = ltrim(rtrim($REPORT_TE,' '),' ') || $Parm3
   let $REPORT_TE = ltrim(rtrim($REPORT_TE,' '),' ') || ','
   let $REPORT_TE = ltrim(rtrim($REPORT_TE,' '),' ') || $Parm4
   let $REPORT_TE = ltrim(rtrim($REPORT_TE,' '),' ') || ','
   let $REPORT_TE = ltrim(rtrim($REPORT_TE,' '),' ') || $Parm5
   let $REPORT_TE = ltrim(rtrim($REPORT_TE,' '),' ') || ','
   let $REPORT_TE = ltrim(rtrim($REPORT_TE,' '),' ') || $Parm6
   let $REPORT_TE = ltrim(rtrim($REPORT_TE,' '),' ') || ','
   let $REPORT_TE = ltrim(rtrim($REPORT_TE,' '),' ') || $Parm6A
   let $REPORT_TE = ltrim(rtrim($REPORT_TE,' '),' ') || ','
   let $REPORT_TE = ltrim(rtrim($REPORT_TE,' '),' ') || $Parm6B
   let $REPORT_TE = ltrim(rtrim($REPORT_TE,' '),' ') || ','
   let $REPORT_TE = ltrim(rtrim($REPORT_TE,' '),' ') || $Parm7
   let $REPORT_TE = ltrim(rtrim($REPORT_TE,' '),' ') || ','   
   let $REPORT_TE = ltrim(rtrim($REPORT_TE,' '),' ') || $Parm8A
   let $REPORT_TE = ltrim(rtrim($REPORT_TE,' '),' ') || ','
   let $REPORT_TE = ltrim(rtrim($REPORT_TE,' '),' ') || $Parm8B
   let $REPORT_TE = ltrim(rtrim($REPORT_TE,' '),' ') || ','
   let $REPORT_TE = ltrim(rtrim($REPORT_TE,' '),' ') || $Parm8C
   let $REPORT_TE = ltrim(rtrim($REPORT_TE,' '),' ') || ','
   let $REPORT_TE = ltrim(rtrim($REPORT_TE,' '),' ') || $Parm9
   let $REPORT_TE = ltrim(rtrim($REPORT_TE,' '),' ') || ','
   let $REPORT_TE = ltrim(rtrim($REPORT_TE,' '),' ') || $Parm10
   let $REPORT_TE = ltrim(rtrim($REPORT_TE,' '),' ') || ','
   let $REPORT_TE = ltrim(rtrim($REPORT_TE,' '),' ') || $Parm11
   let $REPORT_TE = ltrim(rtrim($REPORT_TE,' '),' ') || ','
   let $REPORT_TE = ltrim(rtrim($REPORT_TE,' '),' ') || $Parm12
   !let $REPORT_TE = ltrim(rtrim($REPORT_TE,' '),' ') || ','             !New Code v6.5
   !let $REPORT_TE = ltrim(rtrim($REPORT_TE,' '),' ') || $Parm13         !New Code v6.5
   let $REPORT_TE = ltrim(rtrim($REPORT_TE,' '),' ') || ','
   let $REPORT_TE = ltrim(rtrim($REPORT_TE,' '),' ') || $Parm14
   let $REPORT_TE = ltrim(rtrim($REPORT_TE,' '),' ') || ','
   let $REPORT_TE = ltrim(rtrim($REPORT_TE,' '),' ') || $Parm15
   let $REPORT_TE = ltrim(rtrim($REPORT_TE,' '),' ') || ','
   let $REPORT_TE = ltrim(rtrim($REPORT_TE,' '),' ') || $Parm16
   let $REPORT_TE = ltrim(rtrim($REPORT_TE,' '),' ') || ','
   let $REPORT_TE = ltrim(rtrim($REPORT_TE,' '),' ') || $Parm17
   let $REPORT_TE = ltrim(rtrim($REPORT_TE,' '),' ') || ','
   let $REPORT_TE = ltrim(rtrim($REPORT_TE,' '),' ') || $Parm18
   let $REPORT_TE = ltrim(rtrim($REPORT_TE,' '),' ') || ','
   let $REPORT_TE = ltrim(rtrim($REPORT_TE,' '),' ') || $Parm19
   let $REPORT_TE = ltrim(rtrim($REPORT_TE,' '),' ') || ','
   let $REPORT_TE = ltrim(rtrim($REPORT_TE,' '),' ') || $Parm20
   let $REPORT_TE = ltrim(rtrim($REPORT_TE,' '),' ') || ','
   let $REPORT_TE = ltrim(rtrim($REPORT_TE,' '),' ') || $Parm20A
   let $REPORT_TE = ltrim(rtrim($REPORT_TE,' '),' ') || ','
   let $REPORT_TE = ltrim(rtrim($REPORT_TE,' '),' ') || $Parm20B
   let $REPORT_TE = ltrim(rtrim($REPORT_TE,' '),' ') || ','
   let $REPORT_TE = ltrim(rtrim($REPORT_TE,' '),' ') || $Parm21
   let $REPORT_TE = ltrim(rtrim($REPORT_TE,' '),' ') || ','
   let $REPORT_TE = ltrim(rtrim($REPORT_TE,' '),' ') || $Parm22
   let $REPORT_TE = ltrim(rtrim($REPORT_TE,' '),' ') || ','
   let $REPORT_TE = ltrim(rtrim($REPORT_TE,' '),' ') || $Parm23
   let $REPORT_TE = ltrim(rtrim($REPORT_TE,' '),' ') || ','
   
   !version v6.4 ends

   !new code v6.5+ starts
   
   let $REPORT_TE = ltrim(rtrim($REPORT_TE,' '),' ') || $Parm54
   let $REPORT_TE = ltrim(rtrim($REPORT_TE,' '),' ') || ','
   
   let $REPORT_TE = ltrim(rtrim($REPORT_TE,' '),' ') || $Parm55
   let $REPORT_TE = ltrim(rtrim($REPORT_TE,' '),' ') || ','
   
   let $REPORT_TE = ltrim(rtrim($REPORT_TE,' '),' ') || $Parm56
   let $REPORT_TE = ltrim(rtrim($REPORT_TE,' '),' ') || ','
   
   let $REPORT_TE = ltrim(rtrim($REPORT_TE,' '),' ') || $Parm57
   let $REPORT_TE = ltrim(rtrim($REPORT_TE,' '),' ') || ','
   
   let $REPORT_TE = ltrim(rtrim($REPORT_TE,' '),' ') || $Parm58
   let $REPORT_TE = ltrim(rtrim($REPORT_TE,' '),' ') || ','

   let $REPORT_TE = ltrim(rtrim($REPORT_TE,' '),' ') || $Parm59
   let $REPORT_TE = ltrim(rtrim($REPORT_TE,' '),' ') || ','
   
   let $REPORT_TE = ltrim(rtrim($REPORT_TE,' '),' ') || $Parm60
   let $REPORT_TE = ltrim(rtrim($REPORT_TE,' '),' ') || ','
   
   let $REPORT_TE = ltrim(rtrim($REPORT_TE,' '),' ') || $Parm61
   let $REPORT_TE = ltrim(rtrim($REPORT_TE,' '),' ') || ','
   
   let $REPORT_TE = ltrim(rtrim($REPORT_TE,' '),' ') || $Parm62
   let $REPORT_TE = ltrim(rtrim($REPORT_TE,' '),' ') || ','
   
   let $REPORT_TE = ltrim(rtrim($REPORT_TE,' '),' ') || $Parm63
   let $REPORT_TE = ltrim(rtrim($REPORT_TE,' '),' ') || ','
   
   let $REPORT_TE = ltrim(rtrim($REPORT_TE,' '),' ') || $Parm64
   let $REPORT_TE = ltrim(rtrim($REPORT_TE,' '),' ') || ','
   
   let $REPORT_TE = ltrim(rtrim($REPORT_TE,' '),' ') || $Parm65
   let $REPORT_TE = ltrim(rtrim($REPORT_TE,' '),' ') || ','
   
   let $REPORT_TE = ltrim(rtrim($REPORT_TE,' '),' ') || $Parm66
   let $REPORT_TE = ltrim(rtrim($REPORT_TE,' '),' ') || ','
   
   let $REPORT_TE = ltrim(rtrim($REPORT_TE,' '),' ') || $Parm67
   let $REPORT_TE = ltrim(rtrim($REPORT_TE,' '),' ') || ','
   
   let $REPORT_TE = ltrim(rtrim($REPORT_TE,' '),' ') || $Parm68
   let $REPORT_TE = ltrim(rtrim($REPORT_TE,' '),' ') || ','
   
   let $REPORT_TE = ltrim(rtrim($REPORT_TE,' '),' ') || $Parm69
   let $REPORT_TE = ltrim(rtrim($REPORT_TE,' '),' ') || ','
   
   let $REPORT_TE = ltrim(rtrim($REPORT_TE,' '),' ') || $Parm70
   let $REPORT_TE = ltrim(rtrim($REPORT_TE,' '),' ') || ','
   
   let $REPORT_TE = ltrim(rtrim($REPORT_TE,' '),' ') || $Parm71
   let $REPORT_TE = ltrim(rtrim($REPORT_TE,' '),' ') || ','
   
   let $REPORT_TE = ltrim(rtrim($REPORT_TE,' '),' ') || $Parm72
   let $REPORT_TE = ltrim(rtrim($REPORT_TE,' '),' ') || ','
   
   let $REPORT_TE = ltrim(rtrim($REPORT_TE,' '),' ') || $Parm73
   let $REPORT_TE = ltrim(rtrim($REPORT_TE,' '),' ') || ','
   
   let $REPORT_TE = ltrim(rtrim($REPORT_TE,' '),' ') || $Parm74
   let $REPORT_TE = ltrim(rtrim($REPORT_TE,' '),' ') || ','
   
   let $REPORT_TE = ltrim(rtrim($REPORT_TE,' '),' ') || $Parm75
   let $REPORT_TE = ltrim(rtrim($REPORT_TE,' '),' ') || ','
   
   let $REPORT_TE = ltrim(rtrim($REPORT_TE,' '),' ') || $Parm76
   let $REPORT_TE = ltrim(rtrim($REPORT_TE,' '),' ') || ','
   
   let $REPORT_TE = ltrim(rtrim($REPORT_TE,' '),' ') || $Parm77
   let $REPORT_TE = ltrim(rtrim($REPORT_TE,' '),' ') || ','
   
   let $REPORT_TE = ltrim(rtrim($REPORT_TE,' '),' ') || $Parm78
   let $REPORT_TE = ltrim(rtrim($REPORT_TE,' '),' ') || ','
   
   let $REPORT_TE = ltrim(rtrim($REPORT_TE,' '),' ') || $Parm79
   let $REPORT_TE = ltrim(rtrim($REPORT_TE,' '),' ') || ','

   !new code v6.5+ ends

   !version 6.4 starts

   let $REPORT_TE = ltrim(rtrim($REPORT_TE,' '),' ') || $Parm32
   let $REPORT_TE = ltrim(rtrim($REPORT_TE,' '),' ') || ','
   let $REPORT_TE = ltrim(rtrim($REPORT_TE,' '),' ') || $Parm33
   let $REPORT_TE = ltrim(rtrim($REPORT_TE,' '),' ') || ','
   let $REPORT_TE = ltrim(rtrim($REPORT_TE,' '),' ') || $Parm34
   let $REPORT_TE = ltrim(rtrim($REPORT_TE,' '),' ') || ','
   let $REPORT_TE = ltrim(rtrim($REPORT_TE,' '),' ') || $Parm35
   let $REPORT_TE = ltrim(rtrim($REPORT_TE,' '),' ') || ','
   let $REPORT_TE = ltrim(rtrim($REPORT_TE,' '),' ') || $Parm36
   let $REPORT_TE = ltrim(rtrim($REPORT_TE,' '),' ') || ','
   let $REPORT_TE = ltrim(rtrim($REPORT_TE,' '),' ') || $Parm37
   let $REPORT_TE = ltrim(rtrim($REPORT_TE,' '),' ') || ','
   let $REPORT_TE = ltrim(rtrim($REPORT_TE,' '),' ') || $Parm38
   let $REPORT_TE = ltrim(rtrim($REPORT_TE,' '),' ') || ','
   let $REPORT_TE = ltrim(rtrim($REPORT_TE,' '),' ') || $Parm39
   let $REPORT_TE = ltrim(rtrim($REPORT_TE,' '),' ') || ','
   let $REPORT_TE = ltrim(rtrim($REPORT_TE,' '),' ') || $Parm40
   let $REPORT_TE = ltrim(rtrim($REPORT_TE,' '),' ') || ','
   let $REPORT_TE = ltrim(rtrim($REPORT_TE,' '),' ') || $Parm41
   let $REPORT_TE = ltrim(rtrim($REPORT_TE,' '),' ') || ','
   let $REPORT_TE = ltrim(rtrim($REPORT_TE,' '),' ') || $Parm42
   let $REPORT_TE = ltrim(rtrim($REPORT_TE,' '),' ') || ','  

   ! New Code V6.5
   let $REPORT_TE = ltrim(rtrim($REPORT_TE,' '),' ') || $Parm43_Gross  ! Sec80c Gross
   let $REPORT_TE = ltrim(rtrim($REPORT_TE,' '),' ') || ','
   ! New Code V6.5  

   let $REPORT_TE = ltrim(rtrim($REPORT_TE,' '),' ') || $Parm43
   let $REPORT_TE = ltrim(rtrim($REPORT_TE,' '),' ') || ','

   ! New Code V6.5  
   let $REPORT_TE = ltrim(rtrim($REPORT_TE,' '),' ') || $Parm44_Gross   ! Sec80ccc Gross
   let $REPORT_TE = ltrim(rtrim($REPORT_TE,' '),' ') || ','
   ! New Code V6.5

   let $REPORT_TE = ltrim(rtrim($REPORT_TE,' '),' ') || $Parm44
   let $REPORT_TE = ltrim(rtrim($REPORT_TE,' '),' ') || ','

   ! New Code V6.5
   let $REPORT_TE = ltrim(rtrim($REPORT_TE,' '),' ') || $Parm45_Gross   ! Section 80ccd1
   let $REPORT_TE = ltrim(rtrim($REPORT_TE,' '),' ') || ','
   ! New Code V6.5

   let $REPORT_TE = ltrim(rtrim($REPORT_TE,' '),' ') || $Parm45
   let $REPORT_TE = ltrim(rtrim($REPORT_TE,' '),' ') || ','

   ! New Code V6.5
   let $REPORT_TE = ltrim(rtrim($REPORT_TE,' '),' ') || $Parm46_Gross  ! Section 80ccd1b
   let $REPORT_TE = ltrim(rtrim($REPORT_TE,' '),' ') || ','
   ! New Code V6.5

   let $REPORT_TE = ltrim(rtrim($REPORT_TE,' '),' ') || $Parm46
   let $REPORT_TE = ltrim(rtrim($REPORT_TE,' '),' ') || ','  

   ! New Code V6.5
   let $REPORT_TE = ltrim(rtrim($REPORT_TE,' '),' ') || $Parm47_Gross  ! Section 80ccd2
   let $REPORT_TE = ltrim(rtrim($REPORT_TE,' '),' ') || ','
   ! New Code V6.5

   let $REPORT_TE = ltrim(rtrim($REPORT_TE,' '),' ') || $Parm47
   let $REPORT_TE = ltrim(rtrim($REPORT_TE,' '),' ') || ','

   ! New Code V6.5
   let $REPORT_TE = ltrim(rtrim($REPORT_TE,' '),' ') || $Parm48_Gross   ! Section 80D
   let $REPORT_TE = ltrim(rtrim($REPORT_TE,' '),' ') || ','
   ! New Code V6.5

   let $REPORT_TE = ltrim(rtrim($REPORT_TE,' '),' ') || $Parm48
   let $REPORT_TE = ltrim(rtrim($REPORT_TE,' '),' ') || ','

   ! New Code V6.5
   let $REPORT_TE = ltrim(rtrim($REPORT_TE,' '),' ') || $Parm53        ! Section E
   let $REPORT_TE = ltrim(rtrim($REPORT_TE,' '),' ') || ','
   ! New Code V6.5

   let $REPORT_TE = ltrim(rtrim($REPORT_TE,' '),' ') || $Parm53
   let $REPORT_TE = ltrim(rtrim($REPORT_TE,' '),' ') || ','

   ! New Code V6.5
   let $REPORT_TE = ltrim(rtrim($REPORT_TE,' '),' ') || $Parm80G_Gross   ! Section G
   let $REPORT_TE = ltrim(rtrim($REPORT_TE,' '),' ') || ','

   let $REPORT_TE = ltrim(rtrim($REPORT_TE,' '),' ') || $Parm80G_Qual
   let $REPORT_TE = ltrim(rtrim($REPORT_TE,' '),' ') || ','

   let $REPORT_TE = ltrim(rtrim($REPORT_TE,' '),' ') || $Parm80G_Deduct
   let $REPORT_TE = ltrim(rtrim($REPORT_TE,' '),' ') || ','

   let $REPORT_TE = ltrim(rtrim($REPORT_TE,' '),' ') || $Parm50
   let $REPORT_TE = ltrim(rtrim($REPORT_TE,' '),' ') || ','

   let $REPORT_TE = ltrim(rtrim($REPORT_TE,' '),' ') || $Parm52
   let $REPORT_TE = ltrim(rtrim($REPORT_TE,' '),' ') || ','


   let $REPORT_TE = ltrim(rtrim($REPORT_TE,' '),' ') || $Parm50
   let $REPORT_TE = ltrim(rtrim($REPORT_TE,' '),' ') || ','

   let $REPORT_TE = ltrim(rtrim($REPORT_TE,' '),' ') || $Parm_Rbt_sec_87A
   let $REPORT_TE = ltrim(rtrim($REPORT_TE,' '),' ') || ','

   ! New Code V6.5
   let $REPORT_TE = ltrim(rtrim($REPORT_TE,' '),' ') || $Parm13_Gross
   let $REPORT_TE = ltrim(rtrim($REPORT_TE,' '),' ') || ','
   ! New Code V6.5

   let $REPORT_TE = ltrim(rtrim($REPORT_TE,' '),' ') || $Parm13
   let $REPORT_TE = ltrim(rtrim($REPORT_TE,' '),' ') || ','


   
   
    write 2 from $REPORT_TE

end-procedure



!***********************************************************************
! Procedure:Write-Annexure2-Footer                                     *
!                                                                      *
!                                                                      *
!***********************************************************************

begin-procedure Write-Annexure2-Footer

   write 2 from ' '
   write 2 from ' '

   let $REPORT_TITLE = $REPORT_TEXT30
   let $REPORT_TITLE = ltrim(rtrim($REPORT_TITLE,' '),' ') || ','
   let $REPORT_TITLE = ltrim(rtrim($REPORT_TITLE,' '),' ') || ltrim(rtrim($place,' '),' ')
   let $REPORT_TITLE = ltrim(rtrim($REPORT_TITLE,' '),' ') || ','
   let $REPORT_TITLE = ltrim(rtrim($REPORT_TITLE,' '),' ') || ','
   let $REPORT_TITLE = ltrim(rtrim($REPORT_TITLE,' '),' ') || ','
   let $REPORT_TITLE = ltrim(rtrim($REPORT_TITLE,' '),' ') || ','
   let $REPORT_TITLE = ltrim(rtrim($REPORT_TITLE,' '),' ') || ','
   let $REPORT_TITLE = ltrim(rtrim($REPORT_TITLE,' '),' ') || ','
   let $REPORT_TITLE = ltrim(rtrim($REPORT_TITLE,' '),' ') || ','
   let $REPORT_TITLE = ltrim(rtrim($REPORT_TITLE,' '),' ') || ','
   let $REPORT_TITLE = ltrim(rtrim($REPORT_TITLE,' '),' ') || $REPORT_TEXT31
   write 2 from $REPORT_TITLE

   let $REPORT_TITLE = $REPORT_TEXT32
   let $REPORT_TITLE = ltrim(rtrim($REPORT_TITLE,' '),' ') || ','
   let $REPORT_TITLE = ltrim(rtrim($REPORT_TITLE,' '),' ') || ltrim(rtrim(&RNCT.CREATION_DT,' '),' ')
   let $REPORT_TITLE = ltrim(rtrim($REPORT_TITLE,' '),' ') || ','
   let $REPORT_TITLE = ltrim(rtrim($REPORT_TITLE,' '),' ') || ','
   let $REPORT_TITLE = ltrim(rtrim($REPORT_TITLE,' '),' ') || ','
   let $REPORT_TITLE = ltrim(rtrim($REPORT_TITLE,' '),' ') || ','
   let $REPORT_TITLE = ltrim(rtrim($REPORT_TITLE,' '),' ') || ','
   let $REPORT_TITLE = ltrim(rtrim($REPORT_TITLE,' '),' ') || ','
   let $REPORT_TITLE = ltrim(rtrim($REPORT_TITLE,' '),' ') || ','
   let $REPORT_TITLE = ltrim(rtrim($REPORT_TITLE,' '),' ') || ','
   let $REPORT_TITLE = ltrim(rtrim($REPORT_TITLE,' '),' ') || $REPORT_TEXT33
   let $REPORT_TITLE = ltrim(rtrim($REPORT_TITLE,' '),' ') || ','
   let $REPORT_TITLE = ltrim(rtrim($REPORT_TITLE,' '),' ') || ltrim(rtrim(replace($Name_resp_prsn,',',' '),' '),' ')
   write 2 from $REPORT_TITLE

end-procedure



!************************************************************************************
!                                                                                   *
!  Procedure:   Write-Efile-Header                                                  *
!  Description: Writing the Efile Header Record                                     *
!************************************************************************************

begin-procedure Write-Efile-Header

    move #LineNum to $LineNum 999999999
    let $REPORT_TITLE = ltrim(rtrim($LineNum,' '),' ')||'^'
    let $REPORT_TITLE = $REPORT_TITLE || ltrim(rtrim($Rec_Type,' '),' ')||'^'
    let $REPORT_TITLE = $REPORT_TITLE || ltrim(rtrim($File_Type,' '),' ')||'^'
    let $REPORT_TITLE = $REPORT_TITLE || ltrim(rtrim($Upload_Type,' '),' ')||'^'
    let $REPORT_TITLE = $REPORT_TITLE || ltrim(rtrim($File_Create_Date,' '),' ')||'^'
    let $REPORT_TITLE = $REPORT_TITLE || ltrim(rtrim($File_Seq_Num,' '),' ')||'^'
    let $REPORT_TITLE = $REPORT_TITLE || ltrim(rtrim($Uploader_Type,' '),' ')||'^'
    let $REPORT_TITLE = $REPORT_TITLE || ltrim(rtrim($Tan_ded,' '),' ')||'^'
    let $REPORT_TITLE = $REPORT_TITLE || ltrim(rtrim($Tot_Num_Batch,' '),' ')||'^'
    let $REPORT_TITLE = $REPORT_TITLE || ltrim(rtrim($Rputility,' '),' ')||'^'

    let $REPORT_TITLE = $REPORT_TITLE || ltrim(rtrim($Record_Hash,' '),' ')||'^'
    let $REPORT_TITLE = $REPORT_TITLE || ltrim(rtrim($FVU_Version,' '),' ')||'^'
    let $REPORT_TITLE = $REPORT_TITLE || ltrim(rtrim($File_Hash,' '),' ')||'^'
    let $REPORT_TITLE = $REPORT_TITLE || ltrim(rtrim($Sam_Version,' '),' ')||'^'
    let $REPORT_TITLE = $REPORT_TITLE || ltrim(rtrim($SAM_Hash,' '),' ')||'^'
    let $REPORT_TITLE = $REPORT_TITLE || ltrim(rtrim($SCM_Version,' '),' ')||'^'
    let $REPORT_TITLE = $REPORT_TITLE || ltrim(rtrim($SCM_Hash,' '),' ')||'^'
    let $REPORT_TITLE = $REPORT_TITLE || ltrim(rtrim($Confile_Hash,' '),' ')
    write 4 from $REPORT_TITLE ! Print File Header

end-procedure


!*************************************************************************************
!                                                                                    *
!    Procedure:   Write-Batch-Header                                                 *
!    Description: Writing the Batch Header                                           *
!*************************************************************************************

begin-procedure Write-Batch-Header

   LET $TanRegNo = ''
   LET $DStd_Code_Alt =''
   LET $DTel_No_Alt = ''
   LET $DEmail_Alt = ''
   LET $PStd_Code_Alt =''
   LET $PTel_No_Alt = ''
   LET $PEmail_Alt = ''
   LET $Ac_Off_ID = ''

   add 1 to #LineNum
   move #LineNum to $LineNum 000000000
   let $LineNum = Ltrim($LineNum,'0')
   let $Tan_Ded = ''

   do Find-Change-In-Address
   !do Get-Emp-Type
   do get-tan-num
   do Get-Challan_Values
   Let $WriteBatchHrd = '1'
   do Get-Estab-Info
   Let $WriteBatchHrd = '0'

   if $stmt_filed_yn = 'Yes'
      move &RNCT.GPIN_VCHR_NBR to $Prov_Receipt_No
      let $Prov_Receipt_No = edit(ltrim(rtrim($Prov_Receipt_No,' '),' '),'00000000000000')
   else
      let $Prov_Receipt_No = '00000000000000'
   end-if

   let $fin_year     = substr($financial_year,0,4)
   let $fin_year     = $fin_year || ltrim(rtrim(substr($financial_year,10,2),' '),' ')
   let $Assmt_Year   = substr($assessment_year,0,4)
   let $Assmt_Year   = $Assmt_Year || ltrim(rtrim(substr($assessment_year,10,2),' '),' ')
   let $Name_Emp     = edit($NAMEESTAB,'XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX')
   let $Flat1        = edit($flat_no,'XXXXXXXXXXXXXXXXXXXXXXXXX')
   let $Bulding1     = edit($name_of_building,'XXXXXXXXXXXXXXXXXXXXXXXXX')
   let $Road_Street  = edit($road,'XXXXXXXXXXXXXXXXXXXXXXXXX')
   let $Locality     = edit($area,'XXXXXXXXXXXXXXXXXXXXXXXXX')
   let $Town_city    = edit($town,'XXXXXXXXXXXXXXXXXXXXXXXXX')

   do Get-State-Code($state_emp,$StateP)

   let $StateA = edit($StateP,'00')

   let $Pin    = edit($pin_code,'999999')

   let $NPR    = edit($NPR,'XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX')
   let $Desgn  = edit($Designation,'XXXXXXXXXXXXXXXXXXXX')
   let $Addy1  = edit($Flat_no1,'XXXXXXXXXXXXXXXXXXXXXXXXX')
   let $Addy2  = edit($Name_of_building1,'XXXXXXXXXXXXXXXXXXXXXXXXX')
   let $Addy3  = edit($Road1,'XXXXXXXXXXXXXXXXXXXXXXXXX')
   let $Addy4  = edit($Area1,'XXXXXXXXXXXXXXXXXXXXXXXXX')
   let $Addy5  = edit($Town1,'XXXXXXXXXXXXXXXXXXXXXXXXX')

   do Get-State-Code($State1,$StateP)
   let $StateB       = edit($StateP,'00')

   let $Filler2        = ''
   let $Ack_TAN_Appln  = '00000000000000'

   let $Challan_Cnt   = edit(#Challan_Cnt,'999999999')

   if $Quarter <> 'Q4'
     let #DeducteeCountTmp = 0
     let #BatchGrsTotIncTmp = 0
   else
     let #DeducteeCountTmp = #DeducteeCount
     let #BatchGrsTotIncTmp = #BatchGrsTotInc
   end-if

   let $DeducteeCount = edit(#DeducteeCountTmp,'999999999')
   let $Perq_Cnt      = edit(#Perq_Cnt,'999999999')

   let $Gross_Tot_Challan = edit(#Gross_Tot_Challan,'999999999990.00')
   let $BatchGrsTotInc  = edit(#BatchGrsTotIncTmp,'999999999990.00')

    let $Pan_Ded  = ltrim(rtrim($Pan_Ded,' '),' ')
   if $Pan_Ded = '' or $Pan_Ded = ' '

     let $Pan_Ded = 'PANNOTREQD'

   end-if

   let $Type_Emp = $type_of_ded

   if ltrim(rtrim($Prev_Token_No,' '),' ')='0'
      let $Prev_Token_No = ''
   end-if

   let $Previous_RRR_Number = $Prev_Token_No
   let $AO_Approval_Number = $Prev_F24Q-Exists


   let $REPORT_TITLE = ltrim(rtrim($LineNum,' '),' ')||'^'
   let $REPORT_TITLE = $REPORT_TITLE || ltrim(rtrim($Rec_Type2,' '),' ')||'^'
   let $REPORT_TITLE = $REPORT_TITLE || ltrim(rtrim($Batch_Num,' '),' ')||'^'
   let $REPORT_TITLE = $REPORT_TITLE || ltrim(rtrim($Challan_Cnt,' '),' ')||'^'
   let $REPORT_TITLE = $REPORT_TITLE || ltrim(rtrim($Form_Number,' '),' ')||'^'
   let $REPORT_TITLE = $REPORT_TITLE || ltrim(rtrim($Transaction_Type,' '),' ')||'^'
   let $REPORT_TITLE = $REPORT_TITLE || ltrim(rtrim($Batch_Updation_Indicator,' '),' ')||'^'
   let $REPORT_TITLE = $REPORT_TITLE || ltrim(rtrim($Original_RRR_No,' '),' ')||'^'
   let $REPORT_TITLE = $REPORT_TITLE || ltrim(rtrim($Previous_RRR_Number,' '),' ')||'^'
   let $REPORT_TITLE = $REPORT_TITLE || ltrim(rtrim($RRR_Number,' '),' ')||'^'
   let $REPORT_TITLE = $REPORT_TITLE || ltrim(rtrim($RRR_Date,' '),' ')||'^'
   let $REPORT_TITLE = $REPORT_TITLE || ltrim(rtrim($Last_TAN_Of_Employer,' '),' ')||'^'
   let $REPORT_TITLE = $REPORT_TITLE || ltrim(rtrim($Tan_Ded,' '),' ')||'^'
   let $REPORT_TITLE = $REPORT_TITLE || ltrim($Filler1,' ')||'^'
   let $REPORT_TITLE = $REPORT_TITLE || ltrim(rtrim($Pan_Ded,' '),' ')||'^'
   let $REPORT_TITLE = $REPORT_TITLE || ltrim(rtrim($Assmt_Year,' '),' ')||'^'
   let $REPORT_TITLE = $REPORT_TITLE || ltrim(rtrim($Fin_Year,' '),' ')||'^'
   let $REPORT_TITLE = $REPORT_TITLE || ltrim(rtrim($Quarter,' '),' ')||'^'
   let $REPORT_TITLE = $REPORT_TITLE || ltrim(rtrim($Name_Emp,' '),' ')||'^'
   let $REPORT_TITLE = $REPORT_TITLE || ltrim(rtrim($Name_Emp,' '),' ')||'^'
   let $REPORT_TITLE = $REPORT_TITLE || ltrim(rtrim($flat1,' '),' ')||'^'
   let $REPORT_TITLE = $REPORT_TITLE || ltrim(rtrim($Bulding1,' '),' ')||'^'
   let $REPORT_TITLE = $REPORT_TITLE || ltrim(rtrim($Road_Street,' '),' ')||'^'
   let $REPORT_TITLE = $REPORT_TITLE || ltrim(rtrim($Locality,' '),' ')||'^'
   let $REPORT_TITLE = $REPORT_TITLE || ltrim(rtrim($Town_city,' '),' ')||'^'
   let $REPORT_TITLE = $REPORT_TITLE || ltrim(rtrim($StateA,' '),' ')||'^'
   let $REPORT_TITLE = $REPORT_TITLE || ltrim(rtrim($Pin,' '),' ')||'^'
   let $REPORT_TITLE = $REPORT_TITLE || ltrim(rtrim($email,' '),' ')||'^'
   let $REPORT_TITLE = $REPORT_TITLE || ltrim(rtrim($STD_Code,' '),' ')||'^'
   let $REPORT_TITLE = $REPORT_TITLE || ltrim(rtrim($Phone_Number,' '),' ')||'^'
   let $REPORT_TITLE = $REPORT_TITLE || ltrim(rtrim($Change_Addy,' '),' ')||'^'
   let $REPORT_TITLE = $REPORT_TITLE || ltrim(rtrim($Type_Emp,' '),' ')||'^'
   let $REPORT_TITLE = $REPORT_TITLE || ltrim(rtrim($NPR,' '),' ')||'^'
   let $REPORT_TITLE = $REPORT_TITLE || ltrim(rtrim($Desgn,' '),' ')||'^'
   let $REPORT_TITLE = $REPORT_TITLE || ltrim(rtrim($Addy1,' '),' ')||'^'
   let $REPORT_TITLE = $REPORT_TITLE || ltrim(rtrim($Addy2,' '),' ')||'^'
   let $REPORT_TITLE = $REPORT_TITLE || ltrim(rtrim($Addy3,' '),' ')||'^'
   let $REPORT_TITLE = $REPORT_TITLE || ltrim(rtrim($Addy4,' '),' ')||'^'
   let $REPORT_TITLE = $REPORT_TITLE || ltrim(rtrim($Addy5,' '),' ')||'^'
   let $REPORT_TITLE = $REPORT_TITLE || ltrim(rtrim($StateB,' '),' ')||'^'
   let $REPORT_TITLE = $REPORT_TITLE || ltrim(rtrim($Pin_code1,' '),' ')||'^'
   let $REPORT_TITLE = $REPORT_TITLE || ltrim(rtrim($email1,' '),' ')||'^'
   let $REPORT_TITLE = $REPORT_TITLE || ltrim(rtrim($mobile_no1,' '),' ')||'^'
   let $REPORT_TITLE = $REPORT_TITLE || ltrim(rtrim($STD_Code1,' '),' ')||'^'
   let $REPORT_TITLE = $REPORT_TITLE || ltrim(rtrim($Phone_Number1,' '),' ')||'^'
   let $REPORT_TITLE = $REPORT_TITLE || ltrim(rtrim($Change_Addy1,' '),' ')||'^'
   let $REPORT_TITLE = $REPORT_TITLE || ltrim(rtrim($Gross_Tot_Challan,' '),' ')||'^'
   let $REPORT_TITLE = $REPORT_TITLE || ltrim(rtrim($TDS_Circle,' '),' ')||'^'
   let $REPORT_TITLE = $REPORT_TITLE || ltrim(rtrim($DeducteeCount,' '),' ')||'^'
   let $REPORT_TITLE = $REPORT_TITLE || ltrim(rtrim($BatchGrsTotInc,' '),' ')||'^'
   let $REPORT_TITLE = $REPORT_TITLE || ltrim(rtrim($AO_Approval,' '),' ')||'^'
   let $REPORT_TITLE = $REPORT_TITLE || ltrim(rtrim($AO_Approval_Number,' '),' ')||'^'

   ! Fields added in the Batch-header record
   let $REPORT_TITLE = $REPORT_TITLE || ltrim(rtrim($lastdeductor,' '),' ')||'^'
   let $REPORT_TITLE = $REPORT_TITLE || ltrim(rtrim($statename,' '),' ')||'^'
   let $REPORT_TITLE = $REPORT_TITLE || ltrim(rtrim($PAOCode,' '),' ')||'^'
   let $REPORT_TITLE = $REPORT_TITLE || ltrim(rtrim($DDOcode,' '),' ')||'^'
   let $REPORT_TITLE = $REPORT_TITLE || ltrim(rtrim($ministryname,' '),' ')||'^'
   let $REPORT_TITLE = $REPORT_TITLE || ltrim(rtrim($ministryother,' '),' ')||'^'
   let $REPORT_TITLE = $REPORT_TITLE || ltrim(rtrim($PAN_Deductor,' '),' ')||'^'
   let $REPORT_TITLE = $REPORT_TITLE || ltrim(rtrim($PAOregisterno,' '),' ')||'^'
   let $REPORT_TITLE  = $REPORT_TITLE || ltrim(rtrim($DDOregisterno,' '),' ')||'^'

   let $REPORT_TITLE = $REPORT_TITLE || ltrim(rtrim($DStd_Code_Alt,' '),' ')||'^'
   let $REPORT_TITLE = $REPORT_TITLE || ltrim(rtrim($DTel_No_Alt,' '),' ')||'^'
   let $REPORT_TITLE  = $REPORT_TITLE || ltrim(rtrim($DEmail_Alt,' '),' ')||'^'
   let $REPORT_TITLE = $REPORT_TITLE || ltrim(rtrim($PStd_Code_Alt,' '),' ')||'^'
   let $REPORT_TITLE = $REPORT_TITLE || ltrim(rtrim($PTel_No_Alt,' '),' ')||'^'
   let $REPORT_TITLE  = $REPORT_TITLE || ltrim(rtrim($PEmail_Alt,' '),' ')||'^'
   let $REPORT_TITLE  = $REPORT_TITLE || ltrim(rtrim($Ac_Off_ID,' '),' ')||'^'


   ! Fields added in the Batch-header record
   let $REPORT_TITLE = $REPORT_TITLE || ltrim(rtrim($Record_Hash,' '),' ')

    write 4 from $REPORT_TITLE ! Print Batch Header


end-procedure


begin-procedure Get-Deductor-type($type_of_ded,:$type_of_ded1 )

   uppercase $type_of_ded
   Evaluate $type_of_ded
     when = 'A'
        move 'Central Government' to $type_of_ded1
        break
     when = 'B'
        move 'Body Of Individuals' to $type_of_ded1
        break
     when = 'D'
        move 'Statutory body (Central Govt)' to $type_of_ded1
        break
     when = 'E'
        move 'Statutory body (State Govt)' to $type_of_ded1
        break
     when = 'F'
        move 'Firm' to $type_of_ded1
        break
     when = 'G'
        move 'Autonomous body (Central Govt)' to $type_of_ded1
        break
     when = 'H'
        move 'Autonomous body (State Govt)' to $type_of_ded1
        break
     when = 'J'
        move 'Artificial Juridicial Person' to $type_of_ded1
        break
     when = 'K'
        move 'Company' to $type_of_ded1
        break
     when = 'L'
        move 'Local Authority (Central Govt)' to $type_of_ded1
        break
     when = 'M'
        move 'Branch/Division of Company' to $type_of_ded1
        break
     when = 'N'
        move 'Local Authority (State Govt)' to $type_of_ded1
        break
     when = 'P'
        move 'Association of Person(AOP' to $type_of_ded1
        break
     when = 'Q'
        move 'Individual/HUF' to $type_of_ded1
        break
     when = 'S'
        move 'State Government' to $type_of_ded1
        break
     when = 'T'
        move 'Association of Person(Trust)' to $type_of_ded1
        break
     end-evaluate

end-procedure



!*************************************************************************************
!                                                                                    *
!    Procedure:   Find-Change-In-Address                                             *
!    Description: To find if the address of employer/responsible person's address    *
!                 has been changed                                                   *
!                                                                                    *
!*************************************************************************************
begin-procedure Find-Change-In-Address

   let $AddEffDt1 = ''
   let $Change_Addy = ''
   let $QBegin_Dt = strtodate($QBegin,'DDMMYYYY')

! Checking whether employer's address has been changed since last report
begin-select
EST1.EFFDT

   move &EST1.EFFDT to $AddEffDt1 'YYYYMMDD'
   let $AddEffDt = strtodate($AddEffDt1,'YYYYMMDD')
   let #QDiff = datediff($AddEffDt,$QBegin_Dt,'day')

   if #QDiff < 0
      let $Change_Addy = 'N'
   else
      let $Change_Addy = 'Y'
   end-if

FROM PS_ESTAB_TBL EST1, PS_ESTAB_TBL_GPIN IES1, PS_STATE_TBL ST1
WHERE EST1.ESTABID = $Estab_Id
AND EST1.ESTABID = IES1.ESTABID
AND EST1.EFFDT = (SELECT MAX(EFFDT)
                 FROM PS_ESTAB_TBL
                 WHERE ESTABID = EST1.ESTABID
                 AND EFFDT <= &RNCT.END_DT)
AND IES1.EFFDT = (SELECT MAX(EFFDT)
                 FROM PS_ESTAB_TBL_GPIN
                 WHERE ESTABID = IES1.ESTABID
                 AND EFFDT <= &RNCT.END_DT)
AND EST1.COUNTRY = ST1.COUNTRY
AND EST1.STATE = ST1.STATE
End-Select

   let $AddEffDt1 = ''
   let $Change_Addy1 = ''

! Checking whether responsible person's address has been changed since last report
begin-select
AD1.EFFDT

   move &AD1.EFFDT to $AddEffDt1 'YYYYMMDD'
   let $AddEffDt2 = strtodate($AddEffDt1,'YYYYMMDD')
   let #QDiff = datediff($AddEffDt2,$QBegin_Dt,'day')

   if #QDiff < 0
      let $Change_Addy1 = 'N'
   else
      let $Change_Addy1 = 'Y'
   end-if

FROM PS_ADDRESSES AD1, PS_NAMES NM1, PS_STATE_TBL ST11
WHERE AD1.EMPLID = &IES.EMPLID
AND AD1.EMPLID = NM1.EMPLID
AND AD1.ADDRESS_TYPE = 'BUSN'
AND AD1.EFFDT = (SELECT MAX(EFFDT)
                 FROM PS_ADDRESSES
                 WHERE EMPLID = AD1.EMPLID
                 AND ADDRESS_TYPE = AD1.ADDRESS_TYPE
                 AND EFFDT <= &RNCT.END_DT)
AND NM1.NAME_TYPE = 'PRI'
AND NM1.EFFDT = (SELECT MAX(EFFDT)
                 FROM PS_NAMES
                 WHERE EMPLID = NM1.EMPLID
                 AND NAME_TYPE = NM1.NAME_TYPE
                 AND EFFDT <= &RNCT.END_DT)
AND ST11.COUNTRY = AD1.COUNTRY
AND ST11.STATE  = AD1.STATE
End-Select
end-procedure

!*************************************************************************************
!                                                                                    *
!    Procedure:   Get-State-Code                                                     *
!    Description: To find the 2 digit code for a paritcular state                    *
!                                                                                    *
!*************************************************************************************
begin-procedure Get-State-Code($State,:$StateP)

   uppercase $state
   Evaluate $state
     when = 'ANDAMAN AND NICOBAR ISLANDS'
        move '1' to $StateP
        break
     when = 'ANDHRA PRADESH'
        move '2' to $StateP
        break
     when = 'ARUNACHAL PRADESH'
        move '3' to $StateP
        break
     when = 'ASSAM'
        move '4' to $StateP
        break
     when = 'BIHAR'
        move '5' to $StateP
        break
     when = 'CHANDIGARH'
        move '6' to $StateP
        break
     when = 'DADRA AND NAGAR HAVELI'
        move '7' to $StateP
        break
     when = 'DAMAN AND DIU'
        move '8' to $StateP
        break
     when = 'DELHI'
        move '9' to $StateP
        break
     when = 'GOA'
        move '10' to $StateP
        break
     when = 'GUJARAT'
        move '11' to $StateP
        break
     when = 'HARYANA'
        move '12' to $StateP
        break
     when = 'HIMACHAL PRADESH'
        move '13' to $StateP
        break
     when = 'JAMMU AND KASHMIR'
        move '14' to $StateP
        break
     when = 'KARNATAKA'
        move '15' to $StateP
        break
     when = 'KERALA'
        move '16' to $StateP
        break
     when = 'LAKSHADWEEP'
        move '17' to $StateP
        break
     when = 'MADHYA PRADESH'
        move '18' to $StateP
        break
     when = 'MAHARASHTRA'
        move '19' to $StateP
        break
     when = 'MANIPUR'
        move '20' to $StateP
        break
     when = 'MEGHALAYA'
        move '21' to $StateP
        break
     when = 'MIZORAM'
        move '22' to $StateP
        break
     when = 'NAGALAND'
        move '23' to $StateP
        break
     when = 'ORISSA'
        move '24' to $StateP
        break
     when = 'PONDICHERRY'
        move '25' to $StateP
        break
     when = 'PUNJAB'
        move '26' to $StateP
        break
     when = 'RAJASTHAN'
        move '27' to $StateP
        break
     when = 'SIKKIM'
        move '28' to $StateP
        break
     when = 'TAMILNADU'
        move '29' to $StateP
        break
     when = 'TRIPURA'
        move '30' to $StateP
        break
     when = 'UTTAR PRADESH'
        move '31' to $StateP
        break
     when = 'WEST BENGAL'
        move '32' to $StateP
        break
     when = 'CHHATTISGARH'
        move '33' to $StateP
        break
     when = 'UTTARANCHAL'
        move '34' to $StateP
        break
     when = 'JHARKHAND'
        move '35' to $StateP
        break
     when = 'TELANGANA'
        move '36' to $StateP
        break
     when = 'LADAKH'
        move '37' to $StateP
        break
     when-other
        move '99' to $StateP
        move '999999' to $Pin
        break
   end-evaluate

end-procedure

!*************************************************************************************
!                                                                                    *
!    Procedure: Get-Emp-Type                                                         *
!    Description: Finding employer type                                              *
!                                                                                    *
!*************************************************************************************
!begin-procedure Get-Emp-Type
!begin-select
!GPIN_GOVT_IND

   ! if &GPIN_GOVT_IND = 'Y'
    !    move 'C' to $Type_Emp
   ! else
  !      move 'O' to $Type_Emp
 !   end-if

!from PS_GPIN_24Q_RC
!where OPRID = $prcs_oprid

!AND RUN_CNTL_ID = $prcs_run_cntl_id

!end-select

!end-procedure

!*************************************************************************************
!                                                                                    *
!    Procedure:   Get-Challan_Values                                                 *
!    Description: Gets Challan count and Total Tax Deposited as per Challan          *
!                 Annexure                                                           *
!                                                                                    *
!*************************************************************************************
begin-procedure Get-Challan_Values

   let #Gross_Tot_Challan = 0
   let #Gross_Tot_Ded     = 0

if $EstRTAN = 'E' 
begin-select
GCV1.GPIN_SR_NBR
GCV1.GPIN_MONTH
GCV1.GPIN_TDS_AMT
GCV1.GPIN_TDS_SUR_AMT
GCV1.GPIN_TDS_CESS_AMT
GCV1.GPIN_TDS_INT_AMT
GCV1.GPIN_TDS_OTH_AMT

   let #Challan_Cnt = 0

   let #Gross_Tot_Challan = #Gross_Tot_Challan
                              + &GCV1.GPIN_TDS_AMT
                              + &GCV1.GPIN_TDS_SUR_AMT
                              + &GCV1.GPIN_TDS_CESS_AMT
                              + &GCV1.GPIN_TDS_INT_AMT
                              + &GCV1.GPIN_TDS_OTH_AMT

   let #Gross_Tot_Ded     = #Gross_Tot_Ded
                              + &GCV1.GPIN_TDS_AMT
                              + &GCV1.GPIN_TDS_SUR_AMT
                              + &GCV1.GPIN_TDS_CESS_AMT

   move &GCV1.GPIN_SR_NBR to #Challan_Cnt


FROM PS_GPIN_QT_F24_DTL GCV1
WHERE GCV1.ESTABID [$ESTABIDIN]
AND GCV1.GPIN_YEAR_CD    = &RNCT.GPIN_YEAR_CD
AND GCV1.GPIN_QUARTER_ID = &RNCT.GPIN_QUARTER_ID
end-select
else
begin-select
GCV2.GPIN_SR_NBR
GCV2.GPIN_MONTH
GCV2.GPIN_TDS_AMT
GCV2.GPIN_TDS_SUR_AMT
GCV2.GPIN_TDS_CESS_AMT
GCV2.GPIN_TDS_INT_AMT
GCV2.GPIN_TDS_OTH_AMT

   let #Challan_Cnt = 0

   let #Gross_Tot_Challan = #Gross_Tot_Challan
                              + &GCV2.GPIN_TDS_AMT
                              + &GCV2.GPIN_TDS_SUR_AMT
                              + &GCV2.GPIN_TDS_CESS_AMT
                              + &GCV2.GPIN_TDS_INT_AMT
                              + &GCV2.GPIN_TDS_OTH_AMT

   let #Gross_Tot_Ded     = #Gross_Tot_Ded
                              + &GCV2.GPIN_TDS_AMT
                              + &GCV2.GPIN_TDS_SUR_AMT
                              + &GCV2.GPIN_TDS_CESS_AMT

   move &GCV2.GPIN_SR_NBR to #Challan_Cnt


FROM PS_GPIN_F24TAN_DTL GCV2
WHERE GCV2.GPIN_IT_TAN_NBR = $RCTAN
AND GCV2.GPIN_YEAR_CD    = &RNCT.GPIN_YEAR_CD
AND GCV2.GPIN_QUARTER_ID = &RNCT.GPIN_QUARTER_ID
end-select

end-if

end-procedure


!*************************************************************************************
!                                                                                    *
!    Procedure:   Deductee-Rec-Count                                                 *
!    Description: Gets the deductee record count                                     *
!                                                                                    *
!*************************************************************************************
begin-procedure Deductee-Rec-Count

   let $Deductee_Cnt = ''
   let $Perq_Cnt = ''
   let #Deductee_Cnt = 0
   let #Perq_Cnt = 0

Begin-Select DISTINCT
A2.EMPLID

   Move &A2.EMPLID to $Emp_Id
   do Get-Rpt-Fields
   add 1 to #Deductee_Cnt

   if (#f24q_accom     <> 0   or
       #f24q_cost_furn  <> 0   or
       #f24q_perqconve  <> 0   or
       #f24q_remun      <> 0   or
       #f24q_travel     <> 0   or
       #f24q_ben_other  <> 0   or
       #f24q_perqvalue  <> 0   or
       #f24q_interst    <> 0   or
       #perq            <> 0   )
      add 1 to #Perq_Cnt
   end-if


FROM PS_GPIN_24Q_TMP A2 , PS_ESTAB_TBL_GPIN C2, PS_NAMES  EMPNM2 ,PS_EMPLOYMENT EMPMNT2
WHERE A2.GP_GENRPT_BREAK1 = C2.ESTABID
AND A2.GP_GENRPT_BREAK1   [$ESTABIDIN]
AND EMPMNT2.EMPLID        = EMPNM2.EMPLID
AND EMPMNT2.EMPLID        = A2.EMPLID
AND A2.JOBINSTANCE        = #prcs_job_instance
AND C2.EFFDT              = (SELECT MAX(EFFDT) FROM PS_ESTAB_TBL_GPIN
                              WHERE ESTABID = C2.ESTABID
                              AND   EFFDT <= &RNCT.END_DT)
AND EMPNM2.NAME_TYPE      = 'PRI'
AND EMPNM2.EFFDT          = (SELECT MAX(EFFDT) FROM PS_NAMES
                             WHERE EMPLID = EMPNM2.EMPLID
                             AND NAME_TYPE = EMPNM2.NAME_TYPE
                             AND EFFDT <= &rnct.end_dt)
End-Select

end-procedure

!*************************************************************************************
!    Procedure: initialize-empl-vars                                                 *
!    Initialize Employee Variables                                                   *
!                                                                                    *
!*************************************************************************************
begin-procedure initialize-empl-vars

   let #repval = 0
   move #repval to #totsal
   move #repval to #hra
   move #repval to #perq
   move #repval to #perqex
   move #repval to #sec16ded
   move #repval to #incnotsal
   move #repval to #sec80don
   move #repval to #sec80rent
   move #repval to #taxreb
   move #repval to #s89rel
   move #repval to #tottds
   move #repval to #tdssur
   move #repval to #tdsedu
   move #repval to #totded
   move #repval to #totinctax
   move #repval to #inctaxpbl
   move #repval to #tdsval
   move #repval to #f24q_accom
   move #repval to #f24q_ben_other
   move #repval to #f24q_cost_furn
   move #repval to #f24q_interst
   move #repval to #f24q_perqconve
   move #repval to #f24q_perqfurn
   move #repval to #f24q_perqvalue
   move #repval to #f24q_remun
   move #repval to #f24q_travel
   move #repval to #f24q_value_acco
   move #repval to #F24Q_REB_88B
   move #repval to #F24Q_REB_88C
   move #repval to #F24Q_REB_88D
   move #repval to #tds_gross_sal
   move #repval to #tds_gross_sal
   move #repval to #sec16ded
   move #repval to #sec80cce

   move #repval to #sec80ccf

   move #repval to #totchap6a
   move #repval to #totinctax
   move #repval to #tdssurcharge
   move #repval to #EducationCess
   move #repval to #TaxableInc
   move #repval to #tdssurmonth
   move #repval to #tdseducessmonth
   move #repval to #Sec16PTDedCnt
   move #repval to #Sec16StdDedCnt
   move #repval to #Chap6ADedCnt
   
   !Form 24Q changes v6.4
   move #repval to #sec80ccg
   move #repval to #sec80c
   move #repval to #sec80ccc
   move #repval to #sec80ccd1
   move #repval to #sec80ccd1b
   move #repval to #sec80ccd2
   move #repval to #sec80d
   move #repval to #sec80e
   move #repval to #sec80g
   move #repval to #sec80tta
   
   
   move #repval to #F24Q_SEC80C
   move #repval to #F24Q_SEC80CCC
   move #repval to #F24Q_SEC80CCD1
   move #repval to #F24Q_SEC80CCD1B
   move #repval to #F24Q_SEC80CCD2
   move #repval to #F24Q_SEC80D
   move #repval to #F24Q_SEC80E
   move #repval to #F24Q_SEC80TTA
   move #repval to #F24Q_SEC17_1
   move #repval to #F24Q_SEC17_2
   move #repval to #F24Q_SEC17_3
   move #repval to #F24Q_SEC10_5
   move #repval to #F24Q_SEC10_10
   move #repval to #F24Q_SEC10_10A
   move #repval to #F24Q_SEC10_10AA
   move #repval to #F24Q_SEC10_13A
   move #repval to #F24Q_SEC10_OTH
   move #repval to #F24Q_SEC192_2B
   
   !Form 24Q changes v6.4 ends

   ! New Code v6.5
   move #repval to #F24Q_80CCC_DECL
   move #repval to #F24Q_80D_DECL
   move #repval to #F24Q_80TTA_DECL
   move #repval to #sec80g_50
   move #repval to #sec80g_100
   move #repval to #F24Q_80E_DECL
   move #repval to #F24Q_SEC80CCD1B
   move #repval to #F24Q_SEC80CCD2
   move #repval to #F24Q_6AOTH_QUAL
   move #repval to #F24Q_6AOTH_GROS
   move #repval to #F24Q_80C_DECL
   move #repval to #sec80don1
   ! New Code v6.5

end-procedure !initialize-empl-vars

!***********************************************************************
! Procedure:    Print_Form                                             *
!                                                                      *
! Description: Printing the form                                       *
!                                                                      *
!***********************************************************************

begin-procedure  Print_Form


begin-select
EST.ESTABID
EST.EFFDT
EST.ADDRESS1
EST.ADDRESS2
EST.ADDRESS3
EST.ADDRESS4
EST.CITY
EST.STATE
ST.DESCR
EST.POSTAL
EST.COMPANY
IES.GPIN_REG_NAME
IES.GPIN_IT_PAN_NBR
IES.GPIN_IT_TAN_NBR
IES.EMPLID
IES.GPIN_ED_TYPE

   let $emplidtemps       = RTRIM(LTRIM(&IES.EMPLID, ' '), ' ')    
   let $name                = RTRIM(LTRIM(&IES.GPIN_REG_NAME   , ' ') , ' ')
   let $NAMEESTAB           = $NAME
   let $flat_no             = RTRIM(LTRIM(&EST.ADDRESS1, ' ') , ' ')
   let $name_of_building    = RTRIM(LTRIM(&EST.ADDRESS2, ' ') , ' ')
   let $road                = RTRIM(LTRIM(&EST.ADDRESS3, ' ') , ' ')
   let $area                = RTRIM(LTRIM(&EST.ADDRESS4, ' ') , ' ')
   let $town                = RTRIM(LTRIM(&EST.CITY    , ' ') , ' ')
   let $Place               = RTRIM(LTRIM(&EST.CITY    , ' ') , ' ')
   let $state               = RTRIM(LTRIM(&ST.DESCR    , ' ') , ' ')
   let $pin_code            = RTRIM(LTRIM(&EST.POSTAL  , ' ') , ' ')
   let $email               = ''
   let $STD_Code            = ''
   let $Phone_Number        = ''

   let $tax_ded_ac          = RTRIM(LTRIM(&IES.GPIN_IT_TAN_NBR, ' '), ' ')
   let $TANNO               = $tax_ded_ac
   let $permnt_ac_no        = RTRIM(LTRIM(&IES.GPIN_IT_PAN_NBR, ' '), ' ')
   let $type_of_ded         = RTRIM(LTRIM(&IES.GPIN_ED_TYPE, ' '), ' ')
   move $state to $state_emp

FROM PS_ESTAB_TBL EST, PS_ESTAB_TBL_GPIN IES, PS_STATE_TBL ST
WHERE EST.ESTABID = $Estab_Id
AND EST.ESTABID   = IES.ESTABID
AND EST.EFFDT     = (SELECT MAX(EFFDT)
                     FROM PS_ESTAB_TBL
                     WHERE ESTABID = EST.ESTABID
                     AND EFFDT <= &RNCT.END_DT)
AND IES.EFFDT     = (SELECT MAX(EFFDT)
                     FROM PS_ESTAB_TBL_GPIN
                     WHERE ESTABID = IES.ESTABID
                     AND EFFDT <= &RNCT.END_DT)
AND EST.COUNTRY   = ST.COUNTRY
AND EST.STATE     = ST.STATE
End-Select


BEGIN-SELECT
EMAIL_ADDR

   LET $email1 = RTRIM(LTRIM(&EMAIL_ADDR, ' '), ' ')

FROM PS_EMAIL_ADDRESSES
WHERE EMPLID =  $emplidtemps 
AND E_ADDR_TYPE = 'BUSN'
END-SELECT

   let $branch_div = ''
   let $address    = ''

BEGIN-SELECT
EST1.PHONE

   let $tel_no = RTRIM(LTRIM(&EST1.PHONE, ' '), ' ')

FROM PS_ESTAB_PHONE EST1
WHERE EST1.ESTABID = $Estab_Id
AND EST1.PHONE_TYPE = 'BUSN'
AND EST1.EFFDT = (SELECT MAX(EFFDT)
                   FROM PS_ESTAB_TBL
                   WHERE ESTABID = EST1.ESTABID
                   AND PHONE_TYPE = EST1.PHONE_TYPE
                   AND EFFDT <= &RNCT.END_DT)

END-SELECT

   let $Name_of_certify = ''
   let $Name_resp_prsn  = ''
   do Print_Heading
   do Print_Section_1
   do Print_Section_2

begin-select
NM.NAME
AD.ADDRESS1
AD.ADDRESS2
AD.ADDRESS3
AD.ADDRESS4
AD.CITY
AD.STATE
ST1.DESCR
AD.POSTAL

   let $name1                = RTRIM(LTRIM(&NM.NAME   , ' ') , ' ')
   let $Name_of_certify     = $name1
   let $flat_no1             = RTRIM(LTRIM(&AD.ADDRESS1, ' ') , ' ')
   let $name_of_building1    = RTRIM(LTRIM(&AD.ADDRESS2, ' ') , ' ')
   let $road1                = RTRIM(LTRIM(&AD.ADDRESS3, ' ') , ' ')
   let $area1                = RTRIM(LTRIM(&AD.ADDRESS4, ' ') , ' ')
   let $town1                = RTRIM(LTRIM(&AD.CITY    , ' ') , ' ')
   let $state1               = RTRIM(LTRIM(&ST1.DESCR  , ' ') , ' ')
   let $pin_code1            = RTRIM(LTRIM(&AD.POSTAL  , ' ') , ' ')

FROM PS_ADDRESSES AD, PS_NAMES NM, PS_STATE_TBL ST1
WHERE AD.EMPLID = &IES.EMPLID
AND AD.EMPLID = NM.EMPLID
AND AD.ADDRESS_TYPE = 'BUSN'
AND AD.EFFDT = (SELECT MAX(EFFDT)
                 FROM PS_ADDRESSES
                 WHERE EMPLID = AD.EMPLID
                 AND ADDRESS_TYPE = AD.ADDRESS_TYPE
                 AND EFFDT <= &RNCT.END_DT)
AND NM.NAME_TYPE = 'PRI'
AND NM.EFFDT = (SELECT MAX(EFFDT)
                 FROM PS_NAMES
                 WHERE EMPLID = NM.EMPLID
                 AND NAME_TYPE = NM.NAME_TYPE
                 AND EFFDT <= &RNCT.END_DT)
AND ST1.COUNTRY = AD.COUNTRY
AND ST1.STATE  = AD.STATE
End-Select

   let $tel_no1 = ''

BEGIN-SELECT
PHONE

   LET $tel_no1 = RTRIM(LTRIM(&PHONE, ' '), ' ')

FROM PS_PERSONAL_PHONE
WHERE EMPLID = &IES.EMPLID
AND PHONE_TYPE = 'BUSN'
END-SELECT
!***********Bug 21095889 - DISCREPENCIES IN THE FORMAT OF FORM 24Q.TXT*****
let $PAN_Deductor = ''

Begin-Select
NID.NATIONAL_ID

   Move &NID.NATIONAL_ID To $PAN_Deductor

FROM PS_PERS_NID NID
WHERE NID.COUNTRY = 'IND'
AND NID.NATIONAL_ID_TYPE = 'PAN'
AND NID.EMPLID = &IES.EMPLID
AND NID.NATIONAL_ID<>' '
End-Select

!**************************************************************************
   let $mobile_no1 = ''

BEGIN-SELECT
PHONE &PHONE1

   LET $mobile_no1 = RTRIM(LTRIM(&PHONE1, ' '), ' ')

FROM PS_PERSONAL_PHONE
WHERE EMPLID = &IES.EMPLID
AND PHONE_TYPE = 'CELL'
END-SELECT


let #i  = 1
  let #slen = length($mobile_no1)
  let $nstr = ''

  while (#i <= #slen)
    let $char = substr($mobile_no1,#i,1)
    if $char = '/' or $char = '-'
      let $char = ''
    end-if
    let $nstr = $nstr || $char
    add 1 to #i
  end-while

  let $mobile_no1 = edit($nstr,'9999999999')



Begin-Select
JOBCD.DESCR
JOB.ESTABID
JOB.EMPLID

   MOVE &JOBCD.DESCR TO $DESIGNATION

FROM PS_JOB JOB, PS_JOBCODE_TBL JOBCD
WHERE JOB.EMPLID = &IES.EMPLID
AND JOB.JOBCODE=JOBCD.JOBCODE
AND JOB.EMPL_RCD = 0
AND JOB.EFFDT<=(SELECT MAX(EFFDT)
                FROM PS_JOB
                WHERE EMPLID=JOB.EMPLID
                AND EMPL_RCD = JOB.EMPL_RCD
                AND EFFDT <= &RNCT.END_DT)
AND JOB.EFFSEQ <= (SELECT MAX(EFFSEQ)
                   FROM PS_JOB
                   WHERE EMPLID=JOB.EMPLID
                   AND EMPL_RCD=JOB.EMPL_RCD
                   AND EFFDT = JOB.EFFDT)
AND JOBCD.EFFDT = (SELECT MAX(EFFDT)
                   FROM PS_JOBCODE_TBL
                   WHERE JOBCODE  = JOBCD.JOBCODE
                   AND   EFFDT <= &RNCT.END_DT)
ORDER BY JOB.EMPLID
End-Select

   let $Name_resp_prsn = $Name_of_certify || ' : ' || RTRIM(LTRIM($DESIGNATION, ' '), ' ')
   let $NPR = ltrim(rtrim($Name_of_certify,' '),' ')

   do Write-Batch-Header

   do Print_Section_3
   new-page
   do Print_Section_4
   do Print_Section_5
end-procedure


!***********************************************************************
! Procedure:    Print_Heading                                          *
!                                                                      *
! Description: Printing the heading of the form                        *
!                                                                      *
!***********************************************************************

begin-procedure  Print_Heading

   alter-printer font = #Heading_Font point-size = #HeadingPntSize
   print $heading_1_lbl   (1,50)bold
   alter-printer font = #Heading_Font point-size = #StdPntSize
   print $heading_2_lbl   (+1,46)
   print $heading_3_1_lbl (+2,18)
   print $heading_3_2_lbl (,71)
   let $heading_4_lbl = $heading_4_lbl ||' '|| $Month ||' '||$Tax_year
   print $heading_4_lbl   (+1,44)

end-procedure


!***********************************************************************
! Procedure:    Print_Section_1                                        *
!                                                                      *
! Description: Printing section 1 of the form                          *
!                                                                      *
!***********************************************************************

begin-procedure  Print_Section_1

   do Get-Deductor-type($type_of_ded,$type_of_ded1 )

   print '1'                   (+2,5) bold

   print $tax_ded_ac_lbl       (,7)
   print $statement_filed_lbl  (,62) 
  
   let #index = 1
   let #pos = 30

   while #index <=10
         graphic (, #pos,3) box 2

         if length($tax_ded_ac) = 10
              let $taxdedno = substr($tax_ded_ac,#index,1) 
         else
              let $taxdedno = ' '
         end-if 
         let #pos1 = #pos + 1         
         print $taxdedno           (,#pos1)
         let #index = #index + 1
         let #pos = #pos + 3
   end-while 

   graphic (, 88,15) box 2
   print $stmt_filed_yn        (,89)

   print $tax_ded_ac_lbl1       (+1,9)
   print $stmt_filed_2_lbl      (,64)

   print $permnt_ac_no_lbl     (+2,7)
   print $if_ans_lbl           (,62)

   let #index = 1
   let #pos = 30

   while #index <=10
         graphic (, #pos,3) box 2

         if length($permnt_ac_no) = 10
              let $pannox = substr($permnt_ac_no,#index,1) 
         else
              let $pannox = ' '
         end-if 
         let #pos1 = #pos + 1
         print $pannox           (,#pos1)
         let #index = #index + 1
         let #pos = #pos + 3
   end-while 


   graphic (, 88,15) box 2
   print $if_ans_to_e          (,89)


   print $permnt_ac_no_lbl1    (+1,9)
   print $if_ans_2_lbl         (,64)

   print $fincal_year_lbl      (+2,7)
   print $type_of_ded_lbl      (,62)

   let $fin_year = replace($financial_year,' - 20','-')

   let #index = 1
   let #pos = 30

   while #index <= length($fin_year)
         graphic (, #pos,3) box 1
         let $fin_yearx = substr($fin_year,#index,1) 
         let #pos1 = #pos + 1
         print $fin_yearx           (,#pos1)
         let #index = #index + 1
         let #pos = #pos + 3
   end-while 

   graphic (, 88,15) box 1
   print $type_of_ded1         (,89)
 
end-procedure


!***********************************************************************
! Procedure:    Print_Section_2                                        *
!                                                                      *
! Description: Printing section 2 of the form                          *
!                                                                      *
!***********************************************************************

begin-procedure  Print_Section_2

   print '2'  (+1,5) bold
   print $sect2_heading_lbl   (,7) bold

   print $name_lbl  (+1,7) 
   graphic (, 35,40) box 1
   print $name      (,36)

   print $cntlstlbl  (+1,7) 
   print $name_lbl1  (+1,9) 
   graphic (, 35,40) box 1
   print ' '     (,36)

   print $aincd_lbl  (+1,9) 
   if length($AIN_No) = 0
      graphic (, 35,25) box 1
      print $AIN_No     (,36)
   else
      let #index = 1
      let #pos = 35
      while #index <=length($AIN_No)
         graphic (, #pos,3) box 1
         let $AIN_Nox = substr($AIN_No,#index,1) 
         let #pos1 = #pos + 1         
         print $AIN_Nox           (,#pos1)
         let #index = #index + 1
         let #pos = #pos + 3
      end-while 
   end-if

   print $tanregnolbl  (+1,7) 
   graphic (, 35,21) box 1
   print $Tan_Reg_No     (,36)

   print $address_lbl  (+1,7) 

   print $FLAT_NO_lbl  (+1,9) 
   graphic (, 40,35) box 1
   print $flat_no     (,41)

   print $name_of_building_lbl  (+1,9) 
   graphic (, 40,35) box 1
   print $name_of_building     (,41)

   print $ROAD_lbl  (+1,9) 
   graphic (, 40,35) box 1
   print $road     (,41)

   print $area_lbl  (+1,9) 
   graphic (, 40,35) box 1
   print $area     (,41)

   print $TOWN_lbl  (+1,9) 
   graphic (, 40,35) box 1
   print $town     (,41)

   print $STATE_lbl  (+1,9) 
   graphic (, 40,35) box 1
   print $state      (,41)

   print $PIN_CODE_lbl  (+1,9) 
   graphic (, 40,35) box 1
   print $pin_code      (,41)


   print $TEL_NO_lbl  (+1,9) 
   graphic (, 40,35) box 1
   print $tel_no       (,41)

   print $ALTTEL_NO_lbl  (+1,9) 
   graphic (, 40,35) box 1
   print ' '      (,41)

   print $EMAIL_lbl  (+1,9) 
   graphic (, 40,35) box 1
   print $email      (,41)

   print $ALTEMAIL_lbl  (+1,9) 
   graphic (, 40,35) box 1
   print ' '      (,41)


end-procedure

!***********************************************************************
! Procedure:    Print_Section_3                                        *
!                                                                      *
! Description: Printing section 3 of the form                          *
!                                                                      *
!***********************************************************************

begin-procedure  Print_Section_3

   print '3'                 (+1,5) bold
   print $sect3_heading_lbl  (,7) bold

   print $name_lbl  (+1,7) 
   graphic (, 40,35) box 1
   print $name1      (,41)

   print $address_lbl1  (+1,7) 

   print $FLAT_NO_lbl  (+1,9) 
   graphic (, 40,35) box 1
   print $flat_no1     (,41)

   print $name_of_building_lbl  (+1,9) 
   graphic (, 40,35) box 1
   print $name_of_building1     (,41)

   print $ROAD_lbl  (+1,9) 
   graphic (, 40,35) box 1
   print $road1    (,41)

   print $area_lbl  (+1,9) 
   graphic (, 40,35) box 1
   print $area1     (,41)

   print $TOWN_lbl  (+1,9) 
   graphic (, 40,35) box 1
   print $town1     (,41)

   print $STATE_lbl  (+1,9) 
   graphic (, 40,35) box 1
   print $state1      (,41)

   print $PIN_CODE_lbl  (+1,9) 
   graphic (, 40,35) box 1
   print $pin_code1      (,41)

   print $TEL_NO_lbl  (+1,9) 
   graphic (, 40,35) box 1
   print $tel_no1       (,41)

   print $ALTTEL_NO_lbl  (+1,9) 
   graphic (, 40,35) box 1
   print ' '      (,41)

   print $EMAIL_lbl  (+1,9) 
   graphic (, 40,35) box 1
   print $email1      (,41)

   print $ALTEMAIL_lbl  (+1,9) 
   graphic (, 40,35) box 1
   print ' '      (,41)

end-procedure

!***********************************************************************
! Procedure:    Print_Section_4                                        *
!                                                                      *
! Description: Printing section 4 of the form                          *
!                                                                      *
!***********************************************************************

begin-procedure  Print_Section_4
   print '4'                 (,5) bold
   print $sect4_heading_lbl  (,7) bold

   let #depth    = 11

   graphic (+2, 7,104) box #depth
   let #index = 1
   let #pos   = 15

   graphic (-1, #pos, #depth)  vert-line 1

   while #index <= 12
      graphic (, #pos, #depth)  vert-line 1
        add 8 to #pos
      add 1 to #index
   end-while

   print $SR_NO_lbl          (+1,8) 
   print $TDS_lbl            (,17)
   print $SURCHARGE_lbl      (,24)
   print $EDUCATION_lbl      (,32)
   print $INTEREST_lbl       (,41)
   print $FEE_lbl            (,49)
   print $PENALTY_lbl        (,56)
   print $TOTAL_TAX_lbl      (,63)
   print $COL309_lbl         (,71)
   print $bsr_code_lbl       (,80)
   print $challan_lbl        (,89)
   print $date_on_lbl        (,97)
   print $COL313_lbl         (,104)

   print $cess_lbl           (+1,33)
   print $FEE_lbl1           (,49)
   print $OTHERS_lbl         (,56)
   print $TOTAL_TAX_lbl1     (,63)
   print $COL309_lbl1        (,72)
   print $COL310_lbl1        (,80)
   print $COL311_lbl1        (,89)
   print $COL312_lbl1        (,97)
   print $COL313_lbl1        (,104)

   print $FEE_lbl2           (+1,48)
   print $TOTAL_TAX_lbl2     (,64)
   print $COL309_lbl2        (,72)
   print $COL310_lbl2        (,80)
   print $COL311_lbl2        (,89)
   print $COL312_lbl2        (,97)
   print $COL313_lbl2        (,103)

   print $TOTAL_TAX_lbl3     (+1,64)
   print $COL309_lbl3        (,72)
   print $COL310_lbl3        (,80)
   print $SERIAL_NO_lbl      (,89)
   print $COL312_lbl3        (,97)

   print $TOTAL_TAX_lbl4     (+1,64)
   print $COL309_lbl4        (,72)
   print $COL310_lbl4        (,80)
   print $COL311_lbl3        (,89)
   print $COL312_lbl4        (,97)

   print $TOTAL_TAX_lbl5     (+1,64)
   print $TOTAL_TAX_lbl4     (,72)
   print $COL310_lbl5        (,80)
   print $COL311_lbl4        (,89)
   print $COL312_lbl5        (,97)

   print $TOTAL_TAX_lbl6     (+1,64)
   print $COL309_lbl5        (,72)
   print $COL311_lbl5        (,89)
   print $COL312_lbl6        (,97)

   print $TOTAL_TAX_lbl7     (+1,64)
   print $COL309_lbl6        (,71)
   print $COL311_lbl6        (,89)
   print $COL312_lbl7        (,97)

   print $TOTAL_TAX_lbl8     (+1,63)
   print $COL312_lbl8        (,95)

   graphic (+1, 7,104) box 1
   let #index = 1
   let #pos = 15

   graphic (-1, #pos, 1)  vert-line 1

   while #index <= 12
      graphic (, #pos, 1)  vert-line 1
      add 8 to #pos
      add 1 to #index
   end-while
  
   graphic (+1, 7, 104)  horz-line 1

   print $301_lbl   (,9)
   print $302_lbl   (,18)
   print $303_lbl   (,26)
   print $304_lbl   (,34)
   print $305_lbl   (,42)
   print $306_lbl   (,50)
   print $307_lbl   (,58)
   print $308_lbl   (,66)
   print $309_lbl   (,74)
   print $310_lbl   (,82)
   print $311_lbl   (,90)
   print $312_lbl   (,98)
   print $313_lbl   (,106)


  ! **************************************************************************
  !   4 Data.
  ! **************************************************************************

   let #sr_no            = 1

   let #tot_TDS          = 0
   let #tot_Surcharge    = 0
   let #tot_Edu_Cess     = 0
   let #tot_Interest     = 0
   let #tot_Others       = 0
   let #tot_Tot_tax_dep  = 0
   let $CAL_PRD_ID       = ''
   let #GPIN_SR_NBR      = 0


if $EstRTAN = 'E' 
begin-select
DTL.GPIN_SR_NBR
DTL.GPIN_TDS_AMT
DTL.GPIN_TDS_SUR_AMT
DTL.GPIN_TDS_CESS_AMT
DTL.GPIN_TDS_INT_AMT
DTL.GPIN_TDS_OTH_AMT
DTL.GPIN_LATE_FEE
DTL.GPIN_VCHR_NBR
DTL.GPIN_VCHR_DT
DTL.GPIN_CHEQUE_NO
DTL.GPIN_BSR_CODE
DTL.GPIN_BK_ENT_IND
DTL.GPIN_TOTAL_CNT
DTL.CAL_PRD_ID
DTL.GPIN_MRHD_CHLN

   let $CAL_PRD_ID       =  rtrim(ltrim(&DTL.CAL_PRD_ID,' '),' ')
   let #GPIN_SR_NBR      =  &DTL.GPIN_SR_NBR

   let $ANNEX1FILESUFFIX =rtrim(ltrim(&DTL.CAL_PRD_ID,' '),' ')
   LET #TOT_TAX_DEP = &DTL.GPIN_TDS_AMT
                + &DTL.GPIN_TDS_SUR_AMT
                + &DTL.GPIN_TDS_CESS_AMT
                + &DTL.GPIN_TDS_INT_AMT
                + &DTL.GPIN_TDS_OTH_AMT
                + &DTL.GPIN_LATE_FEE

   let #tot_TDS          = #tot_TDS         + &DTL.GPIN_TDS_AMT
   let #tot_Surcharge    = #tot_Surcharge   + &DTL.GPIN_TDS_SUR_AMT
   let #tot_Edu_Cess     = #tot_Edu_Cess    + &DTL.GPIN_TDS_CESS_AMT
   let #tot_Interest     = #tot_Interest    + &DTL.GPIN_TDS_INT_AMT
   let #tot_Others       = #tot_Others      + &DTL.GPIN_TDS_OTH_AMT
   let #tot_Tot_tax_dep  = #tot_Tot_tax_dep + #TOT_TAX_DEP
   let #tot_LATEFEE      = #tot_LATEFEE + &DTL.GPIN_LATE_FEE

   MOVE &DTL.GPIN_SR_NBR TO $Sr_No 999999

   let #TDS                 = &DTL.GPIN_TDS_AMT
   let #Surcharge           = &DTL.GPIN_TDS_SUR_AMT
   let #Edu_Cess            = &DTL.GPIN_TDS_CESS_AMT
   let #Interest            = &DTL.GPIN_TDS_INT_AMT
   let #Others              = &DTL.GPIN_TDS_OTH_AMT
   let #F24qLateFee         = &DTL.GPIN_LATE_FEE
   let #Tot_tax_deposited   = #TOT_TAX_DEP
   let $Cheque_No           = rtrim(ltrim(&DTL.GPIN_CHEQUE_NO, ' '), ' ')
   let $BSR_Code            = rtrim(ltrim(&DTL.GPIN_BSR_CODE , ' '), ' ')
   let $BSR_Code            = edit(&DTL.GPIN_BSR_CODE,'XXXXXXX')
   let $Transf_voucher_SlNo = rtrim(ltrim(&DTL.GPIN_VCHR_NBR , ' '), ' ')
   MOVE &DTL.GPIN_VCHR_DT TO $Date_tax_deposited  DD/MM/YYYY
   MOVE &DTL.GPIN_VCHR_DT TO $Date_Dep_CD  DDMMYYYY
   Move &DTL.GPIN_MRHD_CHLN to $Minor_HDChln

   let $TDS_dep_by_book = rtrim(ltrim(&DTL.GPIN_BK_ENT_IND, ' '), ' ')

   do Print_Section_4_Data
   let $WriteChlnData = '1'
   do Get-Annexure1-Data
   let $WriteChlnData = '0'
   do Print-Challan_Detail-Rec
   do Get-Annexure1-Data
   do Write-Annexure1-Footer
FROM PS_GPIN_QT_F24_DTL DTL
WHERE DTL.ESTABID [$ESTABIDIN]
AND DTL.GPIN_YEAR_CD    = &RNCT.GPIN_YEAR_CD
AND DTL.GPIN_QUARTER_ID = &RNCT.GPIN_QUARTER_ID
end-select

else
 

begin-select
DTL1.GPIN_SR_NBR
DTL1.GPIN_TDS_AMT
DTL1.GPIN_TDS_SUR_AMT
DTL1.GPIN_TDS_CESS_AMT
DTL1.GPIN_TDS_INT_AMT
DTL1.GPIN_TDS_OTH_AMT
DTL1.GPIN_LATE_FEE
DTL1.GPIN_VCHR_NBR
DTL1.GPIN_VCHR_DT
DTL1.GPIN_CHEQUE_NO
DTL1.GPIN_BSR_CODE
DTL1.GPIN_BK_ENT_IND
DTL1.GPIN_TOTAL_CNT
DTL1.CAL_PRD_ID
DTL1.GPIN_MRHD_CHLN

   let $CAL_PRD_ID       =  rtrim(ltrim(&DTL1.CAL_PRD_ID,' '),' ')
   let #GPIN_SR_NBR      =  &DTL1.GPIN_SR_NBR

   let $ANNEX1FILESUFFIX =rtrim(ltrim(&DTL1.CAL_PRD_ID,' '),' ')
   LET #TOT_TAX_DEP = &DTL1.GPIN_TDS_AMT
                + &DTL1.GPIN_TDS_SUR_AMT
                + &DTL1.GPIN_TDS_CESS_AMT
                + &DTL1.GPIN_TDS_INT_AMT
                + &DTL1.GPIN_TDS_OTH_AMT
                + &DTL1.GPIN_LATE_FEE

   let #tot_TDS          = #tot_TDS         + &DTL1.GPIN_TDS_AMT
   let #tot_Surcharge    = #tot_Surcharge   + &DTL1.GPIN_TDS_SUR_AMT
   let #tot_Edu_Cess     = #tot_Edu_Cess    + &DTL1.GPIN_TDS_CESS_AMT
   let #tot_Interest     = #tot_Interest    + &DTL1.GPIN_TDS_INT_AMT
   let #tot_Others       = #tot_Others      + &DTL1.GPIN_TDS_OTH_AMT
   let #tot_Tot_tax_dep  = #tot_Tot_tax_dep + #TOT_TAX_DEP
   let #tot_LATEFEE      = #tot_LATEFEE + &DTL1.GPIN_LATE_FEE

   MOVE &DTL1.GPIN_SR_NBR TO $Sr_No 999999

   let #TDS                 = &DTL1.GPIN_TDS_AMT
   let #Surcharge           = &DTL1.GPIN_TDS_SUR_AMT
   let #Edu_Cess            = &DTL1.GPIN_TDS_CESS_AMT
   let #Interest            = &DTL1.GPIN_TDS_INT_AMT
   let #Others              = &DTL1.GPIN_TDS_OTH_AMT
   let #F24qLateFee         = &DTL1.GPIN_LATE_FEE
   let #Tot_tax_deposited   = #TOT_TAX_DEP
   let $Cheque_No           = rtrim(ltrim(&DTL1.GPIN_CHEQUE_NO, ' '), ' ')
   let $BSR_Code            = rtrim(ltrim(&DTL1.GPIN_BSR_CODE , ' '), ' ')
   let $BSR_Code            = edit(&DTL1.GPIN_BSR_CODE,'XXXXXXX')
   let $Transf_voucher_SlNo = rtrim(ltrim(&DTL1.GPIN_VCHR_NBR , ' '), ' ')
   MOVE &DTL1.GPIN_VCHR_DT TO $Date_tax_deposited  DD/MM/YYYY
   MOVE &DTL1.GPIN_VCHR_DT TO $Date_Dep_CD  DDMMYYYY
   Move &DTL1.GPIN_MRHD_CHLN to $Minor_HDChln

   let $TDS_dep_by_book = rtrim(ltrim(&DTL1.GPIN_BK_ENT_IND, ' '), ' ')

   do Print_Section_4_Data
   let $WriteChlnData = '1'
   do Get-Annexure1-Data
   let $WriteChlnData = '0'
   do Print-Challan_Detail-Rec
   do Get-Annexure1-Data
   do Write-Annexure1-Footer
FROM PS_GPIN_F24TAN_DTL DTL1
WHERE DTL1.GPIN_IT_TAN_NBR = $RCTAN
AND DTL1.GPIN_YEAR_CD    = &RNCT.GPIN_YEAR_CD
AND DTL1.GPIN_QUARTER_ID = &RNCT.GPIN_QUARTER_ID
end-select
end-if



   let $Sr_No              = 'Total'
   MOVE #tot_TDS          TO #TDS
   MOVE #tot_Surcharge    TO #Surcharge
   MOVE #tot_Edu_Cess     TO #Edu_Cess
   MOVE #tot_Interest     TO #Interest
   MOVE #tot_Others       TO #Others
   MOVE #tot_LATEFEE      TO #F24qLateFee
   MOVE #tot_Tot_tax_dep  TO #Tot_tax_deposited
   let $Cheque_No           = ''
   let $BSR_Code            = ''
   let $Transf_voucher_SlNo = ''
   let $Date_tax_deposited  = ''
   let $TDS_dep_by_book     = ''
   let $Minor_HDChln          = ''

   do Print_Section_4_Data

end-procedure


!***********************************************************************
! Procedure:    Print-Challan_Detail-Rec                               *
!                                                                      *
! Description:  Printing Challan Detail Record                         *
!                                                                      *
!***********************************************************************

begin-procedure  Print-Challan_Detail-Rec

   LET #LATEFEE = 0
   let $MRHDCHLN = ''
   DO Get-Fee_MinorHead-Fields
   let $SLATEFEE    = edit(#LATEFEE,'999999999990.00')


   add 1 to #LineNum
   let $LineNum = edit(#LineNum,'999999999')
   add 1 to #CD_Rec_No
   let $CD_Rec_No = edit(#CD_Rec_No,'999999999')


   let $TDS_CD       = edit(#TDS,'999999999990.00')
   let $Surcharge_CD = edit(#Surcharge,'999999999990.00')
   let $Edu_Cess_CD  = edit(#Edu_Cess,'999999999990.00')
   let $Interest_CD  = edit(#Interest,'999999999990.00')
   let $Others_CD    = edit(#Others,'999999999990.00')

   let #TotDeposit = #TDS + #Surcharge + #Edu_Cess + #Interest + #Others + #LATEFEE
   let $TotDeposit_CD    = edit(#TotDeposit,'999999999990.00')

   let $Tot_Tax_CD   = edit(#Tot_tax_deposited,'999999999990.00')
   let $Date_Dep_CD  = edit($Date_Dep_CD,'XXXXXXXX')
   let $DeducteeCount = edit(#DeducteeCnt,'999999999')
   let $TL_tdsval     = edit(#TL_tdsval,'999999999990.00')
   let $TL_tds_cal    = edit(#TL_tds_cal,'999999999990.00')
   let $TL_tdssur     = edit(#TL_tdssur,'999999999990.00')
   let $TL_tdsedu     = edit(#TL_tdsedu,'999999999990.00')
   let $TL_tdsval     = edit(#TL_tdsval,'999999999990.00')

   if $TDS_dep_by_book = 'B'
      move 'Y' to $Dep_By_Book_CD
      let $Cheque_No_CD  = ''
   else
      move 'N' to $Dep_By_Book_CD
      let $Cheque_No_CD  = $Cheque_No
   end-if

   let $Challan_No_CD = ltrim(edit($Transf_voucher_SlNo,'000000000'),'0')

   if ltrim(rtrim($Challan_No_CD,' '),' ') = '' and ltrim(rtrim($BSR_Code,' '),' ') = ''
       let $NilChalanInd = 'Y'
   else
       let $NilChalanInd = 'N'
   end-if


   if ( $NilChalanInd = 'Y' or $Dep_By_Book_CD = 'Y')
     let $Challan_No_CD = ''
   end-if

   if $Challan_No_CD <> ''
     let $BSR_Code_CD   = $BSR_Code
   else
    let $BSR_Code_CD   = ''
   end-if

   if ($Type_Emp = 'A' or $Type_Emp = 'S')

      Let $Type_Emp1 = 'SH'

   end-if


   if ( $Type_Emp1 <> 'SH' or $NilChalanInd = 'Y')

     let $TrnsfrVcrNo = ''
   else
    if $Challan_No_CD = ''
     let $TrnsfrVcrNo = ltrim(edit($Transf_voucher_SlNo,'000000000'),'0')
    else
     let $TrnsfrVcrNo = ''
    end-if
   end-if

   if $NilChalanInd = 'Y'
      let $MRHDCHLN =''
      let $Dep_By_Book_CD=''
   end-if


   let $SECTCODEBLANK=''
   let $LstTotDepAmt=''

   let $REPORT_TITLE = ltrim(rtrim($LineNum,' '),' ')||'^'
   let $REPORT_TITLE = $REPORT_TITLE || ltrim(rtrim($CD_Rec__Type,' '),' ')||'^'
   let $REPORT_TITLE = $REPORT_TITLE || ltrim(rtrim($CD_Batch_No,' '),' ')||'^'
   let $REPORT_TITLE = $REPORT_TITLE || ltrim(rtrim($CD_Rec_No,' '),' ')||'^'
   let $REPORT_TITLE = $REPORT_TITLE || ltrim(rtrim($DeducteeCount,' '),' ')||'^'
   let $REPORT_TITLE = $REPORT_TITLE || ltrim(rtrim($NilChalanInd,' '),' ')||'^'
   let $REPORT_TITLE = $REPORT_TITLE || ltrim(rtrim($ChallanUpdInd,' '),' ')||'^'
   let $REPORT_TITLE = $REPORT_TITLE || ltrim(rtrim($Filler2,' '),' ')||'^'
   let $REPORT_TITLE = $REPORT_TITLE || ltrim(rtrim($Filler3,' '),' ')||'^'
   let $REPORT_TITLE = $REPORT_TITLE || ltrim(rtrim($Filler4,' '),' ')||'^'
   let $REPORT_TITLE = $REPORT_TITLE || ltrim(rtrim($LastBankChlnNo,' '),' ')||'^'
   let $REPORT_TITLE = $REPORT_TITLE || ltrim(rtrim($Challan_No_CD,' '),' ')||'^'
   let $REPORT_TITLE = $REPORT_TITLE || ltrim(rtrim($LastTrnsfrVcrNo,' '),' ')||'^'
   let $REPORT_TITLE = $REPORT_TITLE || ltrim(rtrim($TrnsfrVcrNo,' '),' ')||'^'
   let $REPORT_TITLE = $REPORT_TITLE || ltrim(rtrim($LastBSRCode,' '),' ')||'^'
   let $REPORT_TITLE = $REPORT_TITLE || ltrim(rtrim($BSR_Code_CD,' '),' ')||'^'
   let $REPORT_TITLE = $REPORT_TITLE || ltrim(rtrim($LstDtBnkChlnNo,' '),' ')||'^'
   let $REPORT_TITLE = $REPORT_TITLE || $Date_Dep_CD||'^'
   let $REPORT_TITLE = $REPORT_TITLE || ltrim(rtrim($Filler5,' '),' ')||'^'
   let $REPORT_TITLE = $REPORT_TITLE || ltrim(rtrim($Filler6,' '),' ')||'^'
   let $REPORT_TITLE = $REPORT_TITLE || ltrim(rtrim($SECTCODEBLANK,' '),' ')||'^'
   let $REPORT_TITLE = $REPORT_TITLE || ltrim(rtrim($TDS_CD,' '),' ')||'^'
   let $REPORT_TITLE = $REPORT_TITLE || ltrim(rtrim($Surcharge_CD,' '),' ')||'^'
   let $REPORT_TITLE = $REPORT_TITLE || ltrim(rtrim($Edu_Cess_CD,' '),' ')||'^'
   let $REPORT_TITLE = $REPORT_TITLE || ltrim(rtrim($Interest_CD,' '),' ')||'^'
   let $REPORT_TITLE = $REPORT_TITLE || ltrim(rtrim($Others_CD,' '),' ')||'^'
   let $REPORT_TITLE = $REPORT_TITLE || ltrim(rtrim($TotDeposit_CD,' '),' ')||'^'
   let $REPORT_TITLE = $REPORT_TITLE || ltrim(rtrim($LstTotDepAmt,' '),' ')||'^'
   !let $REPORT_TITLE = $REPORT_TITLE || ltrim(rtrim($Tot_Tax_CD,' '),' ')||'^'
   let $REPORT_TITLE = $REPORT_TITLE || ltrim(rtrim($TL_tdsval,' '),' ')||'^'
   let $REPORT_TITLE = $REPORT_TITLE || ltrim(rtrim($TL_tds_cal,' '),' ')||'^'
   let $REPORT_TITLE = $REPORT_TITLE || ltrim(rtrim($TL_tdssur,' '),' ')||'^'
   let $REPORT_TITLE = $REPORT_TITLE || ltrim(rtrim($TL_tdsedu,' '),' ')||'^'
   let $REPORT_TITLE = $REPORT_TITLE || ltrim(rtrim($TL_tdsval,' '),' ')||'^'
   let $REPORT_TITLE = $REPORT_TITLE || ltrim(rtrim($TDSIntAmt,' '),' ')||'^'
   let $REPORT_TITLE = $REPORT_TITLE || ltrim(rtrim($TDSOthAmt,' '),' ')||'^'
   let $REPORT_TITLE = $REPORT_TITLE || ltrim(rtrim($Cheque_No_CD,' '),' ')||'^'
   let $REPORT_TITLE = $REPORT_TITLE || ltrim(rtrim($Dep_By_Book_CD,' '),' ')||'^'
   let $REPORT_TITLE = $REPORT_TITLE || ltrim(rtrim($Remark,' '),' ')||'^'
   let $REPORT_TITLE = $REPORT_TITLE || ltrim(rtrim($SLATEFEE,' '),' ')||'^'
   let $REPORT_TITLE = $REPORT_TITLE || ltrim(rtrim($MRHDCHLN,' '),' ')||'^'
   let $REPORT_TITLE = $REPORT_TITLE || ltrim(rtrim($RCDHash,' '),' ')



   write 4 from $REPORT_TITLE    ! Print Challan Record

end-procedure



!***********************************************************************
! Procedure:    Print_Section_4_Data                                   *
!                                                                      *
! Description: Printing section 4 data                                 *
!                                                                      *
!***********************************************************************

begin-procedure  Print_Section_4_Data

   graphic (+1, 7,104) box 1
   let #index = 1
   let #pos = 15

   graphic (-1, #pos, 1)  vert-line 1

   while #index <= 12
      graphic (, #pos, 1)  vert-line 1
      add 8 to #pos
      add 1 to #index
   end-while


   print $Sr_No                      (+1,9)
   print #TDS                        (,14)     edit 9999999999.99
   print #Surcharge                  (,22)     edit 9999999999.99
   print #Edu_Cess                   (,30)     edit 9999999999.99
   print #Interest                   (,38)     edit 9999999999.99
   print #F24qLateFee                (,46)     edit 9999999999.99
   print #Others                     (,54)     edit 9999999999.99
   print #Tot_tax_deposited          (,62)     edit 9999999999.99
   print $TDS_dep_by_book            (,75)
   print $BSR_Code                   (,80)
   print $Transf_voucher_SlNo        (,87)
   print $Date_tax_deposited         (,96)
   print $Minor_HDChln               (,106)
   alter-printer font = #Heading_Font point-size = #StdPntSize

end-procedure

!***********************************************************************
! Procedure:    Print_Section_5                                        *
!                                                                      *
! Description: Printing section 5 of the form                          *
!                                                                      *
!***********************************************************************

begin-procedure  Print_Section_5

   let $sect5_heading_lbl3 = ltrim(rtrim($sect5_heading_lbl3,' '),' ') ||' '||ltrim(rtrim($sect5_heading_lbl4,' '),' ')
   let $note_1_1_lbl = $note_1_lbl || ' ' || $note_1_1_lbl
   let $note_3_1_lbl = $note_3_lbl || ' ' || $note_3_1_lbl
   let $note_4_2_lbl = $note_4_lbl || ' ' || $note_4_1_lbl || ' ' || $note_4_2_lbl
   let $note_5_1_lbl = $note_5_lbl || ' ' || $note_5_1_lbl
   let $note_6_1_lbl = $note_6_lbl || ' ' || $note_6_1_lbl
   let $note_7_1_lbl = $note_7_lbl || ' ' || $note_7_1_lbl
   let $note_8_1_lbl = $note_8_lbl || ' ' || $note_8_1_lbl


   print '5'                     (+3,5) bold
   print $sect5_heading_lbl      (,7)    bold
   print $sect5_heading_lbl2     (+1,5)    
   print $sect5_heading_lbl3     (+1,5)   

   print $verification_lbl       (+2,50)    bold
   print $i_lbl                  (+2,5)
   print $name_of_certify        (,10)
   graphic                       (, 8, 45)  horz-line 1
   print ','                     (,53)
   print $certify_lbl            (,54)
   print $place_lbl              (+2,5)
   print $place                  (,12)
   print $signature_lbl          (,31)
   graphic                       (, 65, 37)  horz-line 1
   print $date_lbl               (+2,5)
   print $Creation_date          (,12)
   print $name_and_desgn_lbl     (,31)
   print $name_resp_prsn         (,74)
   graphic                       (, 72, 30)  horz-line 1
   print $note_lbl               (+2,5) bold
   print $note_1_1_lbl           (+2,5) 
   print $note_2_1_lbl           (+1,5)
   print $note_3_1_lbl           (+1,5)
   !print $note_4_2_lbl           (+1,5) wrap 165 2
   let $note4_1 = substr($note_4_2_lbl,1,160) 
   print $note4_1                (+1,5) 
   let $note4_2 = ' ' || substr($note_4_2_lbl,161,length($note_4_2_lbl))
   print $note4_2                (+1,6)
   print $note_5_1_lbl           (+1,5) 
   !print $note_6_1_lbl           (+1,5) wrap 165 2
   let $note6_1 = substr($note_6_1_lbl,1,160)
   print $note6_1                (+1,5) 
   let $note6_2 = ' ' || substr($note_6_1_lbl,161,length($note_6_1_lbl))
   print $note6_2                (+1,6)
   print $note_7_1_lbl           (+1,5)
   print $note_8_1_lbl           (+1,5)
   print $note_9_lbl             (+1,5)

end-procedure

!************************************************************************
! Procedure Get-Month-Detail                                            *
!                                                                       *
!************************************************************************

Begin-Procedure Get-Month-Detail
BEGIN-SELECT
CAL.PRD_BGN_DT
CAL.PRD_END_DT
   Move &CAL.PRD_BGN_DT to $Cal_Prd_Bgn_Dt
   Move &CAL.PRD_END_DT to $Cal_Prd_End_Dt

FROM PS_GP_CAL_PRD CAL
WHERE CAL.CAL_PRD_ID = $CAL_PRD_ID
END-SELECT
end-procedure

!************************************************************************
! Procedure: Get-HRA-Details                                      *
!                                                                       *
!************************************************************************

Begin-Procedure Get-HRA-Details 

BEGIN-SELECT DISTINCT
HRA.EMPLID
HRA.GPIN_TAX_YEAR
HRA.GPIN_IT_PAN_NBR
HRA.GPIN_LANDLORD_NAME

    let #PAN_count = #PAN_count + 1
    let $PAN_count = edit(#PAN_count,'999999')

    
    evaluate #PAN_count
        when = 1
        let $PAN_Landlord1 = &HRA.GPIN_IT_PAN_NBR
        let $Name_Landlord1 = substr(&HRA.GPIN_LANDLORD_NAME,0,75)
        break
        
        when = 2
        let $PAN_Landlord2 = &HRA.GPIN_IT_PAN_NBR
        let $Name_Landlord2 = substr(&HRA.GPIN_LANDLORD_NAME,0,75)
        
        break
        when = 3
        let $PAN_Landlord3 = &HRA.GPIN_IT_PAN_NBR
        let $Name_Landlord3 = substr(&HRA.GPIN_LANDLORD_NAME,0,75)
        
        break
        when = 4
        let $PAN_Landlord4 = &HRA.GPIN_IT_PAN_NBR
        let $Name_Landlord4 = substr(&HRA.GPIN_LANDLORD_NAME,0,75)
        
        break
        when-other      
        break
    end-evaluate
    
FROM PS_GPIN_TDS_HRA HRA
WHERE HRA.EMPLID = $Emp_Id
AND HRA.GPIN_TAX_YEAR = $HRA_year
AND HRA.GPIN_TDS_VERIFIED = 'Y'
!ORDER BY HRA.EFFDT DESC
END-SELECT

End-Procedure

!************************************************************************
! Procedure: Get-House-Inc-Loss                                     *
!                                                                       *
!************************************************************************

Begin-Procedure Get-House-Inc-Loss
    let $Int_paid_flag = 'N'
    let #PAN_cnt = 0
    let $PAN_cnt = ''
    let $PAN_Lender1 = ''
    let $Name_Lender1 = ''
    let $PAN_Lender2 = ''
    let $Name_Lender2 = ''
    let $PAN_Lender3 = ''
    let $Name_Lender3 = ''
    let $PAN_Lender4 = ''
    let $Name_Lender4 = '' 
BEGIN-SELECT DISTINCT
HP.EMPLID       
HP.GPIN_TAX_YEAR       
HP.GPIN_LANDLORD_NAME  
HP.GPIN_LEND_PAN_NBR   
HP.GPIN_INT_BORR_CAP  

    let #PAN_cnt = #PAN_cnt + 1
    let $PAN_cnt = edit(#PAN_cnt,'999999')
    
    IF &HP.GPIN_INT_BORR_CAP > 0 
        let $Int_paid_flag = 'Y'
    END-IF
    evaluate #PAN_cnt
    
        when = 1
        
        let $PAN_Lender1 = &HP.GPIN_LEND_PAN_NBR
        let $Name_Lender1 = substr(&HP.GPIN_LANDLORD_NAME,0,75)
        break
        
        when = 2
        let $PAN_Lender2 = &HP.GPIN_LEND_PAN_NBR
        let $Name_Lender2 = substr(&HP.GPIN_LANDLORD_NAME,0,75)
        
        break
        when = 3
        let $PAN_Lender3 = &HP.GPIN_LEND_PAN_NBR
        let $Name_Lender3 = substr(&HP.GPIN_LANDLORD_NAME,0,75)
        
        break
        when = 4
        let $PAN_Lender4 = &HP.GPIN_LEND_PAN_NBR
        let $Name_Lender4 = substr(&HP.GPIN_LANDLORD_NAME,0,75)
        
        break
        when-other      
        break
    end-evaluate
    
FROM PS_GPIN_HP_INC_LOS HP
WHERE HP.EMPLID = $Emp_Id
AND HP.GPIN_TAX_YEAR = $HRA_year
AND HP.GPIN_HP_APPR_REJ = 'A'

END-SELECT

End-Procedure

!***********************************************************************
Begin-Procedure  Clear-Temp-Tables


Begin-SQL
DELETE FROM PS_GPIN_24Q_TMP WHERE JOBINSTANCE= #prcs_job_instance;

DELETE FROM PS_GPIN_24Q_TMP2 WHERE JOBINSTANCE=#prcs_job_instance;

DELETE FROM PS_GPIN_24Q_TMP3  WHERE JOBINSTANCE=#prcs_job_instance
End-Sql
End-Procedure !Clear-Temp-Tables

!***********************************************************************
! Procedure:    Get_Translat_Info                                      *
!                                                                      *
! Description: Gets the strings printed in this report                 *
!                                                                      *
!***********************************************************************

begin-procedure Get_Translat_Info

   do Add_Report_Translation($ReportID, $rpt_language_cd)

   do Get_Field_Information ('GPINQT01', 'HEADING_MAIN_1',    $heading_1_lbl,         #DW)
   do Get_Field_Information ('GPINQT01', 'HEADING_MAIN_2',    $heading_2_lbl,         #DW)
   do Get_Field_Information ('GPINQT01', 'HEADING_MAIN_3_1',  $heading_3_1_lbl,       #DW)
   do Get_Field_Information ('GPINQT01', 'HEADING_MAIN_3_2',  $heading_3_2_lbl,       #DW)
   do Get_Field_Information ('GPINQT01', 'HEADING_MAIN_4',    $heading_4_lbl,         #DW)
   do Get_Field_Information ('GPINQT01', 'TAX_DED_AC_NO',     $tax_ded_ac_lbl,        #DW)
   do Get_Field_Information ('GPINQT01', 'TAX_DED_AC_NO1',    $tax_ded_ac_lbl1,       #DW)
   do Get_Field_Information ('GPINQT01', 'TAX_DED_AC_NO2',    $tax_ded_ac_lbl2,       #DW)
   do Get_Field_Information ('GPINQT01', 'PERMNT_AC_NO',      $permnt_ac_no_lbl,      #DW)
   do Get_Field_Information ('GPINQT01', 'PERMNT_AC_NO1',     $permnt_ac_no_lbl1,     #DW)
   do Get_Field_Information ('GPINQT01', 'PERMNT_AC_NO2',     $permnt_ac_no_lbl2,     #DW)
   do Get_Field_Information ('GPINQT01', 'FINANCIAL',         $fincal_year_lbl,       #DW)
   do Get_Field_Information ('GPINQT01', 'ASSESSMENT_YEAR',   $assessment_year_lbl,   #DW)
   do Get_Field_Information ('GPINQT01', 'STMT_FILED',        $statement_filed_lbl,   #DW)
   do Get_Field_Information ('GPINQT01', 'EARLIER_IN_QTR',    $stmt_filed_2_lbl,      #DW)
   do Get_Field_Information ('GPINQT01', 'IF_ANS_TO',         $if_ans_lbl,            #DW)
   do Get_Field_Information ('GPINQT01', 'PROVISIONAL_RECPT', $if_ans_2_lbl,          #DW)
   do Get_Field_Information ('GPINQT01', 'PARTICLR_OF_DEDR',  $sect2_heading_lbl,     #DW)
   do Get_Field_Information ('GPINQT01', 'NAME',              $name_lbl,              #DW)
   do Get_Field_Information ('GPINQT01', 'NAME1',             $name_lbl1,             #DW)
   do Get_Field_Information ('GPINQT01', 'CNTL_STATE',        $cntlstlbl,             #DW)
   do Get_Field_Information ('GPINQT01', 'AIN_CD',            $aincd_lbl,             #DW)
   do Get_Field_Information ('GPINQT01', 'TAN_REG_NO',        $tanregnolbl,           #DW)

   do Get_Field_Information ('GPINQT01', 'TYPE_OF_DEDR',      $type_of_ded_lbl,       #DW)
   do Get_Field_Information ('GPINQT01', '301',               $301_lbl,               #DW)
   do Get_Field_Information ('GPINQT01', '302',               $302_lbl,               #DW)
   do Get_Field_Information ('GPINQT01', '303',               $303_lbl,               #DW)
   do Get_Field_Information ('GPINQT01', '304',               $304_lbl,               #DW)
   do Get_Field_Information ('GPINQT01', '305',               $305_lbl,               #DW)
   do Get_Field_Information ('GPINQT01', '306',               $306_lbl,               #DW)
   do Get_Field_Information ('GPINQT01', '307',               $307_lbl,               #DW)
   do Get_Field_Information ('GPINQT01', '308',               $308_lbl,               #DW)
   do Get_Field_Information ('GPINQT01', '309',               $309_lbl,               #DW)
   do Get_Field_Information ('GPINQT01', '310',               $310_lbl,               #DW)
   do Get_Field_Information ('GPINQT01', '311',               $311_lbl,               #DW)
   do Get_Field_Information ('GPINQT01', '312',               $312_lbl,               #DW)
   do Get_Field_Information ('GPINQT01', '313',               $313_lbl,               #DW)
   do Get_Field_Information ('GPINQT01', 'ADDRESS',           $address_lbl,           #DW)
   do Get_Field_Information ('GPINQT01', 'ADDRESS1',          $address_lbl1,          #DW)
   do Get_Field_Information ('GPINQT01', 'ADDRESS_2',         $address_2_lbl,         #DW)
   do Get_Field_Information ('GPINQT01', 'AREA',              $area_lbl,              #DW)
   do Get_Field_Information ('GPINQT01', 'BRANCH_DIV',        $branch_div_lbl,        #DW)
   do Get_Field_Information ('GPINQT01', 'BSR_CODE',          $bsr_code_lbl,          #DW)
   do Get_Field_Information ('GPINQT01', 'BY_BOOK',           $by_book_lbl,           #DW)
   do Get_Field_Information ('GPINQT01', 'CERTIFY',           $certify_lbl,           #DW)
   do Get_Field_Information ('GPINQT01', 'CESS',              $cess_lbl,              #DW)
   do Get_Field_Information ('GPINQT01', 'CHALLAN',           $challan_lbl,           #DW)
   do Get_Field_Information ('GPINQT01', 'CHEQUE',            $cheque_lbl,            #DW)
   do Get_Field_Information ('GPINQT01', 'COL307_1',          $COL307_1_lbl,          #DW)
   do Get_Field_Information ('GPINQT01', 'COL307_2',          $COL307_2_lbl,          #DW)
   do Get_Field_Information ('GPINQT01', 'COL307_3',          $COL307_3_lbl,          #DW)
   do Get_Field_Information ('GPINQT01', 'DATE_ON',           $date_on_lbl,           #DW)
   do Get_Field_Information ('GPINQT01', 'DATE',              $date_lbl,              #DW)
   do Get_Field_Information ('GPINQT01', 'DD_NO',             $DD_NO_lbl,             #DW)
   do Get_Field_Information ('GPINQT01', 'DEPOSITED',         $DEPOSITED_lbl,         #DW)
   do Get_Field_Information ('GPINQT01', 'DEPOSITED_2',       $DEPOSITED_2_lbl,       #DW)
   do Get_Field_Information ('GPINQT01', 'DETAIL_SAL_PAID',   $sect5_heading_lbl,     #DW)
   do Get_Field_Information ('GPINQT01', 'DETAIL_SAL_PAID2',  $sect5_heading_lbl2,    #DW)
   do Get_Field_Information ('GPINQT01', 'DETAIL_SAL_PAID3',  $sect5_heading_lbl3,    #DW)
   do Get_Field_Information ('GPINQT01', 'DETAIL_SAL_PAID4',  $sect5_heading_lbl4,    #DW)
   do Get_Field_Information ('GPINQT01', 'DETAL_TAX_DED_PAID',$sect4_heading_lbl,     #DW)
   do Get_Field_Information ('GPINQT01', 'EARLIER_IN_QTR',    $EARLIER_IN_QTR_lbl,    #DW)
   do Get_Field_Information ('GPINQT01', 'EDUCATION',         $EDUCATION_lbl,         #DW)
   do Get_Field_Information ('GPINQT01', 'EMAIL',             $EMAIL_lbl,             #DW)
   do Get_Field_Information ('GPINQT01', 'ALT_EMAIL',         $ALTEMAIL_lbl,          #DW)
   do Get_Field_Information ('GPINQT01', 'ENCLOSE_ANNEXURE',  $ENCLOSE_ANNEXURE_lbl,  #DW)
   do Get_Field_Information ('GPINQT01', 'ENTRY',             $ENTRY_lbl,             #DW)
   do Get_Field_Information ('GPINQT01', 'FINANCIAL_YEAR',    $fincal_year_lbl,       #DW)
   do Get_Field_Information ('GPINQT01', 'FLAT_NO',           $FLAT_NO_lbl,           #DW)
   do Get_Field_Information ('GPINQT01', 'I',                 $I_lbl,                 #DW)
   do Get_Field_Information ('GPINQT01', 'IF_ANS_TO',         $IF_ANS_TO_lbl,         #DW)
   do Get_Field_Information ('GPINQT01', 'IF_ANY',            $IF_ANY_lbl,            #DW)
   do Get_Field_Information ('GPINQT01', 'INTEREST',          $INTEREST_lbl,          #DW)
   do Get_Field_Information ('GPINQT01', 'NAME_OF_PREM_BLDNG',$name_of_building_lbl,  #DW)
   do Get_Field_Information ('GPINQT01', 'NAME_AND_DESGN',    $NAME_AND_DESGN_lbl,    #DW)
   do Get_Field_Information ('GPINQT01', 'NOTE',              $NOTE_lbl,              #DW)
   do Get_Field_Information ('GPINQT01', 'NOTE4_5',           $NOTE4_5_lbl,           #DW)
   do Get_Field_Information ('GPINQT01', 'NOTE5_1',           $NOTE5_1_lbl,           #DW)
   do Get_Field_Information ('GPINQT01', 'NOTE5_2',           $NOTE5_2_lbl,           #DW)
   do Get_Field_Information ('GPINQT01', 'NOTE_5_3',          $NOTE_5_3_lbl,          #DW)
   do Get_Field_Information ('GPINQT01', 'NOTE_5A_1',         $NOTE_5A_1_lbl,         #DW)
   do Get_Field_Information ('GPINQT01', 'NOTE_5A_2',         $NOTE_5A_2_lbl,         #DW)
   do Get_Field_Information ('GPINQT01', 'NOTE_1',            $NOTE_1_lbl,            #DW)
   do Get_Field_Information ('GPINQT01', 'NOTE_1_1',          $NOTE_1_1_lbl,          #DW)
   do Get_Field_Information ('GPINQT01', 'NOTE_2_1',          $NOTE_2_1_lbl,          #DW)
   do Get_Field_Information ('GPINQT01', 'NOTE_2_2',          $NOTE_2_2_lbl,          #DW)
   do Get_Field_Information ('GPINQT01', 'NOTE_3',            $NOTE_3_lbl,            #DW)
   do Get_Field_Information ('GPINQT01', 'NOTE_3_1',          $NOTE_3_1_lbl,          #DW)
   do Get_Field_Information ('GPINQT01', 'NOTE_4',            $NOTE_4_lbl,            #DW)
   do Get_Field_Information ('GPINQT01', 'NOTE_4_1',          $NOTE_4_1_lbl,          #DW)
   do Get_Field_Information ('GPINQT01', 'NOTE_4_2',          $NOTE_4_2_lbl,          #DW)
   do Get_Field_Information ('GPINQT01', 'NOTE_4_3',          $NOTE_4_3_lbl,          #DW)
   do Get_Field_Information ('GPINQT01', 'NOTE_4_4',          $NOTE_4_4_lbl,          #DW)
   do Get_Field_Information ('GPINQT01', 'NOTE_4_5',          $NOTE_4_5_lbl,          #DW)
   do Get_Field_Information ('GPINQT01', 'NOTE_4_6',          $NOTE_4_6_lbl,          #DW)
   do Get_Field_Information ('GPINQT01', 'NOTE_4_7',          $NOTE_4_7_lbl,          #DW)
   do Get_Field_Information ('GPINQT01', 'NOTE_4_8',          $NOTE_4_8_lbl,          #DW)
   do Get_Field_Information ('GPINQT01', 'NOTE_4_9',          $NOTE_4_9_lbl,          #DW)
   do Get_Field_Information ('GPINQT01', 'NOTE_4_10',         $NOTE_4_10_lbl,         #DW)
   do Get_Field_Information ('GPINQT01', 'NOTE_4_11',         $NOTE_4_11_lbl,         #DW)
   do Get_Field_Information ('GPINQT01', 'NOTE_4_12',         $NOTE_4_12_lbl,         #DW)
   do Get_Field_Information ('GPINQT01', 'NOTE_4_13',         $NOTE_4_13_lbl,         #DW)
   do Get_Field_Information ('GPINQT01', 'NOTE_5',            $NOTE_5_lbl,            #DW)
   do Get_Field_Information ('GPINQT01', 'NOTE_5_1',          $NOTE_5_1_lbl,         #DW)
   do Get_Field_Information ('GPINQT01', 'NOTE_5_3',          $NOTE_5_3_lbl,          #DW)
   do Get_Field_Information ('GPINQT01', 'NOTE_6',            $NOTE_6_lbl,            #DW)
   do Get_Field_Information ('GPINQT01', 'NOTE_6_1',          $NOTE_6_1_lbl,         #DW)
   do Get_Field_Information ('GPINQT01', 'NOTE_7',            $NOTE_7_lbl,            #DW)
   do Get_Field_Information ('GPINQT01', 'NOTE_7_1',          $NOTE_7_1_lbl,         #DW)
   do Get_Field_Information ('GPINQT01', 'NOTE_8',            $NOTE_8_lbl,            #DW)
   do Get_Field_Information ('GPINQT01', 'NOTE_8_1',          $NOTE_8_1_lbl,         #DW)
   do Get_Field_Information ('GPINQT01', 'NOTE_9',            $NOTE_9_lbl,            #DW)
   do Get_Field_Information ('GPINQT01', 'PENALTY',           $PENALTY_lbl,           #DW)
   do Get_Field_Information ('GPINQT01', 'OTHERS',            $OTHERS_lbl,            #DW)
   do Get_Field_Information ('GPINQT01', 'PARTICLR_PRSN_DEDN',$sect3_heading_lbl,     #DW)
   do Get_Field_Information ('GPINQT01', 'PIN_CODE',          $PIN_CODE_lbl,          #DW)
   do Get_Field_Information ('GPINQT01', 'PLACE',             $PLACE_lbl,             #DW)
   do Get_Field_Information ('GPINQT01', 'ROAD',              $ROAD_lbl,              #DW)
   do Get_Field_Information ('GPINQT01', 'RS',                $Rupees_lbl,            #DW)
   do Get_Field_Information ('GPINQT01', 'SERIAL_NO',         $SERIAL_NO_lbl,         #DW)
   do Get_Field_Information ('GPINQT01', 'SIGNATURE',         $SIGNATURE_lbl,         #DW)
   do Get_Field_Information ('GPINQT01', 'SR_NO',             $SR_NO_lbl,             #DW)
   do Get_Field_Information ('GPINQT01', 'STATE',             $STATE_lbl,             #DW)
   do Get_Field_Information ('GPINQT01', 'STMT_FILED',        $STMT_FILED_lbl,        #DW)
   do Get_Field_Information ('GPINQT01', 'SURCHARGE',         $SURCHARGE_lbl,         #DW)
   do Get_Field_Information ('GPINQT01', 'TDS',               $TDS_lbl,               #DW)
   do Get_Field_Information ('GPINQT01', 'TEXT_FEE',          $FEE_lbl,               #DW)
   do Get_Field_Information ('GPINQT01', 'TEXT_FEE1',         $FEE_lbl1,              #DW)
   do Get_Field_Information ('GPINQT01', 'TEXT_FEE2',         $FEE_lbl2,              #DW)
   do Get_Field_Information ('GPINQT01', 'TEL_NO',            $TEL_NO_lbl,            #DW)
   do Get_Field_Information ('GPINQT01', 'ALT_TEL_NO',        $ALTTEL_NO_lbl,         #DW)
   do Get_Field_Information ('GPINQT01', 'TOTAL_TAX',         $TOTAL_TAX_lbl,         #DW)
   do Get_Field_Information ('GPINQT01', 'COL3081',           $TOTAL_TAX_lbl1,        #DW)
   do Get_Field_Information ('GPINQT01', 'COL3082',           $TOTAL_TAX_lbl2,        #DW)
   do Get_Field_Information ('GPINQT01', 'COL3083',           $TOTAL_TAX_lbl3,        #DW)
   do Get_Field_Information ('GPINQT01', 'COL3084',           $TOTAL_TAX_lbl4,        #DW)
   do Get_Field_Information ('GPINQT01', 'COL3085',           $TOTAL_TAX_lbl5,        #DW)
   do Get_Field_Information ('GPINQT01', 'COL3086',           $TOTAL_TAX_lbl6,        #DW)
   do Get_Field_Information ('GPINQT01', 'COL3087',           $TOTAL_TAX_lbl7,        #DW)
   do Get_Field_Information ('GPINQT01', 'COL3088',           $TOTAL_TAX_lbl8,        #DW)
   do Get_Field_Information ('GPINQT01', 'COL3091',           $COL309_lbl1,           #DW)
   do Get_Field_Information ('GPINQT01', 'COL3092',           $COL309_lbl2,           #DW)
   do Get_Field_Information ('GPINQT01', 'COL3093',           $COL309_lbl3,           #DW)
   do Get_Field_Information ('GPINQT01', 'COL3094',           $COL309_lbl4,           #DW)
   do Get_Field_Information ('GPINQT01', 'COL3095',           $COL309_lbl5,           #DW)
   do Get_Field_Information ('GPINQT01', 'COL3096',           $COL309_lbl6,           #DW)
   do Get_Field_Information ('GPINQT01', 'COL309',            $COL309_lbl,            #DW)

   do Get_Field_Information ('GPINQT01', 'COL3101',           $COL310_lbl1,           #DW)
   do Get_Field_Information ('GPINQT01', 'COL3102',           $COL310_lbl2,           #DW)
   do Get_Field_Information ('GPINQT01', 'COL3103',           $COL310_lbl3,           #DW)
   do Get_Field_Information ('GPINQT01', 'COL3104',           $COL310_lbl4,           #DW)
   do Get_Field_Information ('GPINQT01', 'COL3105',           $COL310_lbl5,           #DW)

   do Get_Field_Information ('GPINQT01', 'SERIAL_NO',         $SERIAL_NO_lbl,         #DW)
   do Get_Field_Information ('GPINQT01', 'COL3111',           $COL311_lbl1,           #DW)
   do Get_Field_Information ('GPINQT01', 'COL3112',           $COL311_lbl2,           #DW)
   do Get_Field_Information ('GPINQT01', 'COL3113',           $COL311_lbl3,           #DW)
   do Get_Field_Information ('GPINQT01', 'COL3114',           $COL311_lbl4,           #DW)
   do Get_Field_Information ('GPINQT01', 'COL3115',           $COL311_lbl5,           #DW)

   do Get_Field_Information ('GPINQT01', 'COL3121',           $COL312_lbl1,           #DW)
   do Get_Field_Information ('GPINQT01', 'COL3122',           $COL312_lbl2,           #DW)
   do Get_Field_Information ('GPINQT01', 'COL3123',           $COL312_lbl3,           #DW)
   do Get_Field_Information ('GPINQT01', 'COL3124',           $COL312_lbl4,           #DW)
   do Get_Field_Information ('GPINQT01', 'COL3125',           $COL312_lbl5,           #DW)
   do Get_Field_Information ('GPINQT01', 'COL3126',           $COL312_lbl6,           #DW)
   do Get_Field_Information ('GPINQT01', 'COL3127',           $COL312_lbl7,           #DW)
   do Get_Field_Information ('GPINQT01', 'COL3128',           $COL312_lbl8,           #DW)
   !do Get_Field_Information ('GPINQT01', 'COL3129',           $COL312_lbl9,           #DW)

   do Get_Field_Information ('GPINQT01', 'COL3131',           $COL313_lbl1,           #DW)
   do Get_Field_Information ('GPINQT01', 'COL3132',           $COL313_lbl2,           #DW)
   do Get_Field_Information ('GPINQT01', 'COL313',            $COL313_lbl,            #DW)

   do Get_Field_Information ('GPINQT01', 'TOWN',              $TOWN_lbl,              #DW)
   do Get_Field_Information ('GPINQT01', 'TRANSFER',          $TRANSFER_lbl,          #DW)
   do Get_Field_Information ('GPINQT01', 'VERIFICATION',      $VERIFICATION_lbl,      #DW)
   do Get_Field_Information ('GPINQT01', 'VOUCHER',           $VOUCHER_lbl,           #DW)
   do Get_Field_Information ('GPINQT01', 'WHETHER',           $WHETHER_lbl,           #DW)
   do Get_Field_Information ('GPINQT01', 'WHICH_TAX',         $WHICH_TAX_lbl,         #DW)
   do Get_Field_Information ('GPINQT01', 'YES_NO',            $YES_NO_lbl,            #DW)
   do Get_Field_Information ('GPINQT01', 'TEXT1',             $REPORT_TEXT1,          #DW)
   do Get_Field_Information ('GPINQT01', 'TEXT2',             $REPORT_TEXT2,          #DW)
   do Get_Field_Information ('GPINQT01', 'TEXT3',             $REPORT_TEXT3,          #DW)
   do Get_Field_Information ('GPINQT01', 'TEXT4',             $REPORT_TEXT4,          #DW)
   do Get_Field_Information ('GPINQT01', 'TITLE1',            $REPORT_TITLE1,         #DW)
   do Get_Field_Information ('GPINQT01', 'TITLE2',            $REPORT_TITLE2,         #DW)
   do Get_Field_Information ('GPINQT01', 'TEXT5',             $REPORT_TEXT5,          #DW)
   do Get_Field_Information ('GPINQT01', 'TEXT6',             $REPORT_TEXT6,          #DW)
   do Get_Field_Information ('GPINQT01', 'TEXT7',             $REPORT_TEXT7,          #DW)
   do Get_Field_Information ('GPINQT01', 'TEXT8',             $REPORT_TEXT8,          #DW)
   do Get_Field_Information ('GPINQT01', 'TEXT9',             $REPORT_TEXT9,          #DW)
   do Get_Field_Information ('GPINQT01', 'TEXT10',            $REPORT_TEXT10,         #DW)
   do Get_Field_Information ('GPINQT01', 'TEXT11',            $REPORT_TEXT11,         #DW)
   do Get_Field_Information ('GPINQT01', 'TEXT12',            $REPORT_TEXT12,         #DW)
   do Get_Field_Information ('GPINQT01', 'TEXT13',            $REPORT_TEXT13,         #DW)
   do Get_Field_Information ('GPINQT01', 'TEXTSECT',          $REPORT_TEXTSECT,       #DW)
   do Get_Field_Information ('GPINQT01', 'TEXT14',            $REPORT_TEXT14,         #DW)
   do Get_Field_Information ('GPINQT01', 'TEXT15',            $REPORT_TEXT15,         #DW)
   do Get_Field_Information ('GPINQT01', 'TEXT16',            $REPORT_TEXT16,         #DW)
   do Get_Field_Information ('GPINQT01', 'TEXT17',            $REPORT_TEXT17,         #DW)
   do Get_Field_Information ('GPINQT01', 'TEXT18',            $REPORT_TEXT18,         #DW)
   do Get_Field_Information ('GPINQT01', 'TEXT19',            $REPORT_TEXT19,         #DW)
   do Get_Field_Information ('GPINQT01', 'TEXT20',            $REPORT_TEXT20,         #DW)
   do Get_Field_Information ('GPINQT01', 'TEXT21',            $REPORT_TEXT21,         #DW)
   do Get_Field_Information ('GPINQT01', 'TEXT22',            $REPORT_TEXT22,         #DW)
   do Get_Field_Information ('GPINQT01', 'TEXT23',            $REPORT_TEXT23,         #DW)
   do Get_Field_Information ('GPINQT01', 'TEXT24',            $REPORT_TEXT24,         #DW)
   do Get_Field_Information ('GPINQT01', 'TEXT25',            $REPORT_TEXT25,         #DW)
   do Get_Field_Information ('GPINQT01', 'TEXTSECT197',       $REPORT_TEXTSECT197,    #DW)    
   do Get_Field_Information ('GPINQT01', 'TEXT26',            $REPORT_TEXT26,         #DW)
   do Get_Field_Information ('GPINQT01', 'TEXT27',            $REPORT_TEXT27,         #DW)
   do Get_Field_Information ('GPINQT01', 'TEXT28',            $REPORT_TEXT28,         #DW)
   do Get_Field_Information ('GPINQT01', 'TEXT29',            $REPORT_TEXT29,         #DW)
   do Get_Field_Information ('GPINQT01', 'TEXT30',            $REPORT_TEXT30,         #DW)
   do Get_Field_Information ('GPINQT01', 'TEXT31',            $REPORT_TEXT31,         #DW)
   do Get_Field_Information ('GPINQT01', 'TEXT32',            $REPORT_TEXT32,         #DW)
   do Get_Field_Information ('GPINQT01', 'TEXT33',            $REPORT_TEXT33,         #DW)
   do Get_Field_Information ('GPINQT01', 'TEXT34',            $REPORT_TEXT34,         #DW)
   do Get_Field_Information ('GPINQT01', 'TEXT35',            $REPORT_TEXT35,         #DW)
   do Get_Field_Information ('GPINQT01', 'TEXT35_1',          $REPORT_TEXT35_1,       #DW)
   do Get_Field_Information ('GPINQT01', 'TEXT35_2',          $REPORT_TEXT35_2,       #DW)
   do Get_Field_Information ('GPINQT01', 'TEXT35_2A',         $REPORT_TEXT35_2A,      #DW)
   do Get_Field_Information ('GPINQT01', 'TEXT35_3',          $REPORT_TEXT35_3,       #DW)
   do Get_Field_Information ('GPINQT01', 'TEXT35_4',          $REPORT_TEXT35_4,       #DW)
   do Get_Field_Information ('GPINQT01', 'TEXT35_TH1',        $REPORT_TEXT35_TH1,     #DW)
   do Get_Field_Information ('GPINQT01', 'TEXT35_TH2',        $REPORT_TEXT35_TH2,     #DW)
   do Get_Field_Information ('GPINQT01', 'TEXT35_TH3',        $REPORT_TEXT35_TH3,     #DW)
   do Get_Field_Information ('GPINQT01', 'TEXT35_TB1',        $REPORT_TEXT35_TB1,     #DW)
   do Get_Field_Information ('GPINQT01', 'TEXT35_TB2',        $REPORT_TEXT35_TB2,     #DW)
   do Get_Field_Information ('GPINQT01', 'TEXT35_TB2A',       $REPORT_TEXT35_TB2A,    #DW)
   do Get_Field_Information ('GPINQT01', 'TEXT35_TB2B',       $REPORT_TEXT35_TB2B,    #DW)
   do Get_Field_Information ('GPINQT01', 'TEXT35_TB3',        $REPORT_TEXT35_TB3,     #DW)
   do Get_Field_Information ('GPINQT01', 'TEXT35_TB3A',       $REPORT_TEXT35_TB3A,    #DW)
   do Get_Field_Information ('GPINQT01', 'TEXT35_TB3B',       $REPORT_TEXT35_TB3B,    #DW)

   do Get_Field_Information ('GPINQT01', 'TEXT36',            $REPORT_TEXT36,         #DW)
   do Get_Field_Information ('GPINQT01', 'TEXT150',           $REPORT_TEXT150,        #DW)
   do Get_Field_Information ('GPINQT01', 'TEXT151',           $REPORT_TEXT151,        #DW)
   do Get_Field_Information ('GPINQT01', 'TEXT152',           $REPORT_TEXT152,        #DW)
   do Get_Field_Information ('GPINQT01', 'TEXT153',           $REPORT_TEXT153,        #DW)
   do Get_Field_Information ('GPINQT01', 'TEXT154',           $REPORT_TEXT154,        #DW)



!Annexure2 labels start

   do Get_Field_Information ('GPINQT01', 'TEXT37',  $REPORT_TEXT37,      #DW)
   do Get_Field_Information ('GPINQT01', 'TEXT37A', $REPORT_TEXT37A,     #DW)
   do Get_Field_Information ('GPINQT01', 'TEXT37B', $REPORT_TEXT37B,     #DW)
   do Get_Field_Information ('GPINQT01', 'TEXT38',  $REPORT_TEXT38,      #DW)
   do Get_Field_Information ('GPINQT01', 'TEXT39',  $REPORT_TEXT39,      #DW)
   do Get_Field_Information ('GPINQT01', 'TEXT40',  $REPORT_TEXT40,      #DW)
   do Get_Field_Information ('GPINQT01', 'TEXT401', $REPORT_TEXT401,     #DW)
   do Get_Field_Information ('GPINQT01', 'TEXT402', $REPORT_TEXT402,     #DW)
   do Get_Field_Information ('GPINQT01', 'TEXT41',  $REPORT_TEXT41,      #DW)
   do Get_Field_Information ('GPINQT01', 'TEXT42',  $REPORT_TEXT42,      #DW)
   do Get_Field_Information ('GPINQT01', 'TEXT42A', $REPORT_TEXT42A,     #DW)
   do Get_Field_Information ('GPINQT01', 'TEXT42B', $REPORT_TEXT42B,     #DW)
   do Get_Field_Information ('GPINQT01', 'TEXT45',  $REPORT_TEXT45,      #DW)
   do Get_Field_Information ('GPINQT01', 'TEXT45A', $REPORT_TEXT45A,     #DW)
   do Get_Field_Information ('GPINQT01', 'TEXT46',  $REPORT_TEXT46,      #DW)
   do Get_Field_Information ('GPINQT01', 'TEXT48',  $REPORT_TEXT48,      #DW)
   do Get_Field_Information ('GPINQT01', 'TEXT49',  $REPORT_TEXT49,      #DW)
   do Get_Field_Information ('GPINQT01', 'TEXT50',  $REPORT_TEXT50,      #DW)
   do Get_Field_Information ('GPINQT01', 'TEXT51',  $REPORT_TEXT51,      #DW)
   do Get_Field_Information ('GPINQT01', 'TEXT52',  $REPORT_TEXT52,      #DW)
   do Get_Field_Information ('GPINQT01', 'TEXT53',  $REPORT_TEXT53,      #DW)
   do Get_Field_Information ('GPINQT01', 'TEXT54',  $REPORT_TEXT54,      #DW)
   do Get_Field_Information ('GPINQT01', 'TEXT55',  $REPORT_TEXT55,      #DW)
   do Get_Field_Information ('GPINQT01', 'TEXT56',  $REPORT_TEXT56,      #DW)
   do Get_Field_Information ('GPINQT01', 'TEXT57',  $REPORT_TEXT57,      #DW)
   do Get_Field_Information ('GPINQT01', 'TEXT58',  $REPORT_TEXT58,      #DW)
   do Get_Field_Information ('GPINQT01', 'TEXT59',  $REPORT_TEXT59,      #DW)
   do Get_Field_Information ('GPINQT01', 'TEXT60',  $REPORT_TEXT60,      #DW)
   do Get_Field_Information ('GPINQT01', 'TEXT61',  $REPORT_TEXT61,      #DW)
   do Get_Field_Information ('GPINQT01', 'TEXT62',  $REPORT_TEXT62,      #DW)
   do Get_Field_Information ('GPINQT01', 'TEXT63',  $REPORT_TEXT63,      #DW)
   do Get_Field_Information ('GPINQT01', 'TEXT63A', $REPORT_TEXT63A,     #DW)
   do Get_Field_Information ('GPINQT01', 'TEXT63A_1',$REPORT_TEXT63A_1,  #DW)
   do Get_Field_Information ('GPINQT01', 'TEXT63A_2',$REPORT_TEXT63A_2,  #DW)
   do Get_Field_Information ('GPINQT01', 'TEXT64',  $REPORT_TEXT64,      #DW)
   do Get_Field_Information ('GPINQT01', 'TEXT64A',  $REPORT_TEXT64A,    #DW)
   do Get_Field_Information ('GPINQT01', 'TEXT73',   $REPORT_TEXT73,     #DW)
   do Get_Field_Information ('GPINQT01', 'TEXT74',   $REPORT_TEXT74,     #DW)
   
   do Get_Field_Information ('GPINQT01', 'TEXT_SEC_17_1',$TEXT_SEC_17_1, #DW)
   do Get_Field_Information ('GPINQT01', 'TEXT_SEC_17_2',$TEXT_SEC_17_2, #DW)   
   do Get_Field_Information ('GPINQT01', 'TEXT_SEC_17_3',$TEXT_SEC_17_3, #DW)   
      
   do Get_Field_Information ('GPINQT01', 'TEXT_SEC_10_5',$TEXT_SEC_10_5, #DW)
   do Get_Field_Information ('GPINQT01', 'TEXT_SEC_10_10',$TEXT_SEC_10_10, #DW)
   do Get_Field_Information ('GPINQT01', 'TEXT_SEC_10_10A',$TEXT_SEC_10_10A, #DW)
   do Get_Field_Information ('GPINQT01', 'TEXT_SEC_10_10AA',$TEXT_SEC_10_10AA, #DW)   
   do Get_Field_Information ('GPINQT01', 'TEXT_SEC_10_13A',$TEXT_SEC_10_13A, #DW)   
   do Get_Field_Information ('GPINQT01', 'TEXT_SEC_10_OTH',$TEXT_SEC_10_OTH, #DW)  
   do Get_Field_Information ('GPINQT01', 'TEXT_SEC_10_TOT',$TEXT_SEC_10_TOT, #DW)
   
   
   do Get_Field_Information ('GPINQT01', 'TEXT_SEC_192_2B',$TEXT_SEC_192_2B, #DW)
   do Get_Field_Information ('GPINQT01', 'TEXT_SEC_87A',$TEXT_SEC_87A, #DW)  
   
   do Get_Field_Information ('GPINQT01', 'TEXT_SEC_87A',$TEXT_HRA_PRV, #DW)
   do Get_Field_Information ('GPINQT01', 'TEXT53_1',  $REPORT_TEXT53_1,      #DW)

   ! New Code V6.5
   

   
   do Get_Field_Information ('GPINQT01', 'TEXT_SEC_80C_GRS'   ,$TEXT_SEC_80C_GRS  , #DW)
   do Get_Field_Information ('GPINQT01', 'TEXT_SEC_80CCC_GRS' ,$TEXT_SEC_80CCC_GRS, #DW)
   do Get_Field_Information ('GPINQT01', 'TEXT_80CCD1_GRS'    ,$TEXT_SEC_80CCD1_GRS  , #DW)
   do Get_Field_Information ('GPINQT01', 'TEXT_80CCD1B_GRS'   ,$TEXT_SEC_80CCD1B_GRS, #DW)
   do Get_Field_Information ('GPINQT01', 'TEXT_80CCD2_GRS'    ,$TEXT_SEC_80CCD2_GRS  , #DW)
   do Get_Field_Information ('GPINQT01', 'TEXT_SEC_80D_GRS'   ,$TEXT_SEC_80D_GRS , #DW)
   do Get_Field_Information ('GPINQT01', 'TEXT_SEC_80E_GRS'   ,$TEXT_SEC_80E_GRS , #DW)
   do Get_Field_Information ('GPINQT01', 'TEXT_SEC_80G_GRS'   ,$TEXT_SEC_80G_GRS , #DW)
   do Get_Field_Information ('GPINQT01', 'TEXT_SEC_80G_QUAL'  ,$TEXT_SEC_80G_QUAL , #DW)
   do Get_Field_Information ('GPINQT01', 'TEXT_SEC_80TTA_GRS' ,$TEXT_SEC_80TTA_GRS , #DW)
   do Get_Field_Information ('GPINQT01', 'TEXT_SEC80TTA_QUAL' ,$TEXT_SEC_80TTA_QUAL , #DW)
   do Get_Field_Information ('GPINQT01', 'TEXT_CH6OTH_GRS'    ,$TEXT_SEC_CH6OTH_GRS, #DW)   
   ! New Code V6.5

   do Get_Field_Information ('GPINQT01', 'TEXT_SEC_80C',$TEXT_SEC_80C, #DW)

   do Get_Field_Information ('GPINQT01', 'TEXT_SEC_80CCC',$TEXT_SEC_80CCC, #DW)
   do Get_Field_Information ('GPINQT01', 'TEXT_SEC_80CCD1',$TEXT_SEC_80CCD1, #DW)
   do Get_Field_Information ('GPINQT01', 'TEXT_SEC_80CCD1B',$TEXT_SEC_80CCD1B, #DW)
   do Get_Field_Information ('GPINQT01', 'TEXT_SEC_80CCD2',$TEXT_SEC_80CCD2, #DW)
   do Get_Field_Information ('GPINQT01', 'TEXT_SEC_80D',$TEXT_SEC_80D, #DW)
   do Get_Field_Information ('GPINQT01', 'TEXT_SEC_80E',$TEXT_SEC_80E, #DW)
   do Get_Field_Information ('GPINQT01', 'TEXT_SEC_80G',$TEXT_SEC_80G, #DW)
   do Get_Field_Information ('GPINQT01', 'TEXT_SEC_80TTA',$TEXT_SEC_80TTA, #DW)
   

   !Annexure3 labels start

   do Get_Field_Information ('GPINQT01', 'TEXT72',   $REPORT_TEXT72,     #DW)
   do Get_Field_Information ('GPINQT01', 'TEXT75',   $REPORT_TEXT75,     #DW)
   do Get_Field_Information ('GPINQT01', 'TEXT76',   $REPORT_TEXT76,     #DW)
   do Get_Field_Information ('GPINQT01', 'TEXT77',   $REPORT_TEXT77,     #DW)
   do Get_Field_Information ('GPINQT01', 'TEXT78',   $REPORT_TEXT78,     #DW)
   do Get_Field_Information ('GPINQT01', 'TEXT79',   $REPORT_TEXT79,     #DW)
   do Get_Field_Information ('GPINQT01', 'TEXT80',   $REPORT_TEXT80,     #DW)
   do Get_Field_Information ('GPINQT01', 'TEXT81',   $REPORT_TEXT81,     #DW)
   do Get_Field_Information ('GPINQT01', 'TEXT82',   $REPORT_TEXT82,     #DW)
   do Get_Field_Information ('GPINQT01', 'TEXT83',   $REPORT_TEXT83,     #DW)
   do Get_Field_Information ('GPINQT01', 'TEXT84',   $REPORT_TEXT84,     #DW)
   do Get_Field_Information ('GPINQT01', 'TEXT85',   $REPORT_TEXT85,     #DW)
   do Get_Field_Information ('GPINQT01', 'TEXT86',   $REPORT_TEXT86,     #DW)
   do Get_Field_Information ('GPINQT01', 'TEXT87',   $REPORT_TEXT87,     #DW)
   do Get_Field_Information ('GPINQT01', 'TEXT88',   $REPORT_TEXT88,     #DW)
   do Get_Field_Information ('GPINQT01', 'TEXT89',   $REPORT_TEXT89,     #DW)
   do Get_Field_Information ('GPINQT01', 'TEXT90',   $REPORT_TEXT90,     #DW)
   do Get_Field_Information ('GPINQT01', 'TEXT91',   $REPORT_TEXT91,     #DW)
   do Get_Field_Information ('GPINQT01', 'TEXT92',   $REPORT_TEXT92,     #DW)
   do Get_Field_Information ('GPINQT01', 'TEXT93',   $REPORT_TEXT93,     #DW)
   do Get_Field_Information ('GPINQT01', 'TEXT94',   $REPORT_TEXT94,     #DW)
   do Get_Field_Information ('GPINQT01', 'TEXT95',   $REPORT_TEXT95,     #DW)
   do Get_Field_Information ('GPINQT01', 'TEXT96',   $REPORT_TEXT96,     #DW)
   do Get_Field_Information ('GPINQT01', 'TEXT97',   $REPORT_TEXT97,     #DW)
   do Get_Field_Information ('GPINQT01', 'TEXT98',   $REPORT_TEXT98,     #DW)
   do Get_Field_Information ('GPINQT01', 'TEXT99',   $REPORT_TEXT99,     #DW)
   do Get_Field_Information ('GPINQT01', 'TEXT100',  $REPORT_TEXT100,    #DW)
   do Get_Field_Information ('GPINQT01', 'TEXT101',  $REPORT_TEXT101,    #DW)
   do Get_Field_Information ('GPINQT01', 'TEXT102',  $REPORT_TEXT102,    #DW)
   do Get_Field_Information ('GPINQT01', 'TEXT103',  $REPORT_TEXT103,    #DW)
   do Get_Field_Information ('GPINQT01', 'TEXT104',  $REPORT_TEXT104,    #DW)
   do Get_Field_Information ('GPINQT01', 'TEXT105',  $REPORT_TEXT105,    #DW)
   
   
!code for the landlord starts

   Let #Strings_Array_Size = 0
   do Add_Report_Translation('GPINQTX1', $rpt_language_cd)
   

   do Get_Field_Information ('GPINQTX1', 'HOUSERENTGT1L',$HOUSERENTGT1L_TXT  , #DW)
   do Get_Field_Information ('GPINQTX1', 'INCFHOUPROP',$INCFHOUPROP_TXT, #DW)
   
   do Get_Field_Information ('GPINQTX1', 'PAN_LANDLORD1',$PAN_LANDLORD1_TXT  , #DW)
   do Get_Field_Information ('GPINQTX1', 'NAME_LANDLORD1',$NAME_LANDLORD1_TXT, #DW)
   do Get_Field_Information ('GPINQTX1', 'PAN_LANDLORD2',$PAN_LANDLORD2_TXT  , #DW)
   do Get_Field_Information ('GPINQTX1', 'NAME_LANDLORD2',$NAME_LANDLORD2_TXT, #DW)
   
   do Get_Field_Information ('GPINQTX1', 'PAN_LANDLORD3',$PAN_LANDLORD3_TXT  , #DW)
   do Get_Field_Information ('GPINQTX1', 'NAME_LANDLORD3',$NAME_LANDLORD3_TXT , #DW)
   do Get_Field_Information ('GPINQTX1', 'PAN_LANDLORD4',$PAN_LANDLORD4_TXT , #DW)
   do Get_Field_Information ('GPINQTX1', 'NAME_LANDLORD4',$NAME_LANDLORD4_TXT , #DW)
   
   do Get_Field_Information ('GPINQTX1', 'PAN_LENDER1',$PAN_LENDER1_TXT , #DW)
   do Get_Field_Information ('GPINQTX1', 'NAME_LENDER1',$NAME_LENDER1_TXT , #DW)
   do Get_Field_Information ('GPINQTX1', 'PAN_LENDER2',$PAN_LENDER2_TXT , #DW)
   do Get_Field_Information ('GPINQTX1', 'NAME_LENDER2',$NAME_LENDER2_TXT, #DW) 
   do Get_Field_Information ('GPINQTX1', 'PAN_LENDER3',$PAN_LENDER3_TXT  , #DW)
   do Get_Field_Information ('GPINQTX1', 'NAME_LENDER3',$NAME_LENDER3_TXT, #DW)
   do Get_Field_Information ('GPINQTX1', 'PAN_LENDER4',$PAN_LENDER4_TXT  , #DW)
   do Get_Field_Information ('GPINQTX1', 'NAME_LENDER4',$NAME_LENDER4_TXT, #DW)
   
   do Get_Field_Information ('GPINQTX1', 'SUPER_ANN_FUND_IND',$SUPER_ANN_FUND_IND_TXT  , #DW)
   do Get_Field_Information ('GPINQTX1', 'SUP_ANN_FUN_NM',$SUP_ANN_FUN_NM_TXT , #DW)
   do Get_Field_Information ('GPINQTX1', 'SUP_ANN_FUN_DTFROM',$SUP_ANN_FUN_DTFROM_TXT , #DW)
   do Get_Field_Information ('GPINQTX1', 'SUP_ANN_FUN_DTTO',$SUP_ANN_FUN_DTTO_TXT , #DW)
   do Get_Field_Information ('GPINQTX1', 'SUP_ANN_FUN_AMT',$SUP_ANN_FUN_AMT_PAID_TXT , #DW)
   do Get_Field_Information ('GPINQTX1', 'SUP_ANN_DED_TAX_RT',$SUP_ANN_DED_TAX_RT_TXT , #DW)
   do Get_Field_Information ('GPINQTX1', 'SUP_ANN_DED_TAX',$SUP_ANN_DED_TAX_AMT_TXT , #DW)
   do Get_Field_Information ('GPINQTX1', 'SUP_ANN_GRS_TOT',$SUP_ANN_GRS_TOT_TXT, #DW)
   do Get_Field_Information ('GPINQTX1', 'SUP_ANN_GRS_TOT1',$SUP_ANN_GRS_TOT1_TXT, #DW) 
   
   !code for the landlord Ends

end-procedure !Get_Translat_Info

! New Code 6.5
! ***************************************************************************
Begin-Procedure Get-Qua-Amt-6a
  lET $VAR1 = ''
  lET $VAR2 = ''
  lET $VAR3 = ''
  lET $ALLVARS = ''
  lET $Var1 = '(''LIM VR MED 80D'',''LIM VR LOAN 80GGA'',''LIM VR LOAN 80G'',''LIM VR LOAN 80GG'','
  lET $Var2 = '''LIM VR MED80D SR'',''LIM VR MED 80DD'',''LIM VR MED80D HLTH'',''LIM VR MED 80DDB'',''LIM VR PEN 80CCC'',''LIM VR PR80D SR'','
  lET $Var3 = '''LIM VR PHY DIS 80U'',''LIM VR LOAN 80E'',''LIM VR INT SEC 80L'',''LIM VR SECT 80C'',''LIM VR SECT 80CCE'',''LIM VR PARS 80D'',''LIM VR INF 80CCF'',''LIM VR SEC 80TTA'',''LIM VR 80CCG ESS'')'
  lET $ALLVARS = $VAR1 || $VAR2 || $VAR3
Begin-Select
B.PIN_NM
A.MONETARY_VALUE
  let $pin_name = ltrim(rtrim(&B.PIN_NM,' '),' ')
  evaluate $pin_name
  when = 'LIM VR PEN 80CCC'
      Move &A.MONETARY_VALUE to #lim_sec80ccc
      break
  when = 'LIM VR SECT 80CCE'
      Move &A.MONETARY_VALUE to #lim_sec80cce
      break

  when =  'LIM VR MED 80D'
      Move &A.MONETARY_VALUE to #lim_sec80d
      break
  when =  'LIM VR MED80D HLTH'
      Move &A.MONETARY_VALUE to #lim_sec80d_hlth
      break
  when = 'LIM VR SEC 80TTA'
      Move &A.MONETARY_VALUE to #lim_sec80tta
      break

   when = 'LIM VR PR80D SR'
  Move &A.MONETARY_VALUE to #lim_sec80dprsr
  break

  when =   'LIM VR PARS 80D'
  Move &A.MONETARY_VALUE to #lim_sec80dpr
  break

  when = 'LIM VR MED80D SR'
      Move &A.MONETARY_VALUE to #lim_sec80dsr
      break
  when = 'LIM VR MED 80DD'
      Move &A.MONETARY_VALUE to #lim_sec80dd
      break
  when = 'LIM VR MED 80DDB'
      Move &A.MONETARY_VALUE to #lim_sec80ddb
      break
  when = 'LIM VR LOAN 80E'
      Move &A.MONETARY_VALUE to #lim_sec80e
      break
  when = 'LIM VR LOAN 80G'
      Move &A.MONETARY_VALUE to #lim_sec80g
      break
  when =  'LIM VR LOAN 80GG'
      Move &A.MONETARY_VALUE to #lim_sec80gg
      break
  when = 'LIM VR LOAN 80GGA'
      Move &A.MONETARY_VALUE to #lim_sec80gga
      break
  when = 'LIM VR INT SEC 80L'
      Move &A.MONETARY_VALUE to #lim_sec80l
      break
  when = 'LIM VR PHY DIS 80U'
      Move &A.MONETARY_VALUE to #lim_sec80u
      break
  when = 'LIM VR INF 80CCF'
      Move &A.MONETARY_VALUE to #lim_sec80ccf
      break
  when = 'LIM VR 80CCG ESS'
      Move &A.MONETARY_VALUE to #lim_sec80ccg
      break
  End-Evaluate
A.DECIMAL_VALUE
  let $pin_name = ltrim(rtrim(&B.PIN_NM,' '),' ')
  evaluate $pin_name
  when = 'LIM VR SECT 80C'
  Move &A.DECIMAL_VALUE to #lim_sec80c
  break
  End-Evaluate


FROM PS_GP_VARIABLE A, PS_GP_PIN_NM_VW B
WHERE A.PIN_NUM = B.PIN_NUM
AND B.PIN_NM IN [$ALLVARS]
AND   A.EFFDT = (SELECT MAX(VAR.EFFDT) FROM PS_GP_VARIABLE VAR
                    WHERE VAR.PIN_NUM = A.PIN_NUM
                and VAR.EFFDT <= &RNCT.BGN_DT)
End-Select
End-Procedure    !Get-Qua-Amt-6a
!******************************************************************************
! New Code 6.5


#Include 'reset.sqc'     !Reset printer procedure
#Include 'curdttim.sqc'  !Get-Current-DateTime procedure
#Include 'datetime.sqc'  !Routines for date and time formatting
#Include 'datemath.sqc'  !Routines for Date Arithmetic
#Include 'number.sqc'    !Routines to format numbers
#Include 'stdapi.sqc'    !Routines to Update Run Status
#include 'address.sqc'   !global address formating
#include 'readxlat.sqc'  ! Get shortname or longname from xlattable
#Include 'useprntr.sqc'
#Include 'sqrtrans.sqc'
